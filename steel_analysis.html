<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.8.25" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Partha Das" />
<meta name="author" content="Pieter Valkering" />
<meta name="author" content="Hans Van de Put" />
<meta name="dcterms.date" content="2026-01-29" />
<meta name="keywords" content="AIDRES, EUROSTAT, JRC-IDEES" />

<title>Steel sector data analysis and input data preparation for EU/ Industrial Cluster case study in MOPO</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <div id="quarto-toc-target"></div>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Steel sector data analysis and input data preparation for EU/ Industrial Cluster case study in MOPO</h1>
<p class="subtitle lead">AIDRES, JRC-IDEES, EUROSTAT</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Partha Das </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Pieter Valkering </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Hans Van de Put </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2026</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>AIDRES, EUROSTAT, JRC-IDEES</p>
  </div>
</div>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction">Introduction</a>
  <ul>
  <li><a href="#using-this-file" id="toc-using-this-file">Using this file</a></li>
  </ul></li>
  <li><a href="#loading-libraries" id="toc-loading-libraries">Loading libraries</a></li>
  <li><a href="#reading-country-names-and-codes" id="toc-reading-country-names-and-codes">Reading country names and codes</a></li>
  <li><a href="#aidres-steel-production-and-energy-consumption" id="toc-aidres-steel-production-and-energy-consumption">AIDRES Steel production and energy consumption</a>
  <ul>
  <li><a href="#importing-aidres-and-aidres-2.0-data-from-local-.csv-files" id="toc-importing-aidres-and-aidres-2.0-data-from-local-.csv-files">Importing AIDRES and AIDRES 2.0 data from local <code>.csv</code> files</a>
  <ul>
  <li><a href="#reading-the-aidres-data-.csv-files." id="toc-reading-the-aidres-data-.csv-files.">Reading the AIDRES data <code>.csv</code> files.</a></li>
  </ul></li>
  <li><a href="#steel-production-in-2018" id="toc-steel-production-in-2018">Steel production in 2018</a></li>
  <li><a href="#energy-consumption-for-steel-production-in-2018" id="toc-energy-consumption-for-steel-production-in-2018">Energy consumption for Steel production in 2018</a></li>
  </ul></li>
  <li><a href="#eurostat-steel-energy-consumption" id="toc-eurostat-steel-energy-consumption">EUROSTAT Steel energy consumption</a>
  <ul>
  <li><a href="#downloading-eurostat-energy-balance" id="toc-downloading-eurostat-energy-balance">Downloading Eurostat energy balance</a></li>
  <li><a href="#steel-energy-consumption" id="toc-steel-energy-consumption">Steel energy consumption</a></li>
  <li><a href="#comparison-of-steel-sector-energy-consumption-between-aidresaidres-2.0-and-eurostat" id="toc-comparison-of-steel-sector-energy-consumption-between-aidresaidres-2.0-and-eurostat">Comparison of Steel sector energy consumption between AIDRES/AIDRES 2.0 and EUROSTAT</a>
  <ul>
  <li><a href="#creating-output-directory" id="toc-creating-output-directory">Creating output directory</a></li>
  <li><a href="#joining-aidresaidres-2.0-and-eurostat-steel-energy-consumption" id="toc-joining-aidresaidres-2.0-and-eurostat-steel-energy-consumption">Joining AIDRES/AIDRES 2.0 and EUROSTAT Steel energy consumption</a></li>
  <li><a href="#plot" id="toc-plot">Plot</a></li>
  <li><a href="#tables" id="toc-tables">Tables</a></li>
  <li><a href="#diff-files" id="toc-diff-files">Diff files</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#adding-rolling-and-finishing-energy-from-jrc-idees" id="toc-adding-rolling-and-finishing-energy-from-jrc-idees">Adding rolling and finishing energy from JRC-IDEES</a>
  <ul>
  <li><a href="#jrc-idees-steel-production-volume-rolling-and-finishing-energy" id="toc-jrc-idees-steel-production-volume-rolling-and-finishing-energy">JRC-IDEES Steel Production volume, Rolling, and Finishing Energy</a></li>
  <li><a href="#download-idees-excel-files" id="toc-download-idees-excel-files">Download IDEES excel files</a></li>
  <li><a href="#primary-and-secondary-steel-production-in-2018" id="toc-primary-and-secondary-steel-production-in-2018">Primary and secondary steel production in 2018</a>
  <ul>
  <li><a href="#yearly-total-steel-production-of-countries-historical-years" id="toc-yearly-total-steel-production-of-countries-historical-years">Yearly Total Steel production of countries (Historical years)</a></li>
  <li><a href="#comparison-of-steel-production-between-aidresaidres-2.0-and-jrc-idees" id="toc-comparison-of-steel-production-between-aidresaidres-2.0-and-jrc-idees">Comparison of Steel Production between AIDRES/AIDRES 2.0 and JRC-IDEES</a></li>
  <li><a href="#finishing-and-rolling-energy" id="toc-finishing-and-rolling-energy">Finishing and rolling energy</a></li>
  <li><a href="#rolling-energy-by-fuel" id="toc-rolling-energy-by-fuel">Rolling energy by fuel</a></li>
  <li><a href="#finishing-energy-by-fuel" id="toc-finishing-energy-by-fuel">Finishing energy by fuel</a></li>
  <li><a href="#total-rolling-and-finishing-energy" id="toc-total-rolling-and-finishing-energy">Total rolling and finishing energy</a></li>
  <li><a href="#calculate-total-rolling-and-finishing-energy-for-aidresaidres-2.0-steel-production" id="toc-calculate-total-rolling-and-finishing-energy-for-aidresaidres-2.0-steel-production">Calculate total rolling and finishing energy for AIDRES/AIDRES 2.0 Steel production</a></li>
  <li><a href="#joining-production-volume-rolling-and-finishing-energy" id="toc-joining-production-volume-rolling-and-finishing-energy">Joining production volume, rolling, and finishing energy</a></li>
  <li><a href="#comparing-energy-consumption-of-aidresaidres-2.0-with-finishing-and-rolling-from-idees-with-eurostat" id="toc-comparing-energy-consumption-of-aidresaidres-2.0-with-finishing-and-rolling-from-idees-with-eurostat">Comparing Energy consumption of AIDRES/AIDRES 2.0 (with finishing and rolling from IDEES) with EUROSTAT</a></li>
  <li><a href="#plotting-and-diff-files" id="toc-plotting-and-diff-files">Plotting and diff files</a></li>
  <li><a href="#diff-files-1" id="toc-diff-files-1">Diff files</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#steel-sector-claibration-w.r.t-eurostat-data" id="toc-steel-sector-claibration-w.r.t-eurostat-data">Steel sector claibration w.r.t EUROSTAT data</a>
  <ul>
  <li><a href="#eurostat-without-finishing-rolling" id="toc-eurostat-without-finishing-rolling">Eurostat without finishing rolling</a></li>
  <li><a href="#reading-primary-steel-energy-consumption-from-idees" id="toc-reading-primary-steel-energy-consumption-from-idees">Reading primary steel energy consumption from IDEES</a></li>
  <li><a href="#reading-secondary-steel-energy-consumption-from-idees" id="toc-reading-secondary-steel-energy-consumption-from-idees">Reading secondary steel energy consumption from IDEES</a></li>
  <li><a href="#separating-out-finishing-and-rolling-energy-from-total-total-final-energy-consumption-in-idees" id="toc-separating-out-finishing-and-rolling-energy-from-total-total-final-energy-consumption-in-idees">Separating out finishing and rolling energy from total total final energy consumption in IDEES</a></li>
  <li><a href="#ratio-of-secondary-and-primary-energy-consumption-without-finishing-and-rolling" id="toc-ratio-of-secondary-and-primary-energy-consumption-without-finishing-and-rolling">Ratio of secondary and primary energy consumption without finishing and rolling</a>
  <ul>
  <li><a href="#writing-production-routes-in-a-excel-workbook" id="toc-writing-production-routes-in-a-excel-workbook">Writing production routes in a excel workbook</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This is a stand-alone reproducible quarto document with code chunks and documentation for benchmarking Steel production and energy consumption in AIDRES, EUROSTAT.</p>
<p>It calibrates the AIDRES energy consumption w.r.t to EUROSTAT taking input from JRC-IDEES database. It generates comparison plots and tables to visualize and compare the steel production and energy consumption across those databases.</p>
<p>Finally, it calculates specific energy consumption values for additional processes (steel finishing, steel rolling) which are not part of AIDRES database.</p>
<section id="using-this-file" class="level2">
<h2>Using this file</h2>
<p>The files are produced using <a href="https://posit.co/download/rstudio-desktop/">R</a> and <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>. Though this document can be executed using command line, it is recommended to use <code>RStudio</code> for rendering.</p>
<p>Clone this repository to your computer. Open the <code>mopo_repo.Rproj</code> (<code>RStudio needs to be installed</code>) file. Open <code>refinery_analysis.qmd</code> and click on <code>render button</code> (Crtl + Shift + K).</p>
</section>
</section>
<section id="loading-libraries" class="level1">
<h1>Loading libraries</h1>
<p>Checking whether the required packages are installed or not. If not, install them and load them. If they are already installed, just load them.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mypackages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;tidyverse&#39;</span>, <span class="st">&#39;knitr&#39;</span>, <span class="st">&#39;rmarkdown&#39;</span>, <span class="st">&#39;readxl&#39;</span>, <span class="st">&#39;janitor&#39;</span>, <span class="st">&#39;archive&#39;</span>, <span class="st">&#39;DBI&#39;</span>, <span class="st">&#39;odbc&#39;</span>, <span class="st">&#39;RPostgres&#39;</span>, <span class="st">&#39;eurostat&#39;</span>, <span class="st">&#39;stringr&#39;</span>, <span class="st">&#39;forcats&#39;</span>, <span class="st">&#39;writexl&#39;</span>, <span class="st">&#39;xlsx&#39;</span>, <span class="st">&#39;gt&#39;</span>, <span class="st">&#39;here&#39;</span>, <span class="st">&#39;svglite&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> mypackages){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</details>
</div>
</section>
<section id="reading-country-names-and-codes" class="level1">
<h1>Reading country names and codes</h1>
<p>This is provided with the repository by default in the <code>input_data\europe_country_codes</code> directory.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>country_codes <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">&#39;input_data&#39;</span>, <span class="st">&#39;europe_country_codes&#39;</span>, <span class="st">&#39;europe_country_code.xlsx&#39;</span>), <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>country_codes</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 2
   country  country_iso_code
   &lt;chr&gt;    &lt;chr&gt;           
 1 Austria  AT              
 2 Belgium  BE              
 3 Bulgaria BG              
 4 Croatia  HR              
 5 Cyprus   CY              
 6 Czechia  CZ              
 7 Denmark  DK              
 8 Estonia  EE              
 9 Finland  FI              
10 France   FR              
# ℹ 17 more rows</code></pre>
</div>
</div>
</section>
<section id="aidres-steel-production-and-energy-consumption" class="level1">
<h1>AIDRES Steel production and energy consumption</h1>
<p>AIDRES database is open source <span class="citation" data-cites="aidres_report">(<a href="#ref-aidres_report" role="doc-biblioref">Vermeiren et al. 2023</a>)</span>. However the data is available as a raw <code>.sql</code> file which needs to be further used to setup a PostgreSQL database connection to fetch various tables. The data is also available as an Excel workbook. However, it is very customized to be used for specific analysis.</p>
<section id="importing-aidres-and-aidres-2.0-data-from-local-.csv-files" class="level2">
<h2>Importing AIDRES and AIDRES 2.0 data from local <code>.csv</code> files</h2>
<p>However, for an external user setting up a PostgreSQL server is not straight forward. Therefore, AIDRES tables are provided with this repository in the <code>input_data\aidres_data</code> directory.</p>
<p>the AIDRES tables used for this analysis are first exported into <code>.csv</code> files and then they are used further in the analysis. Following code chunks create the directory (<code>input_data\aidres_data</code>) for storing the AIDRES files, and exports the AIDRES data files into <code>.csv</code> format. However, they are currently deactivated as we provide the files already with the repo.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>aidres_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&#39;input_data&#39;</span>, <span class="st">&#39;aidres_data&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(aidres_data)){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;AIDRES input data folder doesn&#39;t exist. Request VITO to provide the data&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(aidres_data)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;AIDRES input data directory already exists. Not creating a new one!&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;AIDRES data tables also exist!&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;AIDRES input data directory already exists. Not creating a new one!&quot;
[1] &quot;AIDRES data tables also exist!&quot;</code></pre>
</div>
</div>
<p>The AIDRES data tables namely <code>aidres_scenarios.csv</code>, <code>aidres_sectors.csv</code>, <code>aidres_result.csv</code>, <code>aidres_configurations.csv</code>, <code>aidres_perton.csv</code> are made available in the <code>input_data\aidres_data</code> folder. The code chunk is currently deactivated.</p>
<p>Dumping AIDRES PSQL tables to <code>.csv</code> files (One time run. Currently deactivated)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>aidres_scenarios <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_scenarios.csv&#39;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>aidres_sectors <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span>  <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_sectors.csv&#39;</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span>  <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_result.csv&#39;</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>aidres_configurations<span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_configurations.csv&#39;</span>)) </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>aidres_perton<span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_perton.csv&#39;</span>))</span></code></pre></div>
</details>
</div>
<section id="reading-the-aidres-data-.csv-files." class="level3">
<h3>Reading the AIDRES data <code>.csv</code> files.</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>aidres_scenarios <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_scenarios.csv&#39;</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>aidres_sectors <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_sectors.csv&#39;</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_result.csv&#39;</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>aidres_configurations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_configurations.csv&#39;</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>aidres_perton <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_perton.csv&#39;</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>aidres_2_0_sectors <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_2_0_sectors.csv&#39;</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(aidres_data, <span class="st">&quot;aidres_2_0_results.csv&quot;</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">&quot;.&quot;</span>, <span class="at">grouping_mark =</span> <span class="st">&quot;,&quot;</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">guess_max =</span> <span class="dv">6000</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>aidres_2_0_configurations <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_2_0_configurations.csv&#39;</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>aidres_2_0_products <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">&#39;aidres_2_0_products.csv&#39;</span>))</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="steel-production-in-2018" class="level2">
<h2>Steel production in 2018</h2>
<p>First we extract the Production volumes of different products in various sectors from AIDRES database.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">&#39;product_flow_kt_y&#39;</span><span class="sc">:</span><span class="st">&#39;total_energy_vectors_pj_y&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(indicators <span class="sc">==</span> <span class="st">&#39;product_flow_kt_y&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_ref_scenario <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         is_ref_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_pareto_solution, is_direct_emission_solution, is_mix)) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;aidres_sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;id&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>description,) <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;aidres_sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;aidres_sector_id&#39;</span>, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;configuration_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;configuration_id&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( <span class="fu">c</span>(<span class="st">&#39;nuts3&#39;</span>, <span class="st">&#39;sector_id&#39;</span>, <span class="st">&#39;product_id&#39;</span>), <span class="fu">everything</span>(), <span class="sc">-</span><span class="st">&#39;aidres_sector_id&#39;</span>, <span class="sc">-</span><span class="st">&#39;name&#39;</span>, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&#39;mix&#39;</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span>abbreviation, <span class="sc">-</span>description, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;is&quot;</span>), <span class="sc">-</span><span class="st">&#39;value&#39;</span>, <span class="sc">-</span><span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(configuration_id,   solution_id,    scenario_id,    route_id)) <span class="sc">|&gt;</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;production_route_name&#39;</span> <span class="ot">=</span> route_name) <span class="sc">|&gt;</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_from =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector_id, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, product_id, production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production_kt_y =</span> <span class="fu">sum</span>(product_flow_kt_y)) <span class="sc">|&gt;</span>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> aidres_production_country_2018</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  aidres_production_country_2018</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 185 × 5
   country_code sector_id  product_id      production_route_name production_kt_y
   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;                           &lt;dbl&gt;
 1 AT           cement     cement          EU-mix-2018                    4214. 
 2 AT           chemical   chemical-PE     (NG)PE                           94.3
 3 AT           chemical   chemical-PEA    (NG)PEA                         130. 
 4 AT           chemical   chemical-olefi… (LN)O                          1273. 
 5 AT           fertiliser fertiliser-amm… (NG)NH3                         383. 
 6 AT           glass      glass-container (NG)                            577. 
 7 AT           refineries refineries-lig… REF-SMR                        6189. 
 8 AT           steel      steel-primary   BF-BOF                         6177  
 9 AT           steel      steel-secondary Scraps EAF                      708  
10 BE           cement     cement          EU-mix-2018                    5538. 
# ℹ 175 more rows</code></pre>
</div>
</div>
<p>First we extract the Production volumes of different products in various sectors from AIDRES 2.0 database.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">&#39;product_flow_kt_y&#39;</span><span class="sc">:</span><span class="st">&#39;total_energy_vectors_pj_y&#39;</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(indicators <span class="sc">==</span> <span class="st">&#39;product_flow_kt_y&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario_id <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         is_reference_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_mix, is_reference_route)) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;sector_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;configuration_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;configuration_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;product_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;product_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&#39;nuts3&#39;</span>, <span class="st">&#39;sector&#39;</span>, <span class="st">&#39;product&#39;</span>, <span class="st">&#39;configuration&#39;</span>, <span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;value&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sector_id&#39;</span> <span class="ot">=</span> sector) <span class="sc">|&gt;</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;product_id&#39;</span> <span class="ot">=</span> product) <span class="sc">|&gt;</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">!=</span> <span class="st">&#39;fertiliser-nitric-acid&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">!=</span> <span class="st">&#39;fertiliser-urea&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;production_route_name&#39;</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_from =</span> <span class="st">&#39;value&#39;</span>)<span class="sc">|&gt;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, product_id, production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production_kt_y =</span> <span class="fu">sum</span>(product_flow_kt_y)) <span class="sc">|&gt;</span>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span>  aidres_2_0_production_country_2018</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>aidres_2_0_production_country_2018</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 186 × 5
   country_code sector_id  product_id      production_route_name production_kt_y
   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;                           &lt;dbl&gt;
 1 AT           cement     cement          EU-mix-2018                    4214. 
 2 AT           chemical   chemical-PE     (NG)PE                           94.3
 3 AT           chemical   chemical-PEA    (NG)PEA                         130. 
 4 AT           chemical   chemical-olefi… (LN)O                          1273. 
 5 AT           fertiliser fertiliser-amm… (NG)NH3                         383. 
 6 AT           glass      glass-container (NG)                            577. 
 7 AT           refineries refineries-lig… REF-SMR                        6189. 
 8 AT           steel      steel-primary   BF-BOF                         6177  
 9 AT           steel      steel-secondary Scraps EAF                      708  
10 BE           cement     cement          EU-mix-2018                    5538. 
# ℹ 176 more rows</code></pre>
</div>
</div>
<p>Filtering only Steel sector production data (AIDRES)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>isi_aidres_production_comp <span class="ot">&lt;-</span> aidres_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector_id) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(production_kt_y, <span class="at">values_to =</span> <span class="st">&#39;kt&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;source&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;aidres&#39;</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> product_id, <span class="at">values_from =</span> kt) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_primary<span class="sc">:</span> steel_secondary, <span class="at">names_to =</span> <span class="st">&#39;product_id&#39;</span>,<span class="at">values_to =</span> <span class="st">&#39;kt&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(kt))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mutate(steel_total = rowSums(cbind(steel_primary, steel_secondary), na.rm = TRUE)) </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pivot_longer(cols = steel_primary:steel_total, names_to = &#39;product_id&#39;, values_to = &#39;kt&#39;) |&gt; </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mutate(kt = replace_na(kt, 0))</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  isi_aidres_production_comp</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 5
   country_code production_route_name source product_id          kt
   &lt;chr&gt;        &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;
 1 AT           BF-BOF                aidres steel_primary    6177 
 2 AT           Scraps EAF            aidres steel_secondary   708 
 3 BE           BF-BOF                aidres steel_primary    5300 
 4 BE           Scraps EAF            aidres steel_secondary  2690 
 5 BG           Scraps EAF            aidres steel_secondary   666 
 6 CZ           BF-BOF                aidres steel_primary    4694 
 7 CZ           Scraps EAF            aidres steel_secondary   245 
 8 DE           BF-BOF                aidres steel_primary   30779.
 9 DE           Scraps EAF            aidres steel_secondary 11757.
10 EL           Scraps EAF            aidres steel_secondary  1467 
# ℹ 23 more rows</code></pre>
</div>
</div>
<p>Filtering only Steel sector production data (AIDRES 2.0)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>isi_aidres_2_0_production_comp <span class="ot">&lt;-</span> aidres_2_0_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector_id) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(production_kt_y, <span class="at">values_to =</span> <span class="st">&#39;kt&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;source&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;aidres&#39;</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> product_id, <span class="at">values_from =</span> kt) <span class="sc">|&gt;</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_primary<span class="sc">:</span> steel_secondary, <span class="at">names_to =</span> <span class="st">&#39;product_id&#39;</span>,<span class="at">values_to =</span> <span class="st">&#39;kt&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(kt))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mutate(steel_total = rowSums(cbind(steel_primary, steel_secondary), na.rm = TRUE)) </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pivot_longer(cols = steel_primary:steel_total, names_to = &#39;product_id&#39;, values_to = &#39;kt&#39;) |&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mutate(kt = replace_na(kt, 0))</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  isi_aidres_2_0_production_comp</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 5
   country_code production_route_name source product_id          kt
   &lt;chr&gt;        &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;
 1 AT           BF-BOF                aidres steel_primary    6177 
 2 AT           Scraps EAF            aidres steel_secondary   708 
 3 BE           BF-BOF                aidres steel_primary    5300 
 4 BE           Scraps EAF            aidres steel_secondary  2690 
 5 BG           Scraps EAF            aidres steel_secondary   666 
 6 CZ           BF-BOF                aidres steel_primary    4694 
 7 CZ           Scraps EAF            aidres steel_secondary   245 
 8 DE           BF-BOF                aidres steel_primary   30779.
 9 DE           Scraps EAF            aidres steel_secondary 11757.
10 EL           Scraps EAF            aidres steel_secondary  1467 
# ℹ 23 more rows</code></pre>
</div>
</div>
</section>
<section id="energy-consumption-for-steel-production-in-2018" class="level2">
<h2>Energy consumption for Steel production in 2018</h2>
<p>First we calculate Energy consumption by different production routes in different sectors (AIDRES).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nuts3, <span class="fu">contains</span>(<span class="st">&#39;id&#39;</span>), <span class="fu">contains</span>(<span class="st">&#39;is_&#39;</span>), <span class="fu">contains</span>(<span class="st">&#39;_pj_y&#39;</span>))<span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">&#39;electricity_pj_y&#39;</span><span class="sc">:</span><span class="st">&#39;total_energy_vectors_pj_y&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_ref_scenario <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         is_ref_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_pareto_solution, is_direct_emission_solution, is_mix)) <span class="sc">|&gt;</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;aidres_sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;id&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>description) <span class="sc">|&gt;</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;aidres_sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;aidres_sector_id&#39;</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;configuration_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;configuration_id&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( <span class="fu">c</span>(<span class="st">&#39;nuts3&#39;</span>, <span class="st">&#39;sector_id&#39;</span>, <span class="st">&#39;product_id&#39;</span>), <span class="fu">everything</span>(), <span class="sc">-</span><span class="st">&#39;aidres_sector_id&#39;</span>, <span class="sc">-</span><span class="st">&#39;name&#39;</span>, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&#39;mix&#39;</span>), <span class="sc">-</span>abbreviation, <span class="sc">-</span>description,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;is&quot;</span>), <span class="sc">-</span><span class="st">&#39;value&#39;</span>, <span class="sc">-</span><span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(configuration_id,   solution_id,    scenario_id,    route_id, id)) <span class="sc">|&gt;</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;production_route_name&#39;</span> <span class="ot">=</span> route_name) <span class="sc">|&gt;</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nuts3, sector_id, product_id, production_route_name, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector_id, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, indicators) <span class="sc">|&gt;</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">country_total =</span> <span class="fu">sum</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_iso_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sector_id, <span class="at">values_from =</span> country_total) <span class="ot">-&gt;</span> aidres_energy_all</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  aidres_energy_all</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 338 × 9
   country_code country indicators   cement chemical fertiliser glass refineries
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           Austria alternative…   3.12     0         0     0          0    
 2 AT           Austria biomass_pj_y   0        0         0     0          0    
 3 AT           Austria biomass_was…   1.87     0         0     0          0    
 4 AT           Austria coal_pj_y      4.85     0         0     0          0    
 5 AT           Austria coke_pj_y      0        0         0     0          0    
 6 AT           Austria crude_oil_p…   0        0         0     0        416.   
 7 AT           Austria electricity…   1.22     1.56      0.795 0.619      0.888
 8 AT           Austria hydrogen_pj…   0        0         0     0.025      0    
 9 AT           Austria methanol_pj…   0        0         0     0          0    
10 AT           Austria naphtha_pj_y   0       77.0       0     0          0    
# ℹ 328 more rows
# ℹ 1 more variable: steel &lt;dbl&gt;</code></pre>
</div>
</div>
<p>First we calculate Energy consumption by different production routes in different sectors (AIDRES 2.0).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">&#39;alternative_fuel_mixture_usage_pj_y&#39;</span><span class="sc">:</span><span class="st">&#39;total_energy_vectors_pj_y&#39;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;indicators&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario_id <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         is_reference_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_mix, is_reference_route)) <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;sector_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;sector_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;configuration_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;configuration_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;product_id&#39;</span> <span class="sc">==</span> <span class="st">&#39;product_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&#39;nuts3&#39;</span>, <span class="st">&#39;sector&#39;</span>, <span class="st">&#39;product&#39;</span>, <span class="st">&#39;configuration&#39;</span>, <span class="st">&#39;indicators&#39;</span>, <span class="st">&#39;value&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sector_id&#39;</span> <span class="ot">=</span> sector) <span class="sc">|&gt;</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;product_id&#39;</span> <span class="ot">=</span> product) <span class="sc">|&gt;</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">!=</span> <span class="st">&#39;fertiliser-nitric-acid&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">!=</span> <span class="st">&#39;fertiliser-urea&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;production_route_name&#39;</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, indicators) <span class="sc">|&gt;</span> </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">country_total =</span> <span class="fu">sum</span>(value)) <span class="sc">|&gt;</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_iso_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sector_id, <span class="at">values_from =</span> country_total) <span class="ot">-&gt;</span> aidres_2_0_energy_all</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  aidres_2_0_energy_all</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 598 × 9
# Groups:   country_code [26]
   country_code indicators   country cement chemical fertiliser glass refineries
   &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           alternative… Austria   3.12        0          0     0          0
 2 AT           ammonia_usa… Austria   0           0          0     0          0
 3 AT           bio_methano… Austria   0           0          0     0          0
 4 AT           bio_methano… Austria   0           0          0     0          0
 5 AT           bio_naphtha… Austria   0           0          0     0          0
 6 AT           bio_naphtha… Austria   0           0          0     0          0
 7 AT           biomass_imp… Austria   0           0          0     0          0
 8 AT           biomass_loc… Austria   0           0          0     0          0
 9 AT           biomass_usa… Austria   0           0          0     0          0
10 AT           biomass_was… Austria   1.87        0          0     0          0
# ℹ 588 more rows
# ℹ 1 more variable: steel &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Filtering out Steel sector energy consumption and aggregating fuels to EUROSTAT aggregated commodities (AIDRES).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>aidres_cleaned_steel <span class="ot">&lt;-</span> aidres_energy_all <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>indicators, steel) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">_pj_y&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;steel_aidres&#39;</span> <span class="ot">=</span> steel,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;fuel&#39;</span> <span class="ot">=</span> indicators) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_aidres, <span class="at">names_to =</span> <span class="st">&#39;metadata&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;total&#39;</span> <span class="ot">=</span> total_energy_vectors) <span class="sc">|&gt;</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#aggregate to broad fuel categories of eurostat  </span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(coal, coke), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(biomass, biomass_waste), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(plastic_mix, alternative_fuel_mixture), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(crude_oil, naphtha), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(alternative_fuel_mixture, coal, coke, biomass, biomass_waste, plastic_mix, crude_oil, naphtha)) <span class="sc">|&gt;</span> </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(country_code<span class="sc">:</span>metadata), <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metadata, <span class="at">values_from =</span> pj)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>aidres_cleaned_steel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 4
   country_code country fuel               steel_aidres
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                     &lt;dbl&gt;
 1 AT           Austria electricity               5.16 
 2 AT           Austria hydrogen                  0    
 3 AT           Austria methanol                  0    
 4 AT           Austria natural_gas               0.134
 5 AT           Austria total                   122.   
 6 AT           Austria solid_fossil_fuels      117.   
 7 AT           Austria renew_bio                 0    
 8 AT           Austria non_renew_waste           0    
 9 AT           Austria oil_petro_products        0    
10 BE           Belgium electricity               7.55 
# ℹ 224 more rows</code></pre>
</div>
</div>
<p>Filtering out Steel sector energy consumption and aggregating fuels to EUROSTAT aggregated commodities (AIDRES 2.0).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_cleaned_steel <span class="ot">&lt;-</span> aidres_2_0_energy_all <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>country, steel) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">_usage_pj_y&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">_pj_y&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;steel_aidres&#39;</span> <span class="ot">=</span> steel,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;fuel&#39;</span> <span class="ot">=</span> indicators) <span class="sc">|&gt;</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(steel_aidres), <span class="at">names_to =</span> <span class="st">&#39;metadata&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;total&#39;</span> <span class="ot">=</span> total_energy_vectors) <span class="sc">|&gt;</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(coal, coke, coal_steel), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(biomass, biomass_waste), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(plastic_mix, alternative_fuel_mixture), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(crude_oil, naphtha), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(alternative_fuel_mixture, coal, coke, biomass, biomass_waste, plastic_mix, crude_oil, naphtha, coal_steel)) <span class="sc">|&gt;</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(country_code<span class="sc">:</span>metadata), <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metadata, <span class="at">values_from =</span> pj)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  aidres_2_0_cleaned_steel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 468 × 4
# Groups:   country_code [26]
   country_code country fuel                steel_aidres
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1 AT           Austria ammonia                     0   
 2 AT           Austria bio_methanol_import         0   
 3 AT           Austria bio_methanol_local          0   
 4 AT           Austria bio_naphtha_import          0   
 5 AT           Austria bio_naphtha_local           0   
 6 AT           Austria biomass_import              0   
 7 AT           Austria biomass_local               0   
 8 AT           Austria electricity                 5.16
 9 AT           Austria ethane                      0   
10 AT           Austria hydrogen                    0   
# ℹ 458 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="eurostat-steel-energy-consumption" class="level1">
<h1>EUROSTAT Steel energy consumption</h1>
<section id="downloading-eurostat-energy-balance" class="level2">
<h2>Downloading Eurostat energy balance</h2>
<p>EUROSTAT API is used to dynamically fetch EUROSTAT data using <code>eurostat</code> package <span class="citation" data-cites="RJ-2017-019">(<a href="#ref-RJ-2017-019" role="doc-biblioref">Lahti et al. 2017</a>)</span>. Please refer this <a href="https://ropengov.github.io/eurostat/index.html">link</a> to more about the usage of the <code>eurostat</code> package.</p>
<p>For steel sector aggregated energy balance data of EUROSTAT (nrg_bal_c) is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dat_aggregated <span class="ot">&lt;-</span> <span class="fu">get_eurostat</span>(<span class="st">&#39;nrg_bal_c&#39;</span>, <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="dv">2018</span>),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">time_format =</span> <span class="st">&quot;num&quot;</span>, <span class="at">type =</span> <span class="st">&#39;label&#39;</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="steel-energy-consumption" class="level2">
<h2>Steel energy consumption</h2>
<p>To calculate net energy consumption in the steel sector we consider the Transformation output, Transformation input, and Energy use for the coke ovens and blast furnace also.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat <span class="ot">&lt;-</span> dat_aggregated <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unit <span class="sc">==</span> <span class="st">&#39;Terajoule&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(siec <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;Solid fossil fuels&#39;</span>, <span class="st">&#39;Manufactured gases&#39;</span>, <span class="st">&#39;Oil and petroleum products (excluding biofuel portion)&#39;</span>, <span class="st">&#39;Renewables and biofuels&#39;</span>, <span class="st">&#39;Electricity&#39;</span>, <span class="st">&#39;Natural gas&#39;</span>, <span class="st">&#39;Non-renewable waste&#39;</span>, <span class="st">&#39;Heat&#39;</span>, <span class="st">&#39;Total&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> siec, <span class="at">values_from =</span>  values) <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;oil_petro_products&#39;</span> <span class="ot">=</span> oil_and_petroleum_products_excluding_biofuel_portion,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;renew_bio&#39;</span> <span class="ot">=</span> renewables_and_biofuels,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;non_renew_waste&#39;</span> <span class="ot">=</span> non_renewable_waste) <span class="sc">|&gt;</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">natural_gas  =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(natural_gas , manufactured_gases), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>manufactured_gases) <span class="sc">|&gt;</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nrg_bal <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;Final consumption - industry sector - iron and steel - energy use&#39;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Energy sector - coke ovens - energy use&#39;</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Transformation input - coke ovens - energy use&#39;</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Transformation output - coke ovens&#39;</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Final consumption - industry sector - non-energy use&#39;</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Energy sector - blast furnaces - energy use&#39;</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Transformation input - blast furnaces - energy use&#39;</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;Transformation output - blast furnaces&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col =</span> total<span class="sc">:</span>heat, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span>  <span class="st">&#39;values&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> nrg_bal, <span class="at">values_from =</span>  values) <span class="sc">|&gt;</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;FC_IND_IS_E&quot;</span> <span class="ot">=</span> final_consumption_industry_sector_iron_and_steel_energy_use,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;NRG_CO_E&quot;</span> <span class="ot">=</span> energy_sector_coke_ovens_energy_use,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;NRG_BF_E&quot;</span> <span class="ot">=</span> energy_sector_blast_furnaces_energy_use,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;TI_BF_E&quot;</span> <span class="ot">=</span> transformation_input_blast_furnaces_energy_use,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;TI_CO_E&quot;</span> <span class="ot">=</span> transformation_input_coke_ovens_energy_use,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;TO_CO&quot;</span> <span class="ot">=</span> transformation_output_coke_ovens,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;TO_BF&quot;</span> <span class="ot">=</span> transformation_output_blast_furnaces,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;FC_IND_NE&quot;</span> <span class="ot">=</span> final_consumption_industry_sector_non_energy_use) <span class="sc">|&gt;</span> </span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuel, geo, time) <span class="sc">|&gt;</span> </span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net =</span> (<span class="fu">rowSums</span>(<span class="fu">cbind</span>(FC_IND_IS_E, NRG_CO_E, NRG_BF_E, TI_BF_E, TI_CO_E), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(TO_CO, TO_BF), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net =</span> net<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;country_code&#39;</span> <span class="ot">=</span> geo,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;year&#39;</span> <span class="ot">=</span> time,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;steel_eurostat_pj&#39;</span> <span class="ot">=</span>  net) <span class="sc">|&gt;</span> </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code)<span class="sc">|&gt;</span> </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, year, fuel, steel_eurostat_pj) <span class="sc">|&gt;</span> </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span> <span class="fu">join_by</span>(country_code <span class="sc">==</span> country)) <span class="sc">|&gt;</span> </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_iso_code)) <span class="sc">|&gt;</span> </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;country&#39;</span> <span class="ot">=</span> country_code,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;country_code&#39;</span> <span class="ot">=</span> country_iso_code,</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;steel_eurostat&#39;</span> <span class="ot">=</span> steel_eurostat_pj) <span class="sc">|&gt;</span> </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>(), <span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 216 × 4
   country_code country fuel               steel_eurostat
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                       &lt;dbl&gt;
 1 AT           Austria electricity               13.8   
 2 AT           Austria heat                       0.299 
 3 AT           Austria natural_gas                2.22  
 4 AT           Austria non_renew_waste            0.597 
 5 AT           Austria oil_petro_products         0.0643
 6 AT           Austria renew_bio                  0.0638
 7 AT           Austria solid_fossil_fuels        88.5   
 8 AT           Austria total                    105.    
 9 BE           Belgium electricity               16.1   
10 BE           Belgium heat                       0     
# ℹ 206 more rows</code></pre>
</div>
</div>
</section>
<section id="comparison-of-steel-sector-energy-consumption-between-aidresaidres-2.0-and-eurostat" class="level2">
<h2>Comparison of Steel sector energy consumption between AIDRES/AIDRES 2.0 and EUROSTAT</h2>
<p>AIDRES and AIDRES 2.0 data still do not have energy consumption from steel finishing and rolling.</p>
<section id="creating-output-directory" class="level3">
<h3>Creating output directory</h3>
<p>The output directory <code>outputs\steel</code> is created to store all output files produced with this <code>.qmd</code> file.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&#39;outputs&#39;</span>, <span class="st">&#39;steel&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)){</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Output directory doesn&#39;t exist. Creating a new one!&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_dir)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Output directory already exists. Not creating a new one!&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Output directory doesn&#39;t exist. Creating a new one!&quot;</code></pre>
</div>
</div>
</section>
<section id="joining-aidresaidres-2.0-and-eurostat-steel-energy-consumption" class="level3">
<h3>Joining AIDRES/AIDRES 2.0 and EUROSTAT Steel energy consumption</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres <span class="ot">&lt;-</span> steel_energy_eurostat <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(aidres_cleaned_steel, <span class="at">by =</span> <span class="fu">join_by</span>(country_code, country, fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_eurostat<span class="sc">:</span>steel_aidres, <span class="at">names_to =</span> <span class="st">&#39;metadata&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">round</span>(pj, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(metadata, <span class="at">delim =</span> <span class="st">&#39;_&#39;</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&#39;sector&#39;</span>, <span class="st">&#39;source&#39;</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 536 × 6
   country_code country fuel               sector source      pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
 1 AT           Austria electricity        steel  eurostat 13.8 
 2 AT           Austria electricity        steel  aidres    5.16
 3 AT           Austria heat               steel  eurostat  0.3 
 4 AT           Austria heat               steel  aidres   NA   
 5 AT           Austria natural_gas        steel  eurostat  2.22
 6 AT           Austria natural_gas        steel  aidres    0.13
 7 AT           Austria non_renew_waste    steel  eurostat  0.6 
 8 AT           Austria non_renew_waste    steel  aidres    0   
 9 AT           Austria oil_petro_products steel  eurostat  0.06
10 AT           Austria oil_petro_products steel  aidres    0   
# ℹ 526 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres_2_0 <span class="ot">&lt;-</span> steel_energy_eurostat <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(aidres_2_0_cleaned_steel, <span class="at">by =</span> <span class="fu">join_by</span>(country_code, country, fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_eurostat<span class="sc">:</span>steel_aidres, <span class="at">names_to =</span> <span class="st">&#39;metadata&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">round</span>(pj, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(metadata, <span class="at">delim =</span> <span class="st">&#39;_&#39;</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&#39;sector&#39;</span>, <span class="st">&#39;source&#39;</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres_2_0 </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,004 × 6
   country_code country fuel               sector source      pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
 1 AT           Austria electricity        steel  eurostat 13.8 
 2 AT           Austria electricity        steel  aidres    5.16
 3 AT           Austria heat               steel  eurostat  0.3 
 4 AT           Austria heat               steel  aidres   NA   
 5 AT           Austria natural_gas        steel  eurostat  2.22
 6 AT           Austria natural_gas        steel  aidres    0.13
 7 AT           Austria non_renew_waste    steel  eurostat  0.6 
 8 AT           Austria non_renew_waste    steel  aidres    0   
 9 AT           Austria oil_petro_products steel  eurostat  0.06
10 AT           Austria oil_petro_products steel  aidres    0   
# ℹ 994 more rows</code></pre>
</div>
</div>
</section>
<section id="plot" class="level3">
<h3>Plot</h3>
<p>Total energy consumption only</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>  steel_eurostat_aidres <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun=</span>sum))) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption in the steel sector in AIDRES and EUROSTAT&#39;</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is missing in AIDRES database&#39;</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p3</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    p3</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_no_fr.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_no_fr.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>  steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun=</span>sum))) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption in the steel sector in AIDRES 2.0 and EUROSTAT&#39;</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is missing in AIDRES 2.0 database&#39;</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p3</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    p3</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_no_fr_2_0.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_no_fr_2_0.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<p>Total energy consumption by fuel</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>  steel_eurostat_aidres <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun=</span>sum))) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption by fuel in the steel sector in AIDRES and EUROSTAT&#39;</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is missing in AIDRES database&#39;</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>)<span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p20</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    p20</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_no_fr.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_no_fr.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>  steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun=</span>sum))) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption by fuel in the steel sector in AIDRES 2.0 and EUROSTAT&#39;</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is missing in AIDRES 2.0 database&#39;</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>)<span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p20</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    p20</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_no_fr_2_0.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_no_fr_2_0.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="tables" class="level3">
<h3>Tables</h3>
<p>Steel sector energy consumption by fuel</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, source, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="at">replace =</span> <span class="dv">0</span>)),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code) <span class="sc">|&gt;</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(electricity<span class="sc">:</span>total, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="ot">-&gt;</span> steel_energy_eurostat_aidres</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat_aidres</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 5
   country_code country fuel               aidres eurostat
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 AT           Austria electricity          5.16    13.8 
 2 AT           Austria heat                 0        0.3 
 3 AT           Austria hydrogen             0        0   
 4 AT           Austria methanol             0        0   
 5 AT           Austria natural_gas          0.13     2.22
 6 AT           Austria non_renew_waste      0        0.6 
 7 AT           Austria oil_petro_products   0        0.06
 8 AT           Austria renew_bio            0        0.06
 9 AT           Austria solid_fossil_fuels 117.      88.5 
10 AT           Austria total              122.     105.  
# ℹ 260 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, source, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="at">replace =</span> <span class="dv">0</span>)),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code) <span class="sc">|&gt;</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(electricity<span class="sc">:</span>total, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="ot">-&gt;</span> steel_energy_eurostat_aidres_2_0</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat_aidres_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 564 × 12
   country_code country ammonia bio_methanol_import bio_methanol_local
   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;
 1 AT           Austria       0                   0                  0
 2 AT           Austria       0                   0                  0
 3 AT           Austria       0                   0                  0
 4 AT           Austria       0                   0                  0
 5 AT           Austria       0                   0                  0
 6 AT           Austria       0                   0                  0
 7 AT           Austria       0                   0                  0
 8 AT           Austria       0                   0                  0
 9 AT           Austria       0                   0                  0
10 AT           Austria       0                   0                  0
# ℹ 554 more rows
# ℹ 7 more variables: bio_naphtha_import &lt;dbl&gt;, bio_naphtha_local &lt;dbl&gt;,
#   biomass_import &lt;dbl&gt;, biomass_local &lt;dbl&gt;, fuel &lt;chr&gt;, aidres &lt;dbl&gt;,
#   eurostat &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="diff-files" class="level3">
<h3>Diff files</h3>
<p>The data containing product flow values from the three sources are exported into an Excel workbook for further analysis. <code>NA</code> values are replaced by <code>0</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat_aidres <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;diff_no_finishing_rolling_fuel.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>steel_energy_eurostat_aidres_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;diff_no_finishing_rolling_fuel_2_0.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="adding-rolling-and-finishing-energy-from-jrc-idees" class="level1">
<h1>Adding rolling and finishing energy from JRC-IDEES</h1>
<p>AIDRES/AIDRES 2.0 data still does not have energy consumption from steel finishing and rolling. JRC IDEES has breakup of total energy consumption of the whole steel sector in various sub-parts like rolling and finishing. Rolling and finishing data is taken from IRC IDEES and added on top of AIDRES final energy consumption by fuel. The resulting ‘total’ final energy is then compared with EUROSTAT data. Steel production data is also compared between JRC IDEES and AIDRES</p>
<section id="jrc-idees-steel-production-volume-rolling-and-finishing-energy" class="level2">
<h2>JRC-IDEES Steel Production volume, Rolling, and Finishing Energy</h2>
<p>JRC-IDEES database is used first to produce historical trends of primary and secondary steel production in countries and then compare with AIDRES for the year 2018.</p>
<p>Subsequently, energy consumption for rolling and finishing is taken from JRC-IDEES and added to AIDRES/AIDRES 2.0 for calibration.</p>
</section>
<section id="download-idees-excel-files" class="level2">
<h2>Download IDEES excel files</h2>
<p><code>JRC‑IDEES provides a consistent set of disaggregated energy-economy-emissions data for each Member State of the European Union, covering all sectors of the energy system for the 2000-2021 period: industry, buildings, transport, and power generation. This data complies with Eurostat energy balances while providing a plausible decomposition of energy consumption into specific processes and end uses</code> <span class="citation" data-cites="jrc-idees_report">(<a href="#ref-jrc-idees_report" role="doc-biblioref">Mate et al. 2024</a>)</span>.</p>
<p>Checking whether there is a directory (<code>./input_data/jrc_idees_2021/energy_balance</code>) containing JRC-IDEES excel files for energy balance. If not (only checking with <code>JRC-IDEES-2021_EnergyBalance_AT.xlsx</code>), creating the directory, downloading the zipped files, and extracting them for each country.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>idees_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&#39;input_data&#39;</span>, <span class="st">&#39;jrc_idees_2021&#39;</span>, <span class="st">&#39;industry&#39;</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(idees_data)){</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Directory doesn&#39;t exists! Creating one&quot;</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(idees_data, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Downloading files&quot;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(country_code <span class="cf">in</span> country_codes<span class="sc">$</span>country_iso_code){</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  zip_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/JRC-IDEES/JRC-IDEES-2021_v1/JRC-IDEES-2021_&quot;</span>, country_code)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;JRC-IDEES-2021_Industry_&quot;</span>, country_code, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">archive_extract</span>(<span class="at">archive =</span> zip_file,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir =</span> idees_data,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">files =</span> filename)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Directory&#39;</span>, idees_data,  <span class="st">&#39;already exists!&#39;</span>))</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">here</span>(idees_data, <span class="st">&#39;JRC-IDEES-2021_Industry_AT.xlsx&#39;</span>))){</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="st">&quot;But files does not exists! downloading them&quot;</span>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(country_code <span class="cf">in</span> country_codes<span class="sc">$</span>country_iso_code){</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  zip_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/JRC-IDEES/JRC-IDEES-2021_v1/JRC-IDEES-2021_&quot;</span>, country_code)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;JRC-IDEES-2021_Industry_&quot;</span>, country_code, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">archive_extract</span>(<span class="at">archive =</span> zip_file,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir =</span> idees_data,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">files =</span> filename)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Files also already exist inside the directory, not downloading them again!&#39;</span>))</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Directory C:/Users/VDPUTH/OneDrive - VITO/Mopo/Mopo_repo_github/technology-catalogue-and-gap-analysis/input_data/jrc_idees_2021/industry already exists!&quot;
[1] &quot;Files also already exist inside the directory, not downloading them again!&quot;</code></pre>
</div>
</div>
</section>
<section id="primary-and-secondary-steel-production-in-2018" class="level2">
<h2>Primary and secondary steel production in 2018</h2>
<p>Excel files have been copied manually into a folder inside the working directory. Creating functions to read all the excel files into a dataframe from a directory.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_2018 <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a> file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W20&#39;</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> <span class="fu">replace</span>(product,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel-secondary&#39;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;production_kt_idees&#39;</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>test_list_isi_2018 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_2018)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>isi_production_2018 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_2018, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id, <span class="sc">-</span>year)</span></code></pre></div>
</details>
</div>
<section id="yearly-total-steel-production-of-countries-historical-years" class="level3">
<h3>Yearly Total Steel production of countries (Historical years)</h3>
<p>From JRC-IDEES</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_allyear<span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W10&#39;</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> <span class="fu">replace</span>(product,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel-secondary&#39;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2000&#39;</span><span class="sc">:</span><span class="st">&#39;2021&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;production_kt_idees&#39;</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>test_list_isi_allyear <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_allyear)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>isi_production_allyear <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_allyear, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id, year)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>isi_production_allyear <span class="sc">|&gt;</span> </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> product, <span class="at">values_from =</span> production_kt_idees) <span class="sc">|&gt;</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">steel_total =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(steel_primary, steel_secondary), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_primary<span class="sc">:</span>steel_total, <span class="at">names_to =</span> <span class="st">&#39;product_id&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mt =</span> value<span class="sc">/</span><span class="dv">1000</span>, <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2010</span><span class="sc">:</span><span class="dv">2021</span>))<span class="ot">-&gt;</span>  isi_production_allyear_plot</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>  isi_production_allyear_plot <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">==</span> <span class="st">&#39;steel_total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, mt))<span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>), <span class="at">linewidth=</span> .<span class="dv">8</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)<span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country_code, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)<span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total Steel Historical Production in European Countries - JRC-IDEES&#39;</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Year&#39;</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Million Ton&#39;</span>)<span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="ot">-&gt;</span> p50</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  p50</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_total_allyears.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_total_allyears.svg&#39;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  isi_production_allyear_plot <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">==</span> <span class="st">&#39;steel_primary&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, mt))<span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>), <span class="at">linewidth=</span> .<span class="dv">8</span>, <span class="at">color =</span> <span class="st">&#39;orange&#39;</span>)<span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country_code, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)<span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Primary Steel historical production in European Countries&#39;</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="ot">-&gt;</span> p50</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  p50</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_primary_allyears.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_primary_allyears.svg&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  isi_production_allyear_plot <span class="sc">|&gt;</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">==</span> <span class="st">&#39;steel_secondary&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, mt))<span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>), <span class="at">linewidth=</span> .<span class="dv">8</span>, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>)<span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country_code, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)<span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Secondary Steel historical production in European Countries&#39;</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="ot">-&gt;</span> p50</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  p50</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_secondary_allyears.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_secondary_allyears.svg&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<p>Production AIDRES</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a> aidres_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>sector_id, <span class="sc">-</span>production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(production_kt_y<span class="sc">/</span><span class="dv">1000</span>, <span class="dv">3</span>), <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(mt, <span class="fu">fct_reorder</span>(country_code, mt, <span class="at">.fun =</span> sum)))<span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> product_id), <span class="at">width =</span> .<span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Steel sector production volume comparison for year 2018&#39;</span>),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Country&#39;</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Million Ton&#39;</span>) <span class="sc">+</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="ot">-&gt;</span> p50</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  p50</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_aidres_2018.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_aidres_2018.svg&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<p>Production AIDRES 2.0</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a> aidres_2_0_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>sector_id, <span class="sc">-</span>production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(production_kt_y<span class="sc">/</span><span class="dv">1000</span>, <span class="dv">3</span>), <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(mt, <span class="fu">fct_reorder</span>(country_code, mt, <span class="at">.fun =</span> sum)))<span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> product_id), <span class="at">width =</span> .<span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Steel sector production volume comparison for year 2018 2.0&#39;</span>),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Country&#39;</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Million Ton&#39;</span>) <span class="sc">+</span> </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="ot">-&gt;</span> p50</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  p50</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_aidres_2018_2_0.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_aidres_2018_2_0.svg&#39;</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="comparison-of-steel-production-between-aidresaidres-2.0-and-jrc-idees" class="level3">
<h3>Comparison of Steel Production between AIDRES/AIDRES 2.0 and JRC-IDEES</h3>
<p>We compare AIDRES/AIDRES 2.0 steel production with JRC-IDEES for the year 2018.</p>
<section id="plot-1" class="level4">
<h4>Plot</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>isi_production_allyear_plot <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;idees&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(mt,<span class="dv">3</span>)) <span class="ot">-&gt;</span> isi_production_allyear_plot</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  aidres_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>sector_id, <span class="sc">-</span>production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(production_kt_y<span class="sc">/</span><span class="dv">1000</span>, <span class="dv">3</span>), <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> product_id, <span class="at">values_from =</span> mt) <span class="sc">|&gt;</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">steel_total =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(steel_primary, steel_secondary), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_primary<span class="sc">:</span>steel_total, <span class="at">names_to =</span> <span class="st">&#39;product_id&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;mt&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;aidres&#39;</span>)  <span class="ot">-&gt;</span> aidres_production_country_plot</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(isi_production_allyear_plot <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>year), </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>            aidres_production_country_plot) <span class="sc">|&gt;</span> </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(mt, <span class="fu">fct_reorder</span>(country_code, mt, <span class="at">.fun =</span> sum)))<span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>product_id, <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Steel sector production volume comparison for year 2018&#39;</span>),</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Country&#39;</span>,</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Million Ton&#39;</span>) <span class="sc">+</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p60</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>p60</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="fu">paste0</span>(<span class="st">&#39;steel_production_compare&#39;</span>, <span class="dv">2018</span>, <span class="st">&#39;.pdf&#39;</span>)), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="fu">paste0</span>(<span class="st">&#39;steel_production_compare&#39;</span>, <span class="dv">2018</span>, <span class="st">&#39;.svg&#39;</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>isi_production_allyear_plot <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;idees&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(mt,<span class="dv">3</span>)) <span class="ot">-&gt;</span> isi_production_allyear_plot</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  aidres_2_0_production_country_2018 <span class="sc">|&gt;</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>sector_id, <span class="sc">-</span>production_route_name) <span class="sc">|&gt;</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mt =</span> <span class="fu">round</span>(production_kt_y<span class="sc">/</span><span class="dv">1000</span>, <span class="dv">3</span>), <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> product_id, <span class="at">values_from =</span> mt) <span class="sc">|&gt;</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">steel_total =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(steel_primary, steel_secondary), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> steel_primary<span class="sc">:</span>steel_total, <span class="at">names_to =</span> <span class="st">&#39;product_id&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;mt&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&#39;aidres&#39;</span>)  <span class="ot">-&gt;</span> aidres_2_0_production_country_plot</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(isi_production_allyear_plot <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>year), </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>            aidres_2_0_production_country_plot) <span class="sc">|&gt;</span> </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(mt, <span class="fu">fct_reorder</span>(country_code, mt, <span class="at">.fun =</span> sum)))<span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>product_id, <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Steel sector production volume comparison for year 2018 2.0&#39;</span>),</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Country&#39;</span>,</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Million Ton&#39;</span>) <span class="sc">+</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p60</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>p60</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="fu">paste0</span>(<span class="st">&#39;steel_production_compare&#39;</span>, <span class="dv">2018</span>, <span class="st">&#39;.pdf&#39;</span>)), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="fu">paste0</span>(<span class="st">&#39;steel_production_compare&#39;</span>, <span class="dv">2018</span>, <span class="st">&#39;.svg&#39;</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="diff-file" class="level4">
<h4>Diff file</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(isi_production_allyear_plot <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span>year), aidres_production_country_plot) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mt, <span class="at">names_from =</span> source) <span class="ot">-&gt;</span> prod_comp_2018</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">&#39;year_2018&#39;</span> <span class="ot">=</span> prod_comp_2018),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">here</span>(output_dir, <span class="st">&#39;diff_production_volume_steel_2018.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(isi_production_allyear_plot <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span>year), aidres_2_0_production_country_plot) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mt, <span class="at">names_from =</span> source) <span class="ot">-&gt;</span> prod_comp_2018_2_0</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">&#39;year_2018&#39;</span> <span class="ot">=</span> prod_comp_2018_2_0),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">here</span>(output_dir, <span class="st">&#39;diff_production_volume_steel_2018_2_0.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="finishing-and-rolling-energy" class="level3">
<h3>Finishing and rolling energy</h3>
<p>As AIDRES/AIDRES 2.0 does not include the energy consumption for refining, rolling, and finishing, these information are taken from JRC-IDEES database.</p>
</section>
<section id="rolling-energy-by-fuel" class="level3">
<h3>Rolling energy by fuel</h3>
<section id="for-primary-steel" class="level4">
<h4>For primary steel</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_r_fec_pri <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W55&#39;</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">&#39;LPG&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Diesel oil and liquid biofuels&#39;</span>  <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Natural gas and biogas&#39;</span> <span class="sc">~</span> <span class="st">&#39;natural_gas&#39;</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Fuel oil&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Steel: Furnaces, refining and rolling - Electric&#39;</span> <span class="sc">~</span> <span class="st">&#39;electricity&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">product =</span> <span class="st">&#39;steel-primary&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rolling_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, product, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">rolling_gj_idees=</span><span class="fu">sum</span>(rolling_gj_idees), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_share_roll =</span> <span class="fu">round</span>(rolling_gj_idees<span class="sc">/</span> <span class="fu">sum</span>(rolling_gj_idees), <span class="dv">3</span>))</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>test_list_isi_r_fec_pri <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_r_fec_pri)</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>isi_r_fec_pri <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_r_fec_pri, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div>
</details>
</div>
</section>
<section id="for-secondary-steel" class="level4">
<h4>For secondary steel</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_r_fec_sec <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W100&#39;</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">73</span>,<span class="dv">74</span>,<span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">&#39;LPG&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Diesel oil and liquid biofuels&#39;</span>  <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Natural gas and biogas&#39;</span> <span class="sc">~</span> <span class="st">&#39;natural_gas&#39;</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Fuel oil&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Steel: Furnaces, refining and rolling - Electric&#39;</span> <span class="sc">~</span> <span class="st">&#39;electricity&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">product =</span> <span class="st">&#39;steel-secondary&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rolling_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, product, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">rolling_gj_idees=</span><span class="fu">sum</span>(rolling_gj_idees), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_share_roll =</span> <span class="fu">round</span>(rolling_gj_idees<span class="sc">/</span> <span class="fu">sum</span>(rolling_gj_idees), <span class="dv">3</span>))</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>test_list_isi_r_fec_sec <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_r_fec_sec)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>isi_r_fec_sec <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_r_fec_sec, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div>
</details>
</div>
</section>
<section id="total-rolling-energy" class="level4">
<h4>Total rolling energy</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>isi_r_tot<span class="ot">&lt;-</span> <span class="fu">rbind</span>(isi_r_fec_sec, isi_r_fec_pri) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>isi_tot_rolling <span class="ot">&lt;-</span> isi_r_tot <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, product) <span class="sc">|&gt;</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(rolling_gj_idees)) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> total, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;rolling_gj_idees&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country_share_roll =</span><span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(isi_r_tot)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>isi_tot_rolling</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 216 × 5
   country_code product         fuel  rolling_gj_idees country_share_roll
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;              &lt;dbl&gt;
 1 AT           steel-primary   total        11777043.                  1
 2 AT           steel-secondary total         1066661.                  1
 3 BE           steel-primary   total        11494112.                  1
 4 BE           steel-secondary total         3864477.                  1
 5 BG           steel-primary   total               0                   1
 6 BG           steel-secondary total          978356.                  1
 7 CY           steel-primary   total               0                   1
 8 CY           steel-secondary total               0                   1
 9 CZ           steel-primary   total         9253475.                  1
10 CZ           steel-secondary total          374482.                  1
# ℹ 206 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="finishing-energy-by-fuel" class="level3">
<h3>Finishing energy by fuel</h3>
<section id="for-primary-steel-1" class="level4">
<h4>For primary steel</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_f_fec_pri <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W100&#39;</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">36</span><span class="sc">:</span><span class="dv">38</span>,<span class="dv">40</span><span class="sc">:</span><span class="dv">48</span>,<span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">&#39;LPG&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Diesel oil and liquid biofuels&#39;</span>  <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Natural gas and biogas&#39;</span> <span class="sc">~</span> <span class="st">&#39;natural_gas&#39;</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Solids&#39;</span> <span class="sc">~</span> <span class="st">&#39;solid_fossil_fuels&#39;</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Refinery gas&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Fuel oil&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Other liquids&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Derived gases&#39;</span> <span class="sc">~</span> <span class="st">&#39;solid_fossil_fuels&#39;</span>,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Biomass and waste&#39;</span> <span class="sc">~</span> <span class="st">&#39;renew_bio&#39;</span>,</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>                          product <span class="sc">==</span> <span class="st">&#39;Steel: Product finishing - Electric&#39;</span> <span class="sc">~</span> <span class="st">&#39;electricity&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">product =</span> <span class="st">&#39;steel-primary&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">finish_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, product, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">finish_gj_idees=</span><span class="fu">sum</span>(finish_gj_idees), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_share_finish =</span> <span class="fu">round</span>(finish_gj_idees<span class="sc">/</span> <span class="fu">sum</span>(finish_gj_idees), <span class="dv">3</span>))</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>test_list_isi_f_fec_pri <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_f_fec_pri)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>isi_f_fec_pri <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_f_fec_pri, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div>
</details>
</div>
</section>
<section id="for-secondary-steel-1" class="level4">
<h4>For secondary steel</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>read_data_isi_f_fec_sec <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W100&#39;</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">80</span><span class="sc">:</span><span class="dv">82</span>,<span class="dv">84</span><span class="sc">:</span><span class="dv">92</span>,<span class="dv">94</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">&#39;LPG&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Diesel oil and liquid biofuels&#39;</span>  <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Natural gas and biogas&#39;</span> <span class="sc">~</span> <span class="st">&#39;natural_gas&#39;</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Solids&#39;</span> <span class="sc">~</span> <span class="st">&#39;solid_fossil_fuels&#39;</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Refinery gas&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Fuel oil&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Other liquids&#39;</span> <span class="sc">~</span> <span class="st">&#39;oil_petro_products&#39;</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Derived gases&#39;</span> <span class="sc">~</span> <span class="st">&#39;solid_fossil_fuels&#39;</span>,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Biomass and waste&#39;</span> <span class="sc">~</span> <span class="st">&#39;renew_bio&#39;</span>,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">&#39;Steel: Product finishing - Electric&#39;</span> <span class="sc">~</span> <span class="st">&#39;electricity&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">product =</span> <span class="st">&#39;steel-secondary&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">finish_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, product, fuel) <span class="sc">|&gt;</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">finish_gj_idees=</span><span class="fu">sum</span>(finish_gj_idees), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_share_finish =</span> <span class="fu">round</span>(finish_gj_idees<span class="sc">/</span> <span class="fu">sum</span>(finish_gj_idees), <span class="dv">3</span>))</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>test_list_isi_f_fec_sec <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_f_fec_sec)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>isi_f_fec_sec <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_f_fec_sec, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div>
</details>
</div>
</section>
<section id="total-finishing-energy" class="level4">
<h4>Total finishing energy</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>isi_f_tot<span class="ot">&lt;-</span> <span class="fu">rbind</span>(isi_f_fec_sec, isi_f_fec_pri) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>isi_tot_finish <span class="ot">&lt;-</span> isi_f_tot <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, product) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(finish_gj_idees)) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> total, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;finish_gj_idees&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country_share_finish =</span><span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(isi_f_tot)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>isi_tot_finish</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 324 × 5
   country_code product         fuel  finish_gj_idees country_share_finish
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;           &lt;dbl&gt;                &lt;dbl&gt;
 1 AT           steel-primary   total        3759333.                    1
 2 AT           steel-secondary total         275271.                    1
 3 BE           steel-primary   total        5116184.                    1
 4 BE           steel-secondary total         939012.                    1
 5 BG           steel-primary   total              0                     1
 6 BG           steel-secondary total         868512.                    1
 7 CY           steel-primary   total              0                     1
 8 CY           steel-secondary total              0                     1
 9 CZ           steel-primary   total        3502737.                    1
10 CZ           steel-secondary total          89484.                    1
# ℹ 314 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="total-rolling-and-finishing-energy" class="level3">
<h3>Total rolling and finishing energy</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>isi_tot_roll_finish <span class="ot">&lt;-</span> <span class="fu">left_join</span>(isi_tot_finish, isi_tot_rolling, <span class="at">by =</span> <span class="fu">join_by</span>(country_code, product, fuel))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>isi_tot_roll_finish</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 324 × 7
   country_code product         fuel  finish_gj_idees country_share_finish
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;           &lt;dbl&gt;                &lt;dbl&gt;
 1 AT           steel-primary   total        3759333.                    1
 2 AT           steel-secondary total         275271.                    1
 3 BE           steel-primary   total        5116184.                    1
 4 BE           steel-secondary total         939012.                    1
 5 BG           steel-primary   total              0                     1
 6 BG           steel-secondary total         868512.                    1
 7 CY           steel-primary   total              0                     1
 8 CY           steel-secondary total              0                     1
 9 CZ           steel-primary   total        3502737.                    1
10 CZ           steel-secondary total          89484.                    1
# ℹ 314 more rows
# ℹ 2 more variables: rolling_gj_idees &lt;dbl&gt;, country_share_roll &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="calculate-total-rolling-and-finishing-energy-for-aidresaidres-2.0-steel-production" class="level3">
<h3>Calculate total rolling and finishing energy for AIDRES/AIDRES 2.0 Steel production</h3>
<p>To calculate the total energy consumption for rolling and finishing of steel (for AIDRES production volume) we first calculate the specific energy consumption of finishing and rolling by fuel using 2018 steel production and energy consumption data of JRC-IDEES.</p>
</section>
<section id="joining-production-volume-rolling-and-finishing-energy" class="level3">
<h3>Joining production volume, rolling, and finishing energy</h3>
<p>Calculate fuel specific energy consumption factors for finishing and rolling</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>steel_data_idees <span class="ot">&lt;-</span> isi_production_2018 <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(isi_tot_roll_finish, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;product&#39;</span>, <span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gj_per_t_finish =</span>  finish_gj_idees<span class="sc">/</span> production_kt_idees<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gj_per_t_roll =</span> rolling_gj_idees <span class="sc">/</span> production_kt_idees<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>steel_data_idees</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 324 × 10
   product         country_code production_kt_idees fuel         finish_gj_idees
   &lt;chr&gt;           &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
 1 steel-primary   AT                         6177. total               3759333.
 2 steel-primary   AT                         6177. electricity          991356.
 3 steel-primary   AT                         6177. natural_gas         2439881.
 4 steel-primary   AT                         6177. oil_petro_p…           9990.
 5 steel-primary   AT                         6177. renew_bio             11768.
 6 steel-primary   AT                         6177. solid_fossi…         306338.
 7 steel-secondary AT                          708. total                275271.
 8 steel-secondary AT                          708. electricity           72590.
 9 steel-secondary AT                          708. natural_gas          178656.
10 steel-secondary AT                          708. oil_petro_p…            732.
# ℹ 314 more rows
# ℹ 5 more variables: country_share_finish &lt;dbl&gt;, rolling_gj_idees &lt;dbl&gt;,
#   country_share_roll &lt;dbl&gt;, gj_per_t_finish &lt;dbl&gt;, gj_per_t_roll &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Joining with AIDRES/AIDRES 2.0 production volume, calculating total finishing and rolling energy by fuel using AIDRES production volume and IDEES sec.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb77"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>aidres_finishing_rolling_pj <span class="ot">&lt;-</span> aidres_production_country_2018 <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">&#39;product&#39;</span> <span class="ot">=</span> product_id,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&#39;production_kt_aidres&#39;</span> <span class="ot">=</span> production_kt_y) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector_id) <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(steel_data_idees, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;product&#39;</span>, <span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_pj_finish_aidres =</span> gj_per_t_finish<span class="sc">*</span>production_kt_aidres<span class="sc">*</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_pj_roll_aidres =</span> gj_per_t_roll<span class="sc">*</span>production_kt_aidres<span class="sc">*</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>production_kt_idees, <span class="sc">-</span>finish_gj_idees, <span class="sc">-</span>country_share_finish) <span class="sc">|&gt;</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, fuel, <span class="fu">everything</span>())</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>aidres_finishing_rolling_pj</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 198 × 11
   country_code product         fuel  production_route_name production_kt_aidres
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;                                &lt;dbl&gt;
 1 AT           steel-primary   total BF-BOF                                6177
 2 AT           steel-primary   elec… BF-BOF                                6177
 3 AT           steel-primary   natu… BF-BOF                                6177
 4 AT           steel-primary   oil_… BF-BOF                                6177
 5 AT           steel-primary   rene… BF-BOF                                6177
 6 AT           steel-primary   soli… BF-BOF                                6177
 7 AT           steel-secondary total Scraps EAF                             708
 8 AT           steel-secondary elec… Scraps EAF                             708
 9 AT           steel-secondary natu… Scraps EAF                             708
10 AT           steel-secondary oil_… Scraps EAF                             708
# ℹ 188 more rows
# ℹ 6 more variables: rolling_gj_idees &lt;dbl&gt;, country_share_roll &lt;dbl&gt;,
#   gj_per_t_finish &lt;dbl&gt;, gj_per_t_roll &lt;dbl&gt;, total_pj_finish_aidres &lt;dbl&gt;,
#   total_pj_roll_aidres &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_rolling_pj <span class="ot">&lt;-</span> aidres_2_0_production_country_2018 <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">&#39;product&#39;</span> <span class="ot">=</span> product_id,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&#39;production_kt_aidres&#39;</span> <span class="ot">=</span> production_kt_y) <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector_id <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector_id) <span class="sc">|&gt;</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(steel_data_idees, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;product&#39;</span>, <span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_pj_finish_aidres =</span> gj_per_t_finish<span class="sc">*</span>production_kt_aidres<span class="sc">*</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_pj_roll_aidres =</span> gj_per_t_roll<span class="sc">*</span>production_kt_aidres<span class="sc">*</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>production_kt_idees, <span class="sc">-</span>finish_gj_idees, <span class="sc">-</span>country_share_finish) <span class="sc">|&gt;</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, fuel, <span class="fu">everything</span>())</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_rolling_pj</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 198 × 11
   country_code product         fuel  production_route_name production_kt_aidres
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;                                &lt;dbl&gt;
 1 AT           steel-primary   total BF-BOF                                6177
 2 AT           steel-primary   elec… BF-BOF                                6177
 3 AT           steel-primary   natu… BF-BOF                                6177
 4 AT           steel-primary   oil_… BF-BOF                                6177
 5 AT           steel-primary   rene… BF-BOF                                6177
 6 AT           steel-primary   soli… BF-BOF                                6177
 7 AT           steel-secondary total Scraps EAF                             708
 8 AT           steel-secondary elec… Scraps EAF                             708
 9 AT           steel-secondary natu… Scraps EAF                             708
10 AT           steel-secondary oil_… Scraps EAF                             708
# ℹ 188 more rows
# ℹ 6 more variables: rolling_gj_idees &lt;dbl&gt;, country_share_roll &lt;dbl&gt;,
#   gj_per_t_finish &lt;dbl&gt;, gj_per_t_roll &lt;dbl&gt;, total_pj_finish_aidres &lt;dbl&gt;,
#   total_pj_roll_aidres &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="comparing-energy-consumption-of-aidresaidres-2.0-with-finishing-and-rolling-from-idees-with-eurostat" class="level3">
<h3>Comparing Energy consumption of AIDRES/AIDRES 2.0 (with finishing and rolling from IDEES) with EUROSTAT</h3>
<p>Summarizing finishing and rolling energy by country and fuel</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>aidres_finishing_country_pj <span class="ot">&lt;-</span> aidres_finishing_rolling_pj <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">finishing_pj =</span> <span class="fu">sum</span>(total_pj_finish_aidres),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">rolling_pj =</span> <span class="fu">sum</span>(total_pj_roll_aidres), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>aidres_finishing_country_pj</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 4
   country_code fuel               finishing_pj rolling_pj
   &lt;chr&gt;        &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           electricity              1.06       4.52  
 2 AT           natural_gas              2.62       8.28  
 3 AT           oil_petro_products       0.0107     0.0438
 4 AT           renew_bio                0.0126    NA     
 5 AT           solid_fossil_fuels       0.329     NA     
 6 AT           total                    4.03      12.8   
 7 BE           electricity              1.88       6.66  
 8 BE           natural_gas              3.27       8.38  
 9 BE           oil_petro_products       0.208      0.340 
10 BE           renew_bio                0.0701    NA     
# ℹ 110 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_country_pj <span class="ot">&lt;-</span> aidres_2_0_finishing_rolling_pj <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel) <span class="sc">|&gt;</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">finishing_pj =</span> <span class="fu">sum</span>(total_pj_finish_aidres),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">rolling_pj =</span> <span class="fu">sum</span>(total_pj_roll_aidres), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_country_pj</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 4
   country_code fuel               finishing_pj rolling_pj
   &lt;chr&gt;        &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           electricity              1.06       4.52  
 2 AT           natural_gas              2.62       8.28  
 3 AT           oil_petro_products       0.0107     0.0438
 4 AT           renew_bio                0.0126    NA     
 5 AT           solid_fossil_fuels       0.329     NA     
 6 AT           total                    4.03      12.8   
 7 BE           electricity              1.88       6.66  
 8 BE           natural_gas              3.27       8.38  
 9 BE           oil_petro_products       0.208      0.340 
10 BE           renew_bio                0.0701    NA     
# ℹ 110 more rows</code></pre>
</div>
</div>
<p>Add finishing and rolling data with EUROSTAT and AIDRES/AIDRES 2.0 data</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling <span class="ot">&lt;-</span> steel_eurostat_aidres <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_finishing_country_pj, <span class="at">by =</span> <span class="fu">join_by</span>(country_code,  fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres, finishing_pj, rolling_pj), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>finishing_pj, <span class="sc">-</span>rolling_pj) <span class="sc">|&gt;</span> </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>aidres, <span class="at">names_to =</span> <span class="st">&#39;source&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 536 × 6
   country_code country fuel               sector source        pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;
 1 AT           Austria electricity        steel  eurostat 13.8   
 2 AT           Austria electricity        steel  aidres   10.7   
 3 AT           Austria heat               steel  eurostat  0.3   
 4 AT           Austria heat               steel  aidres    0     
 5 AT           Austria natural_gas        steel  eurostat  2.22  
 6 AT           Austria natural_gas        steel  aidres   11.0   
 7 AT           Austria non_renew_waste    steel  eurostat  0.6   
 8 AT           Austria non_renew_waste    steel  aidres    0     
 9 AT           Austria oil_petro_products steel  eurostat  0.06  
10 AT           Austria oil_petro_products steel  aidres    0.0545
# ℹ 526 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling_2_0 <span class="ot">&lt;-</span> steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_finishing_country_pj, <span class="at">by =</span> <span class="fu">join_by</span>(country_code,  fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres, finishing_pj, rolling_pj), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>finishing_pj, <span class="sc">-</span>rolling_pj) <span class="sc">|&gt;</span> </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>aidres, <span class="at">names_to =</span> <span class="st">&#39;source&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;pj&#39;</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,004 × 6
   country_code country fuel               sector source        pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;
 1 AT           Austria electricity        steel  eurostat 13.8   
 2 AT           Austria electricity        steel  aidres   10.7   
 3 AT           Austria heat               steel  eurostat  0.3   
 4 AT           Austria heat               steel  aidres    0     
 5 AT           Austria natural_gas        steel  eurostat  2.22  
 6 AT           Austria natural_gas        steel  aidres   11.0   
 7 AT           Austria non_renew_waste    steel  eurostat  0.6   
 8 AT           Austria non_renew_waste    steel  aidres    0     
 9 AT           Austria oil_petro_products steel  eurostat  0.06  
10 AT           Austria oil_petro_products steel  aidres    0.0545
# ℹ 994 more rows</code></pre>
</div>
</div>
</section>
<section id="plotting-and-diff-files" class="level3">
<h3>Plotting and diff files</h3>
<section id="plot-2" class="level4">
<h4>Plot</h4>
<p>plotting with fuel categories</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Fuel wise total energy consumption in the steel sector in AIDRES and EUROSTAT for the year 2018&#39;</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is included in AIDRES database from JRC-IDEES&#39;</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> p4</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  p4</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.
`fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 52 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_fr.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 52 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_fr.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 52 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 52 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>data_all_finishing_rolling_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Fuel wise total energy consumption in the steel sector in AIDRES 2.0 and EUROSTAT for the year 2018&#39;</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is included in AIDRES 2.0 database from JRC-IDEES&#39;</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> p4</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  p4</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.
`fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 286 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_fr_2_0.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 286 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_fuel_fr_2_0.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fct_reorder()` removing 286 missing values.
ℹ Use `.na_rm = TRUE` to silence this message.
ℹ Use `.na_rm = FALSE` to preserve NAs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 286 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<p>plotting only total energy</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  data_all_finishing_rolling <span class="sc">|&gt;</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption in the steel sector in AIDRES and EUROSTAT&#39;</span>,</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is included in AIDRES database from JRC-IDEES for the year 2018&#39;</span>,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span> </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p5</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  p5</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_fr.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_fr.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  data_all_finishing_rolling_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total energy consumption in the steel sector in AIDRES 2.0 and EUROSTAT&#39;</span>,</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Rolling and finishing energy is included in AIDRES 2.0 database from JRC-IDEES for the year 2018&#39;</span>,</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;country&#39;</span>,</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;PJ&#39;</span>) <span class="sc">+</span> </span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p5</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  p5</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="steel_analysis_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_fr_2_0.pdf&#39;</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_fec_compare_tot_fr_2_0.svg&#39;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="diff-files-1" class="level3">
<h3>Diff files</h3>
<p>Fuel wise with finishing and rolling</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>   data_all_finishing_rolling <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>( <span class="sc">-</span>country) <span class="sc">|&gt;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;diff_with_finishing_rolling_fuel.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb116"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>   data_all_finishing_rolling_2_0 <span class="sc">|&gt;</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>( <span class="sc">-</span>country) <span class="sc">|&gt;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;diff_with_finishing_rolling_fuel_2_0.xlsx&#39;</span>))</span></code></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="steel-sector-claibration-w.r.t-eurostat-data" class="level1">
<h1>Steel sector claibration w.r.t EUROSTAT data</h1>
<p>We have obtained the rolling and finishing data from JRC-IDEES. We also calculate corresponding sec values. Now, we calibrate the AIDRES/AIDRES 2.0 final energy consumption w.r.t EUROSTAT values. Therefore, we subtract the total rolling and finishing energy from final energy of EUROSTAT. This constitute the ‘true’ energy consumption for the process routes ‘upto rolling and finishing’. Subsequently the sec factors are calculated for the process routes ‘upto rolling and finishing’.</p>
<section id="eurostat-without-finishing-rolling" class="level2">
<h2>Eurostat without finishing rolling</h2>
<p>We subtract the finishing and rolling energy for AIDRES/AIDRES 2.0 steel production from total final energy consumption of EUROSTAT.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>   eurostat_without_finishing_rolling <span class="ot">&lt;-</span> steel_eurostat_aidres <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>           source <span class="sc">==</span> <span class="st">&#39;eurostat&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">replace_na</span>(pj, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(aidres_finishing_country_pj, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span>, <span class="st">&#39;fuel&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">finishing_pj =</span> <span class="fu">replace_na</span>(finishing_pj, <span class="dv">0</span>),</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">rolling_pj =</span> <span class="fu">replace_na</span>(finishing_pj, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">without_finishing_pj =</span> pj <span class="sc">-</span> finishing_pj <span class="sc">-</span> rolling_pj) <span class="sc">|&gt;</span> </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(pj, finishing_pj, rolling_pj))</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>eurostat_without_finishing_rolling</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 268 × 5
   country_code country fuel               sector without_finishing_pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           Austria electricity        steel               11.6   
 2 AT           Austria heat               steel                0.3   
 3 AT           Austria natural_gas        steel               -3.02  
 4 AT           Austria non_renew_waste    steel                0.6   
 5 AT           Austria oil_petro_products steel                0.0386
 6 AT           Austria renew_bio          steel                0.0347
 7 AT           Austria solid_fossil_fuels steel               87.8   
 8 AT           Austria total              steel               97.4   
 9 BE           Belgium electricity        steel               12.4   
10 BE           Belgium heat               steel                0     
# ℹ 258 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>   eurostat_without_finishing_rolling_2_0 <span class="ot">&lt;-</span> steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>           source <span class="sc">==</span> <span class="st">&#39;eurostat&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">replace_na</span>(pj, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(aidres_2_0_finishing_country_pj, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span>, <span class="st">&#39;fuel&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">finishing_pj =</span> <span class="fu">replace_na</span>(finishing_pj, <span class="dv">0</span>),</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">rolling_pj =</span> <span class="fu">replace_na</span>(finishing_pj, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">without_finishing_pj =</span> pj <span class="sc">-</span> finishing_pj <span class="sc">-</span> rolling_pj) <span class="sc">|&gt;</span> </span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(pj, finishing_pj, rolling_pj))</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>eurostat_without_finishing_rolling_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 502 × 5
   country_code country fuel               sector without_finishing_pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           Austria electricity        steel               11.6   
 2 AT           Austria heat               steel                0.3   
 3 AT           Austria natural_gas        steel               -3.02  
 4 AT           Austria non_renew_waste    steel                0.6   
 5 AT           Austria oil_petro_products steel                0.0386
 6 AT           Austria renew_bio          steel                0.0347
 7 AT           Austria solid_fossil_fuels steel               87.8   
 8 AT           Austria total              steel               97.4   
 9 BE           Belgium electricity        steel               12.4   
10 BE           Belgium heat               steel                0     
# ℹ 492 more rows</code></pre>
</div>
</div>
<p>EUROSTAT doesn’t have primary/ secondary breakup. This is obtained from IDEES data.</p>
</section>
<section id="reading-primary-steel-energy-consumption-from-idees" class="level2">
<h2>Reading primary steel energy consumption from IDEES</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>      read_data_isi_fec_pri <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W100&#39;</span>,</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="dv">4</span>, <span class="dv">34</span>, <span class="dv">27</span>) <span class="sc">|&gt;</span> </span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">process =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">process =</span> <span class="fu">replace</span>(process, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">&#39;steel-primary-tot&#39;</span>, <span class="st">&#39;steel-primary-finishing&#39;</span>, <span class="st">&#39;steel-primary-rolling&#39;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">fec_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>, <span class="at">ktoe =</span> <span class="cn">NULL</span>) </span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>      test_list_isi_fec_pri <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_fec_pri)</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>      isi_fec_pri <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_fec_pri, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id, <span class="sc">-</span>year)</span></code></pre></div>
</details>
</div>
</section>
<section id="reading-secondary-steel-energy-consumption-from-idees" class="level2">
<h2>Reading secondary steel energy consumption from IDEES</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb122"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>      read_data_isi_fec_sec <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">&#39;/JRC-IDEES-2021_Industry_&#39;</span>, country, <span class="st">&quot;.xlsx&quot;</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">&#39;ISI_fec&#39;</span>, <span class="at">range =</span> <span class="st">&#39;A2:W100&#39;</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;product&#39;</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">slice</span>(<span class="dv">53</span>, <span class="dv">78</span>, <span class="dv">71</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rename</span>(<span class="at">process =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">process =</span> <span class="fu">replace</span>(process,</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">&#39;steel-secondary-tot&#39;</span>, <span class="st">&#39;steel-secondary-finishing&#39;</span>, <span class="st">&#39;steel-secondary-rolling&#39;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">&#39;2018&#39;</span>, <span class="at">names_to =</span> <span class="st">&#39;year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;ktoe&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">fec_gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ktoe =</span> <span class="cn">NULL</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>      test_list_isi_fec_sec <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_isi_fec_sec)</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>      isi_fec_sec <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_isi_fec_sec, <span class="at">.id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id, <span class="sc">-</span>year)</span></code></pre></div>
</details>
</div>
</section>
<section id="separating-out-finishing-and-rolling-energy-from-total-total-final-energy-consumption-in-idees" class="level2">
<h2>Separating out finishing and rolling energy from total total final energy consumption in IDEES</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>isi_fec_sec_fr <span class="ot">&lt;-</span> isi_fec_sec <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> process, <span class="at">values_from =</span> fec_gj_idees) <span class="sc">|&gt;</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">fec_sec_net =</span> steel_secondary_tot <span class="sc">-</span>  steel_secondary_finishing <span class="sc">-</span> steel_secondary_rolling) <span class="sc">|&gt;</span> </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(steel_secondary_tot, steel_secondary_finishing, steel_secondary_rolling))</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>      isi_fec_sec_fr</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 2
   country_code fec_sec_net
   &lt;chr&gt;              &lt;dbl&gt;
 1 AT              1443611.
 2 BE              4707913.
 3 BG              3429134.
 4 HR               680583.
 5 CY                    0 
 6 CZ               548795.
 7 DK              2297170.
 8 EE                    0 
 9 FI              3277985.
10 FR              9789640.
# ℹ 17 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>isi_fec_pri_fr <span class="ot">&lt;-</span> isi_fec_pri <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> process, <span class="at">values_from =</span> fec_gj_idees) <span class="sc">|&gt;</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">fec_pri_net =</span> steel_primary_tot <span class="sc">-</span> steel_primary_finishing <span class="sc">-</span> steel_primary_rolling) <span class="sc">|&gt;</span> </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(steel_primary_tot, steel_primary_finishing, steel_primary_rolling))</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>      isi_fec_pri_fr</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 2
   country_code fec_pri_net
   &lt;chr&gt;              &lt;dbl&gt;
 1 AT             17331162.
 2 BE             20145764.
 3 BG                    0 
 4 HR                    0 
 5 CY                    0 
 6 CZ             26797860.
 7 DK                    0 
 8 EE                    0 
 9 FI             13140331.
10 FR             31540163.
# ℹ 17 more rows</code></pre>
</div>
</div>
</section>
<section id="ratio-of-secondary-and-primary-energy-consumption-without-finishing-and-rolling" class="level2">
<h2>Ratio of secondary and primary energy consumption without finishing and rolling</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(isi_fec_pri_fr, isi_fec_sec_fr, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rename</span>(<span class="st">&#39;steel_primary&#39;</span> <span class="ot">=</span> fec_pri_net,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;steel_secondary&#39;</span> <span class="ot">=</span> fec_sec_net) <span class="sc">|&gt;</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country_code, <span class="at">names_to =</span> <span class="st">&#39;prod_route&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;gj&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">tot_pj =</span> gj<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(country_code) <span class="sc">|&gt;</span> </span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">prod_route_share =</span> tot_pj<span class="sc">/</span> <span class="fu">sum</span>(tot_pj)) <span class="sc">|&gt;</span> </span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>tot_pj) <span class="sc">|&gt;</span> </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">prod_route =</span> <span class="fu">str_remove</span>(prod_route, <span class="st">&#39;_tot&#39;</span>))<span class="ot">-&gt;</span> steel_idees_fec_share_no_finish_roll</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>steel_idees_fec_share_no_finish_roll</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 3
# Groups:   country_code [27]
   country_code prod_route      prod_route_share
   &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;
 1 AT           steel_primary             0.923 
 2 AT           steel_secondary           0.0769
 3 BE           steel_primary             0.811 
 4 BE           steel_secondary           0.189 
 5 BG           steel_primary             0     
 6 BG           steel_secondary           1     
 7 HR           steel_primary             0     
 8 HR           steel_secondary           1     
 9 CY           steel_primary           NaN     
10 CY           steel_secondary         NaN     
# ℹ 44 more rows</code></pre>
</div>
</div>
<p>Applying primary, secondary energy (without rolling and finishing) to the EUROSTAT FEC (without rolling and finishing) to obtain primary, secondary breakup of energy consumption (without rolling and finishing)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb129"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>eurostat_without_finishing_rolling <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>                                             fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector, <span class="sc">-</span>fuel) <span class="ot">-&gt;</span> steel_eurostat_fec_no_finish</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_idees_fec_share_no_finish_roll, steel_eurostat_fec_no_finish, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(country_code, country, prod_route, prod_route_share, without_finishing_pj) <span class="sc">|&gt;</span> </span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">pj_route =</span> without_finishing_pj<span class="sc">*</span>prod_route_share, <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="ot">-&gt;</span> steel_eurostat_fec_prod_route</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>steel_eurostat_fec_prod_route</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 4
# Groups:   country_code [27]
   country_code country  prod_route      pj_route
   &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
 1 AT           Austria  steel_primary     89.9  
 2 AT           Austria  steel_secondary    7.49 
 3 BE           Belgium  steel_primary     85.1  
 4 BE           Belgium  steel_secondary   19.9  
 5 BG           Bulgaria steel_primary      0    
 6 BG           Bulgaria steel_secondary    3.54 
 7 HR           Croatia  steel_primary      0    
 8 HR           Croatia  steel_secondary    0.824
 9 CY           Cyprus   steel_primary    NaN    
10 CY           Cyprus   steel_secondary  NaN    
# ℹ 44 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>eurostat_without_finishing_rolling_2_0 <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>                                             fuel <span class="sc">==</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sector, <span class="sc">-</span>fuel) <span class="ot">-&gt;</span> steel_eurostat_fec_no_finish_2_0</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_idees_fec_share_no_finish_roll, steel_eurostat_fec_no_finish_2_0, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(country_code, country, prod_route, prod_route_share, without_finishing_pj) <span class="sc">|&gt;</span> </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">pj_route =</span> without_finishing_pj<span class="sc">*</span>prod_route_share, <span class="at">.keep =</span> <span class="st">&#39;unused&#39;</span>) <span class="ot">-&gt;</span> steel_eurostat_fec_prod_route_2_0</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>steel_eurostat_fec_prod_route_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 4
# Groups:   country_code [27]
   country_code country  prod_route      pj_route
   &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
 1 AT           Austria  steel_primary     89.9  
 2 AT           Austria  steel_secondary    7.49 
 3 BE           Belgium  steel_primary     85.1  
 4 BE           Belgium  steel_secondary   19.9  
 5 BG           Bulgaria steel_primary      0    
 6 BG           Bulgaria steel_secondary    3.54 
 7 HR           Croatia  steel_primary      0    
 8 HR           Croatia  steel_secondary    0.824
 9 CY           Cyprus   steel_primary    NaN    
10 CY           Cyprus   steel_secondary  NaN    
# ℹ 44 more rows</code></pre>
</div>
</div>
<section id="new-secs-for-production-routes-no-finishing-and-roling" class="level4">
<h4>New SECs for production routes no finishing and roling</h4>
<p>Applying EUROSTAT fuel share of primary and secondary to the net energy</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres <span class="sc">|&gt;</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>         source <span class="sc">==</span> <span class="st">&#39;eurostat&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span> sector, <span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels  =</span> solid_fossil_fuels <span class="sc">/</span> total,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">electricity  =</span> electricity <span class="sc">/</span> total,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">natural_gas =</span> natural_gas <span class="sc">/</span> total,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> oil_petro_products <span class="sc">/</span> total,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> renew_bio <span class="sc">/</span> total,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> non_renew_waste <span class="sc">/</span> total,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">hydrogen  =</span> hydrogen <span class="sc">/</span> total,</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">methanol =</span> methanol <span class="sc">/</span> total,</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">heat =</span> heat<span class="sc">/</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>total) <span class="sc">|&gt;</span> </span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> electricity<span class="sc">:</span>methanol, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;fuel_share&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_eurostat_fec_prod_route, <span class="at">by=</span><span class="fu">join_by</span>(country_code, country), <span class="at">relationship =</span> <span class="st">&#39;many-to-many&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, prod_route, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fuel_route_pj =</span> <span class="fu">round</span>(pj_route<span class="sc">*</span>fuel_share,<span class="dv">3</span>)) <span class="ot">-&gt;</span> steel_fuel_route_pj</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>steel_fuel_route_pj</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 486 × 7
   country_code country prod_route      fuel   fuel_share pj_route fuel_route_pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
 1 AT           Austria steel_primary   elect…   0.130       89.9         11.7  
 2 AT           Austria steel_secondary elect…   0.130        7.49         0.977
 3 AT           Austria steel_primary   heat     0.00284     89.9          0.256
 4 AT           Austria steel_secondary heat     0.00284      7.49         0.021
 5 AT           Austria steel_primary   natur…   0.0211      89.9          1.89 
 6 AT           Austria steel_secondary natur…   0.0211       7.49         0.158
 7 AT           Austria steel_primary   non_r…   0.00569     89.9          0.511
 8 AT           Austria steel_secondary non_r…   0.00569      7.49         0.043
 9 AT           Austria steel_primary   oil_p…   0.000569    89.9          0.051
10 AT           Austria steel_secondary oil_p…   0.000569     7.49         0.004
# ℹ 476 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>steel_eurostat_aidres_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">&#39;steel&#39;</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>         source <span class="sc">==</span> <span class="st">&#39;eurostat&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span> sector, <span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels  =</span> solid_fossil_fuels <span class="sc">/</span> total,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">electricity  =</span> electricity <span class="sc">/</span> total,</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">natural_gas =</span> natural_gas <span class="sc">/</span> total,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> oil_petro_products <span class="sc">/</span> total,</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> renew_bio <span class="sc">/</span> total,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> non_renew_waste <span class="sc">/</span> total,</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">hydrogen  =</span> hydrogen <span class="sc">/</span> total,</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">methanol =</span> methanol <span class="sc">/</span> total,</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">heat =</span> heat<span class="sc">/</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>total) <span class="sc">|&gt;</span> </span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> electricity<span class="sc">:</span>methanol, <span class="at">names_to =</span> <span class="st">&#39;fuel&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;fuel_share&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_eurostat_fec_prod_route_2_0, <span class="at">by=</span><span class="fu">join_by</span>(country_code, country), <span class="at">relationship =</span> <span class="st">&#39;many-to-many&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, prod_route, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fuel_route_pj =</span> <span class="fu">round</span>(pj_route<span class="sc">*</span>fuel_share,<span class="dv">3</span>)) <span class="ot">-&gt;</span> steel_fuel_route_pj_2_0</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>steel_fuel_route_pj_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 918 × 8
   country_code country prod_route      py_naphtha fuel      fuel_share pj_route
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
 1 AT           Austria steel_primary           NA electric…   0.130       89.9 
 2 AT           Austria steel_secondary         NA electric…   0.130        7.49
 3 AT           Austria steel_primary           NA heat        0.00284     89.9 
 4 AT           Austria steel_secondary         NA heat        0.00284      7.49
 5 AT           Austria steel_primary           NA natural_…   0.0211      89.9 
 6 AT           Austria steel_secondary         NA natural_…   0.0211       7.49
 7 AT           Austria steel_primary           NA non_rene…   0.00569     89.9 
 8 AT           Austria steel_secondary         NA non_rene…   0.00569      7.49
 9 AT           Austria steel_primary           NA oil_petr…   0.000569    89.9 
10 AT           Austria steel_secondary         NA oil_petr…   0.000569     7.49
# ℹ 908 more rows
# ℹ 1 more variable: fuel_route_pj &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="specific-energy-consumption-factor-upto-finishing-and-rolling" class="level4">
<h4>Specific energy consumption factor upto finishing and rolling</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>isi_aidres_production_comp <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id<span class="sc">!=</span> <span class="st">&#39;steel_total&#39;</span>) <span class="ot">-&gt;</span> steel_prod_aidres</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_fuel_route_pj, steel_prod_aidres, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_code&#39;</span>, <span class="st">&#39;prod_route&#39;</span> <span class="sc">==</span> <span class="st">&#39;product_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">sec_gj_t =</span> fuel_route_pj<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span><span class="sc">/</span>(kt<span class="sc">*</span><span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(fuel_share, pj_route, fuel_route_pj, kt)) <span class="ot">-&gt;</span> steel_aidres_fec_no_finish_roll</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>      steel_aidres_fec_no_finish_roll</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 486 × 6
   country_code country prod_route      fuel      production_route_name sec_gj_t
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
 1 AT           Austria steel_primary   electric… BF-BOF                 1.90   
 2 AT           Austria steel_secondary electric… Scraps EAF             1.38   
 3 AT           Austria steel_primary   heat      BF-BOF                 0.0414 
 4 AT           Austria steel_secondary heat      Scraps EAF             0.0297 
 5 AT           Austria steel_primary   natural_… BF-BOF                 0.306  
 6 AT           Austria steel_secondary natural_… Scraps EAF             0.223  
 7 AT           Austria steel_primary   non_rene… BF-BOF                 0.0827 
 8 AT           Austria steel_secondary non_rene… Scraps EAF             0.0607 
 9 AT           Austria steel_primary   oil_petr… BF-BOF                 0.00826
10 AT           Austria steel_secondary oil_petr… Scraps EAF             0.00565
# ℹ 476 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>isi_aidres_2_0_production_comp <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id<span class="sc">!=</span> <span class="st">&#39;steel_total&#39;</span>) <span class="ot">-&gt;</span> steel_prod_aidres_2_0</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(steel_fuel_route_pj_2_0, steel_prod_aidres_2_0, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_code&#39;</span>, <span class="st">&#39;prod_route&#39;</span> <span class="sc">==</span> <span class="st">&#39;product_id&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>source) <span class="sc">|&gt;</span> </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">sec_gj_t =</span> fuel_route_pj<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span><span class="sc">/</span>(kt<span class="sc">*</span><span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(fuel_share, pj_route, fuel_route_pj, kt)) <span class="ot">-&gt;</span> steel_aidres_2_0_fec_no_finish_roll</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>      steel_aidres_2_0_fec_no_finish_roll</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 918 × 7
   country_code country prod_route      py_naphtha fuel    production_route_name
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                
 1 AT           Austria steel_primary           NA electr… BF-BOF               
 2 AT           Austria steel_secondary         NA electr… Scraps EAF           
 3 AT           Austria steel_primary           NA heat    BF-BOF               
 4 AT           Austria steel_secondary         NA heat    Scraps EAF           
 5 AT           Austria steel_primary           NA natura… BF-BOF               
 6 AT           Austria steel_secondary         NA natura… Scraps EAF           
 7 AT           Austria steel_primary           NA non_re… BF-BOF               
 8 AT           Austria steel_secondary         NA non_re… Scraps EAF           
 9 AT           Austria steel_primary           NA oil_pe… BF-BOF               
10 AT           Austria steel_secondary         NA oil_pe… Scraps EAF           
# ℹ 908 more rows
# ℹ 1 more variable: sec_gj_t &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="secs-for-finishing-and-rolling" class="level4">
<h4>Secs for finishing and rolling</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb141"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>aidres_finishing_rolling_pj <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">!=</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, production_route_name, fuel, gj_per_t_finish, gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_finish_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_finish,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;sec_roll_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span><span class="fu">replace</span>(product, product<span class="sc">==</span><span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel_primary&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span> <span class="fu">replace</span>(product, product <span class="sc">==</span> <span class="st">&#39;steel-secondary&#39;</span>, <span class="st">&#39;steel_secondary&#39;</span>)) <span class="ot">-&gt;</span> sec_rolling_finish</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>sec_rolling_finish <span class="sc">|&gt;</span> </span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sec_finish_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production_route_name =</span> <span class="fu">paste0</span>(<span class="st">&#39;rolling-&#39;</span>, production_route_name)) <span class="sc">|&gt;</span> </span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> sec_roll_gj_t) <span class="ot">-&gt;</span> sec_rolling_steel</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>sec_rolling_steel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 8
   country_code product         production_route_name electricity natural_gas
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;                       &lt;dbl&gt;       &lt;dbl&gt;
 1 AT           steel_primary   rolling-BF-BOF              0.671       1.23 
 2 AT           steel_secondary rolling-Scraps EAF          0.530       0.971
 3 BE           steel_primary   rolling-BF-BOF              0.940       1.18 
 4 BE           steel_secondary rolling-Scraps EAF          0.622       0.783
 5 BG           steel_secondary rolling-Scraps EAF          0.442       1.02 
 6 CZ           steel_primary   rolling-BF-BOF              0.973       1.03 
 7 CZ           steel_secondary rolling-Scraps EAF          0.744       0.787
 8 DE           steel_primary   rolling-BF-BOF              0.984       1.06 
 9 DE           steel_secondary rolling-Scraps EAF          0.737       0.795
10 EL           steel_secondary rolling-Scraps EAF          0.878       0.274
# ℹ 23 more rows
# ℹ 3 more variables: oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;,
#   solid_fossil_fuels &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb143"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>sec_rolling_finish <span class="sc">|&gt;</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sec_roll_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production_route_name =</span> <span class="fu">paste0</span>(<span class="st">&#39;finishing-&#39;</span>, production_route_name)) <span class="sc">|&gt;</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> sec_finish_gj_t) <span class="ot">-&gt;</span> sec_finishing_steel</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>sec_finishing_steel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 8
   country_code product         production_route_name electricity natural_gas
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;                       &lt;dbl&gt;       &lt;dbl&gt;
 1 AT           steel_primary   finishing-BF-BOF            0.160       0.395
 2 AT           steel_secondary finishing-Scraps EAF        0.103       0.252
 3 BE           steel_primary   finishing-BF-BOF            0.299       0.521
 4 BE           steel_secondary finishing-Scraps EAF        0.108       0.188
 5 BG           steel_secondary finishing-Scraps EAF        0.274       1.02 
 6 CZ           steel_primary   finishing-BF-BOF            0.293       0.329
 7 CZ           steel_secondary finishing-Scraps EAF        0.141       0.159
 8 DE           steel_primary   finishing-BF-BOF            0.398       0.512
 9 DE           steel_secondary finishing-Scraps EAF        0.155       0.199
10 EL           steel_secondary finishing-Scraps EAF        0.189       0.112
# ℹ 23 more rows
# ℹ 3 more variables: oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;,
#   solid_fossil_fuels &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb145"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_rolling_pj <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">!=</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, production_route_name, fuel, gj_per_t_finish, gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_finish_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_finish,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;sec_roll_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span><span class="fu">replace</span>(product, product<span class="sc">==</span><span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel_primary&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span> <span class="fu">replace</span>(product, product <span class="sc">==</span> <span class="st">&#39;steel-secondary&#39;</span>, <span class="st">&#39;steel_secondary&#39;</span>)) <span class="ot">-&gt;</span> sec_rolling_finish_2_0</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>sec_rolling_finish_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sec_finish_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production_route_name =</span> <span class="fu">paste0</span>(<span class="st">&#39;rolling-&#39;</span>, production_route_name)) <span class="sc">|&gt;</span> </span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> sec_roll_gj_t) <span class="ot">-&gt;</span> sec_rolling_steel_2_0</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>sec_rolling_steel_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 8
   country_code product         production_route_name electricity natural_gas
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;                       &lt;dbl&gt;       &lt;dbl&gt;
 1 AT           steel_primary   rolling-BF-BOF              0.671       1.23 
 2 AT           steel_secondary rolling-Scraps EAF          0.530       0.971
 3 BE           steel_primary   rolling-BF-BOF              0.940       1.18 
 4 BE           steel_secondary rolling-Scraps EAF          0.622       0.783
 5 BG           steel_secondary rolling-Scraps EAF          0.442       1.02 
 6 CZ           steel_primary   rolling-BF-BOF              0.973       1.03 
 7 CZ           steel_secondary rolling-Scraps EAF          0.744       0.787
 8 DE           steel_primary   rolling-BF-BOF              0.984       1.06 
 9 DE           steel_secondary rolling-Scraps EAF          0.737       0.795
10 EL           steel_secondary rolling-Scraps EAF          0.878       0.274
# ℹ 23 more rows
# ℹ 3 more variables: oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;,
#   solid_fossil_fuels &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb147"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>sec_rolling_finish_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sec_roll_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production_route_name =</span> <span class="fu">paste0</span>(<span class="st">&#39;finishing-&#39;</span>, production_route_name)) <span class="sc">|&gt;</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> sec_finish_gj_t) <span class="ot">-&gt;</span> sec_finishing_steel_2_0</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>sec_finishing_steel_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 8
   country_code product         production_route_name electricity natural_gas
   &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;                       &lt;dbl&gt;       &lt;dbl&gt;
 1 AT           steel_primary   finishing-BF-BOF            0.160       0.395
 2 AT           steel_secondary finishing-Scraps EAF        0.103       0.252
 3 BE           steel_primary   finishing-BF-BOF            0.299       0.521
 4 BE           steel_secondary finishing-Scraps EAF        0.108       0.188
 5 BG           steel_secondary finishing-Scraps EAF        0.274       1.02 
 6 CZ           steel_primary   finishing-BF-BOF            0.293       0.329
 7 CZ           steel_secondary finishing-Scraps EAF        0.141       0.159
 8 DE           steel_primary   finishing-BF-BOF            0.398       0.512
 9 DE           steel_secondary finishing-Scraps EAF        0.155       0.199
10 EL           steel_secondary finishing-Scraps EAF        0.189       0.112
# ℹ 23 more rows
# ℹ 3 more variables: oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;,
#   solid_fossil_fuels &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="adding-finishing-and-rolling-secs-to-the-database" class="level4">
<h4>Adding finishing and rolling secs to the database</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb149"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>aidres_finishing_rolling_pj <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">!=</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, production_route_name, fuel, gj_per_t_finish, gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_finish_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_finish,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;sec_roll_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span><span class="fu">replace</span>(product, product<span class="sc">==</span><span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel_primary&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span> <span class="fu">replace</span>(product, product <span class="sc">==</span> <span class="st">&#39;steel-secondary&#39;</span>, <span class="st">&#39;steel_secondary&#39;</span>)) <span class="ot">-&gt;</span> aidres_finishing_rolling_pj_</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>steel_aidres_fec_no_finish_roll <span class="sc">|&gt;</span> <span class="fu">left_join</span>(aidres_finishing_rolling_pj_, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_code&#39;</span>,<span class="st">&#39;prod_route&#39;</span> <span class="sc">==</span> <span class="st">&#39;product&#39;</span>,<span class="st">&#39;fuel&#39;</span> <span class="sc">==</span> <span class="st">&#39;fuel&#39;</span>,<span class="st">&#39;production_route_name&#39;</span> <span class="sc">==</span> <span class="st">&#39;production_route_name&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_norf_gj_t&#39;</span> <span class="ot">=</span> sec_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code , prod_route ) <span class="sc">|&gt;</span> </span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(production_route_name))<span class="ot">-&gt;</span> steel_sec</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>  steel_sec</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 297 × 8
   country_code country prod_route     fuel  production_route_name sec_norf_gj_t
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt;
 1 AT           Austria steel_primary  elec… BF-BOF                      1.90   
 2 AT           Austria steel_primary  heat  BF-BOF                      0.0414 
 3 AT           Austria steel_primary  natu… BF-BOF                      0.306  
 4 AT           Austria steel_primary  non_… BF-BOF                      0.0827 
 5 AT           Austria steel_primary  oil_… BF-BOF                      0.00826
 6 AT           Austria steel_primary  rene… BF-BOF                      0.00826
 7 AT           Austria steel_primary  soli… BF-BOF                     12.2    
 8 AT           Austria steel_primary  hydr… BF-BOF                     NA      
 9 AT           Austria steel_primary  meth… BF-BOF                     NA      
10 AT           Austria steel_seconda… elec… Scraps EAF                  1.38   
# ℹ 287 more rows
# ℹ 2 more variables: sec_finish_gj_t &lt;dbl&gt;, sec_roll_gj_t &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb151"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_finishing_rolling_pj <span class="sc">|&gt;</span> <span class="fu">filter</span>(fuel <span class="sc">!=</span> <span class="st">&#39;total&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, product, production_route_name, fuel, gj_per_t_finish, gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_finish_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_finish,</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;sec_roll_gj_t&#39;</span> <span class="ot">=</span> gj_per_t_roll) <span class="sc">|&gt;</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span><span class="fu">replace</span>(product, product<span class="sc">==</span><span class="st">&#39;steel-primary&#39;</span>, <span class="st">&#39;steel_primary&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product=</span> <span class="fu">replace</span>(product, product <span class="sc">==</span> <span class="st">&#39;steel-secondary&#39;</span>, <span class="st">&#39;steel_secondary&#39;</span>)) <span class="ot">-&gt;</span> aidres_2_0_finishing_rolling_pj_</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>steel_aidres_2_0_fec_no_finish_roll <span class="sc">|&gt;</span> <span class="fu">left_join</span>(aidres_2_0_finishing_rolling_pj_, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&#39;country_code&#39;</span> <span class="sc">==</span> <span class="st">&#39;country_code&#39;</span>,<span class="st">&#39;prod_route&#39;</span> <span class="sc">==</span> <span class="st">&#39;product&#39;</span>,<span class="st">&#39;fuel&#39;</span> <span class="sc">==</span> <span class="st">&#39;fuel&#39;</span>,<span class="st">&#39;production_route_name&#39;</span> <span class="sc">==</span> <span class="st">&#39;production_route_name&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;sec_norf_gj_t&#39;</span> <span class="ot">=</span> sec_gj_t) <span class="sc">|&gt;</span> </span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code , prod_route ) <span class="sc">|&gt;</span> </span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(production_route_name))<span class="ot">-&gt;</span> steel_sec_2_0</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>  steel_sec_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 561 × 9
   country_code country prod_route    py_naphtha fuel      production_route_name
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;                
 1 AT           Austria steel_primary         NA electric… BF-BOF               
 2 AT           Austria steel_primary         NA heat      BF-BOF               
 3 AT           Austria steel_primary         NA natural_… BF-BOF               
 4 AT           Austria steel_primary         NA non_rene… BF-BOF               
 5 AT           Austria steel_primary         NA oil_petr… BF-BOF               
 6 AT           Austria steel_primary         NA renew_bio BF-BOF               
 7 AT           Austria steel_primary         NA solid_fo… BF-BOF               
 8 AT           Austria steel_primary         NA ammonia   BF-BOF               
 9 AT           Austria steel_primary         NA bio_meth… BF-BOF               
10 AT           Austria steel_primary         NA bio_meth… BF-BOF               
# ℹ 551 more rows
# ℹ 3 more variables: sec_norf_gj_t &lt;dbl&gt;, sec_finish_gj_t &lt;dbl&gt;,
#   sec_roll_gj_t &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="creating-final-data-frame-for-steel" class="level4">
<h4>Creating final data frame for steel</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb153"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>steel_sec <span class="sc">|&gt;</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">&#39;gj_t&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;finishing&#39;</span> <span class="ot">=</span> sec_finish_gj_t ,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;rolling&#39;</span> <span class="ot">=</span> sec_roll_gj_t ,</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;upto_roll_fin&#39;</span> <span class="ot">=</span> sec_norf_gj_t,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;prod_route&#39;</span> <span class="ot">=</span> production_route_name,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;product&#39;</span> <span class="ot">=</span>  <span class="st">&#39;prod_route&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(finishing, upto_roll_fin,rolling) ,  <span class="at">names_to =</span> <span class="st">&#39;process_route&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value, <span class="dv">3</span>)) <span class="ot">-&gt;</span> steel_sec1</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>steel_sec1 <span class="sc">|&gt;</span> </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(process_route <span class="sc">==</span> <span class="st">&#39;upto_roll_fin&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">process_route =</span> <span class="fu">paste</span>(prod_route, process_route, <span class="at">sep =</span> <span class="st">&#39;-&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="sc">-</span>prod_route) <span class="sc">|&gt;</span> </span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>product, process_route, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> steel_sec_upto_fr</span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a>steel_sec_upto_fr</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 14
   country_code country  product         process_route   unit  electricity  heat
   &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 AT           Austria  steel_primary   BF-BOF-upto_ro… gj_t         1.90 0.041
 2 AT           Austria  steel_secondary Scraps EAF-upt… gj_t         1.38 0.03 
 3 BE           Belgium  steel_primary   BF-BOF-upto_ro… gj_t         2.21 0    
 4 BE           Belgium  steel_secondary Scraps EAF-upt… gj_t         1.02 0    
 5 BG           Bulgaria steel_secondary Scraps EAF-upt… gj_t         2.96 0    
 6 CZ           Czechia  steel_primary   BF-BOF-upto_ro… gj_t         1.76 0.846
 7 CZ           Czechia  steel_secondary Scraps EAF-upt… gj_t         0.69 0.331
 8 DE           Germany  steel_primary   BF-BOF-upto_ro… gj_t         2.29 0.058
 9 DE           Germany  steel_secondary Scraps EAF-upt… gj_t         1.06 0.027
10 EL           Greece   steel_secondary Scraps EAF-upt… gj_t         2.02 0    
# ℹ 23 more rows
# ℹ 7 more variables: natural_gas &lt;dbl&gt;, non_renew_waste &lt;dbl&gt;,
#   oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;, solid_fossil_fuels &lt;dbl&gt;,
#   hydrogen &lt;dbl&gt;, methanol &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb155"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>steel_sec1 <span class="sc">|&gt;</span> </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(process_route <span class="sc">!=</span> <span class="st">&#39;upto_roll_fin&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>prod_route,) <span class="sc">|&gt;</span> </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>product, process_route, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> steel_sec_fr</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>steel_sec_fr</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 14
   country_code country  product         process_route unit  electricity  heat
   &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 AT           Austria  steel_primary   finishing     gj_t        0.16     NA
 2 AT           Austria  steel_primary   rolling       gj_t        0.671    NA
 3 AT           Austria  steel_secondary finishing     gj_t        0.103    NA
 4 AT           Austria  steel_secondary rolling       gj_t        0.53     NA
 5 BE           Belgium  steel_primary   finishing     gj_t        0.299    NA
 6 BE           Belgium  steel_primary   rolling       gj_t        0.94     NA
 7 BE           Belgium  steel_secondary finishing     gj_t        0.108    NA
 8 BE           Belgium  steel_secondary rolling       gj_t        0.622    NA
 9 BG           Bulgaria steel_secondary finishing     gj_t        0.274    NA
10 BG           Bulgaria steel_secondary rolling       gj_t        0.442    NA
# ℹ 56 more rows
# ℹ 7 more variables: natural_gas &lt;dbl&gt;, non_renew_waste &lt;dbl&gt;,
#   oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;, solid_fossil_fuels &lt;dbl&gt;,
#   hydrogen &lt;dbl&gt;, methanol &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb157"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">&#39;sec_upto_rolling_finishing&#39;</span> <span class="ot">=</span> steel_sec_upto_fr,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;sec_finishing_rolling&#39;</span> <span class="ot">=</span> steel_sec_fr),</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(output_dir, <span class="st">&#39;steel_final_process_routes.xlsx&#39;</span>) )</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb158"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>steel_sec_2_0 <span class="sc">|&gt;</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">&#39;gj_t&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;finishing&#39;</span> <span class="ot">=</span> sec_finish_gj_t ,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;rolling&#39;</span> <span class="ot">=</span> sec_roll_gj_t ,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;upto_roll_fin&#39;</span> <span class="ot">=</span> sec_norf_gj_t,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;prod_route&#39;</span> <span class="ot">=</span> production_route_name,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;product&#39;</span> <span class="ot">=</span>  <span class="st">&#39;prod_route&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(finishing, upto_roll_fin,rolling) ,  <span class="at">names_to =</span> <span class="st">&#39;process_route&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value, <span class="dv">3</span>)) <span class="ot">-&gt;</span> steel_sec1_2_0</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>steel_sec1_2_0<span class="sc">|&gt;</span> </span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(process_route <span class="sc">==</span> <span class="st">&#39;upto_roll_fin&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">process_route =</span> <span class="fu">paste</span>(prod_route, process_route, <span class="at">sep =</span> <span class="st">&#39;-&#39;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="sc">-</span>prod_route) <span class="sc">|&gt;</span> </span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>product, process_route, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> steel_sec_upto_fr_2_0</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>steel_sec_upto_fr_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 23
   country_code country product process_route unit  py_naphtha electricity  heat
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 AT           Austria steel_… BF-BOF-upto_… gj_t          NA        1.90 0.041
 2 AT           Austria steel_… Scraps EAF-u… gj_t          NA        1.38 0.03 
 3 BE           Belgium steel_… BF-BOF-upto_… gj_t          NA        2.21 0    
 4 BE           Belgium steel_… Scraps EAF-u… gj_t          NA        1.02 0    
 5 BG           Bulgar… steel_… Scraps EAF-u… gj_t          NA        2.96 0    
 6 CZ           Czechia steel_… BF-BOF-upto_… gj_t          NA        1.76 0.846
 7 CZ           Czechia steel_… Scraps EAF-u… gj_t          NA        0.69 0.331
 8 DE           Germany steel_… BF-BOF-upto_… gj_t          NA        2.29 0.058
 9 DE           Germany steel_… Scraps EAF-u… gj_t          NA        1.06 0.027
10 EL           Greece  steel_… Scraps EAF-u… gj_t          NA        2.02 0    
# ℹ 23 more rows
# ℹ 15 more variables: natural_gas &lt;dbl&gt;, non_renew_waste &lt;dbl&gt;,
#   oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;, solid_fossil_fuels &lt;dbl&gt;,
#   ammonia &lt;dbl&gt;, bio_methanol_import &lt;dbl&gt;, bio_methanol_local &lt;dbl&gt;,
#   bio_naphtha_import &lt;dbl&gt;, bio_naphtha_local &lt;dbl&gt;, biomass_import &lt;dbl&gt;,
#   biomass_local &lt;dbl&gt;, ethane &lt;dbl&gt;, hydrogen &lt;dbl&gt;, methanol &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb160"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>steel_sec1_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(process_route <span class="sc">!=</span> <span class="st">&#39;upto_roll_fin&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>prod_route,) <span class="sc">|&gt;</span> </span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>product, process_route, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> steel_sec_fr_2_0</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>steel_sec_fr_2_0</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 23
   country_code country product process_route unit  py_naphtha electricity  heat
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 AT           Austria steel_… finishing     gj_t          NA       0.16     NA
 2 AT           Austria steel_… rolling       gj_t          NA       0.671    NA
 3 AT           Austria steel_… finishing     gj_t          NA       0.103    NA
 4 AT           Austria steel_… rolling       gj_t          NA       0.53     NA
 5 BE           Belgium steel_… finishing     gj_t          NA       0.299    NA
 6 BE           Belgium steel_… rolling       gj_t          NA       0.94     NA
 7 BE           Belgium steel_… finishing     gj_t          NA       0.108    NA
 8 BE           Belgium steel_… rolling       gj_t          NA       0.622    NA
 9 BG           Bulgar… steel_… finishing     gj_t          NA       0.274    NA
10 BG           Bulgar… steel_… rolling       gj_t          NA       0.442    NA
# ℹ 56 more rows
# ℹ 15 more variables: natural_gas &lt;dbl&gt;, non_renew_waste &lt;dbl&gt;,
#   oil_petro_products &lt;dbl&gt;, renew_bio &lt;dbl&gt;, solid_fossil_fuels &lt;dbl&gt;,
#   ammonia &lt;dbl&gt;, bio_methanol_import &lt;dbl&gt;, bio_methanol_local &lt;dbl&gt;,
#   bio_naphtha_import &lt;dbl&gt;, bio_naphtha_local &lt;dbl&gt;, biomass_import &lt;dbl&gt;,
#   biomass_local &lt;dbl&gt;, ethane &lt;dbl&gt;, hydrogen &lt;dbl&gt;, methanol &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb162"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">&#39;sec_upto_rolling_finishing&#39;</span> <span class="ot">=</span> steel_sec_upto_fr_2_0,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;sec_finishing_rolling&#39;</span> <span class="ot">=</span> steel_sec_fr_2_0),</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(output_dir, <span class="st">&#39;steel_final_process_routes.xlsx&#39;</span>) )</span></code></pre></div>
</details>
</div>
</section>
<section id="writing-production-routes-in-a-excel-workbook" class="level3">
<h3>Writing production routes in a excel workbook</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode" id="cb163"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>sec_upto_rf_new <span class="sc">|&gt;</span> </span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_routes.xlsx&#39;</span>), <span class="at">sheet =</span> <span class="st">&#39;sec_upto_rf_new&#39;</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>sec_rolling_steel <span class="sc">|&gt;</span> </span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_routes.xlsx&#39;</span>), <span class="at">sheet =</span> <span class="st">&#39;sec_rolling&#39;</span>, <span class="at">append=</span><span class="cn">TRUE</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>sec_finishing_steel <span class="sc">|&gt;</span> </span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">&#39;steel_production_routes.xlsx&#39;</span>), <span class="at">sheet =</span> <span class="st">&#39;sec_finishing&#39;</span>, <span class="at">append=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-RJ-2017-019" class="csl-entry" role="listitem">
Lahti, Leo, Janne Huovari, Markus Kainu, and Przemysław Biecek. 2017. <span>“<span class="nocase">Retrieval and Analysis of Eurostat Open Data with the eurostat Package</span>.”</span> <em><span>The R Journal</span></em> 9 (1): 385–92. <a href="https://doi.org/10.32614/RJ-2017-019">https://doi.org/10.32614/RJ-2017-019</a>.
</div>
<div id="ref-jrc-idees_report" class="csl-entry" role="listitem">
Mate, Rozsai, Jaxa-Rozen Marc, Salvucci Raffaele, Sikora Przemyslaw, Tattini Jacopo, and Neuwahl Frederik. 2024. <span>“JRC-IDEES-2021.”</span> European Commission, Joint Research Centre. <a href="http://data.europa.eu/89h/82322924-506a-4c9a-8532-2bdd30d69bf5">http://data.europa.eu/89h/82322924-506a-4c9a-8532-2bdd30d69bf5</a>.
</div>
<div id="ref-aidres_report" class="csl-entry" role="listitem">
Vermeiren, Karolien, Wim Clymans, Lorenz Hambsch, and Leen Van Esch. 2023. <span>“AIDRES - Advancing Industrial Decarbonization by Assessing the Future Use of Renewable Energies in Industrial Processes.”</span> European Commission, Joint Research Centre. <a href="http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d">http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d</a>.
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id = "quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->

</body>

</html>
