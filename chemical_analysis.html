<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Partha Das">
<meta name="author" content="Pieter Valkering">
<meta name="author" content="Hans Van de Put">
<meta name="dcterms.date" content="2026-01-29">
<meta name="keywords" content="AIDRES, EUROSTAT, JRC-IDEES">

<title>Analyzing Chemical Sector energy consumption</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="chemical_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="chemical_analysis_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="chemical_analysis_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="chemical_analysis_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="chemical_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="chemical_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chemical_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="chemical_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chemical_analysis_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chemical_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chemical_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chemical_analysis_files/libs/bootstrap/bootstrap-2b16cb1ea19488d2d80dabb165e63084.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#using-this-file" id="toc-using-this-file" class="nav-link" data-scroll-target="#using-this-file">Using this file</a></li>
  </ul></li>
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries">Loading libraries</a></li>
  <li><a href="#reading-country-names-and-codes" id="toc-reading-country-names-and-codes" class="nav-link" data-scroll-target="#reading-country-names-and-codes">Reading country names and codes</a></li>
  <li><a href="#jrc-idees-basic-chemical-energy-consumption" id="toc-jrc-idees-basic-chemical-energy-consumption" class="nav-link" data-scroll-target="#jrc-idees-basic-chemical-energy-consumption">JRC-IDEES Basic Chemical Energy Consumption</a>
  <ul class="collapse">
  <li><a href="#download-idees-excel-files" id="toc-download-idees-excel-files" class="nav-link" data-scroll-target="#download-idees-excel-files">Download IDEES excel files</a>
  <ul class="collapse">
  <li><a href="#basic-chemical-energy-consumption-by-fuel" id="toc-basic-chemical-energy-consumption-by-fuel" class="nav-link" data-scroll-target="#basic-chemical-energy-consumption-by-fuel">Basic chemical energy consumption by fuel</a></li>
  <li><a href="#allocating-steam-and-heat-to-a-fuel-category" id="toc-allocating-steam-and-heat-to-a-fuel-category" class="nav-link" data-scroll-target="#allocating-steam-and-heat-to-a-fuel-category">Allocating steam and heat to a fuel category</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#aidres-aidres-2.0-chemical-sector-energy-consumption" id="toc-aidres-aidres-2.0-chemical-sector-energy-consumption" class="nav-link" data-scroll-target="#aidres-aidres-2.0-chemical-sector-energy-consumption">AIDRES + AIDRES 2.0 Chemical sector energy consumption</a>
  <ul class="collapse">
  <li><a href="#establishing-aidres-database-connection-and-fetching-tables" id="toc-establishing-aidres-database-connection-and-fetching-tables" class="nav-link" data-scroll-target="#establishing-aidres-database-connection-and-fetching-tables">Establishing AIDRES database connection and fetching tables</a></li>
  <li><a href="#importing-aidres-and-aidres-2.0-data-from-local-.csv-files" id="toc-importing-aidres-and-aidres-2.0-data-from-local-.csv-files" class="nav-link" data-scroll-target="#importing-aidres-and-aidres-2.0-data-from-local-.csv-files">Importing AIDRES and AIDRES 2.0 data from local <code>.csv</code> files</a>
  <ul class="collapse">
  <li><a href="#reading-the-aidres-and-aidres-2.0-data-from-.csv-files." id="toc-reading-the-aidres-and-aidres-2.0-data-from-.csv-files." class="nav-link" data-scroll-target="#reading-the-aidres-and-aidres-2.0-data-from-.csv-files.">Reading the AIDRES and AIDRES 2.0 data from <code>.csv</code> files.</a></li>
  </ul></li>
  <li><a href="#energy-consumption-all-sectors-in-2018" id="toc-energy-consumption-all-sectors-in-2018" class="nav-link" data-scroll-target="#energy-consumption-all-sectors-in-2018">Energy consumption all sectors in 2018</a></li>
  <li><a href="#chemical-sector-energy-consumption" id="toc-chemical-sector-energy-consumption" class="nav-link" data-scroll-target="#chemical-sector-energy-consumption">Chemical sector energy consumption</a></li>
  </ul></li>
  <li><a href="#eurostat-chemical-energy-consumption" id="toc-eurostat-chemical-energy-consumption" class="nav-link" data-scroll-target="#eurostat-chemical-energy-consumption">EUROSTAT Chemical Energy Consumption</a>
  <ul class="collapse">
  <li><a href="#downloading-eurostat-energy-balance" id="toc-downloading-eurostat-energy-balance" class="nav-link" data-scroll-target="#downloading-eurostat-energy-balance">Downloading Eurostat energy balance</a>
  <ul class="collapse">
  <li><a href="#joining-aidresaidres-2.0-and-eurostat-chemical-energy-consumption" id="toc-joining-aidresaidres-2.0-and-eurostat-chemical-energy-consumption" class="nav-link" data-scroll-target="#joining-aidresaidres-2.0-and-eurostat-chemical-energy-consumption">Joining AIDRES/AIDRES 2.0 and EUROSTAT Chemical energy consumption</a></li>
  </ul></li>
  <li><a href="#compare-aidresaidres-2.0-chemical-fertiliser-vs-jrc-idees-basic-chemicals" id="toc-compare-aidresaidres-2.0-chemical-fertiliser-vs-jrc-idees-basic-chemicals" class="nav-link" data-scroll-target="#compare-aidresaidres-2.0-chemical-fertiliser-vs-jrc-idees-basic-chemicals">Compare AIDRES/AIDRES 2.0 Chemical + Fertiliser vs JRC-IDEES basic chemicals</a>
  <ul class="collapse">
  <li><a href="#creating-output-directory" id="toc-creating-output-directory" class="nav-link" data-scroll-target="#creating-output-directory">Creating output directory</a></li>
  <li><a href="#prepare-data" id="toc-prepare-data" class="nav-link" data-scroll-target="#prepare-data">Prepare data</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots">Plots</a></li>
  <li><a href="#diff-file" id="toc-diff-file" class="nav-link" data-scroll-target="#diff-file">Diff file</a></li>
  </ul></li>
  <li><a href="#filling-the-gap-for-basic-chemical" id="toc-filling-the-gap-for-basic-chemical" class="nav-link" data-scroll-target="#filling-the-gap-for-basic-chemical">Filling the gap for Basic Chemical</a>
  <ul class="collapse">
  <li><a href="#creating-input-directory-for-chlorine-data" id="toc-creating-input-directory-for-chlorine-data" class="nav-link" data-scroll-target="#creating-input-directory-for-chlorine-data">Creating input directory for Chlorine data</a></li>
  <li><a href="#getting-chlorine-data" id="toc-getting-chlorine-data" class="nav-link" data-scroll-target="#getting-chlorine-data">Getting Chlorine data</a></li>
  <li><a href="#compare-aidresaidres-2.0-chemical-fertilizer-eurochlor-chlorine-with-idees-basic-chemicals" id="toc-compare-aidresaidres-2.0-chemical-fertilizer-eurochlor-chlorine-with-idees-basic-chemicals" class="nav-link" data-scroll-target="#compare-aidresaidres-2.0-chemical-fertilizer-eurochlor-chlorine-with-idees-basic-chemicals">Compare AIDRES/AIDRES 2.0 Chemical + Fertilizer + Eurochlor (Chlorine) with IDEES Basic Chemicals</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#other-chemicals-and-pharmaceuticals" id="toc-other-chemicals-and-pharmaceuticals" class="nav-link" data-scroll-target="#other-chemicals-and-pharmaceuticals">Other Chemicals and Pharmaceuticals</a>
  <ul class="collapse">
  <li><a href="#jrc-idees-other-chemicals" id="toc-jrc-idees-other-chemicals" class="nav-link" data-scroll-target="#jrc-idees-other-chemicals">JRC-IDEES Other Chemicals</a>
  <ul class="collapse">
  <li><a href="#generic-electricity-process" id="toc-generic-electricity-process" class="nav-link" data-scroll-target="#generic-electricity-process">Generic electricity process</a></li>
  <li><a href="#low-enthalpy-heat" id="toc-low-enthalpy-heat" class="nav-link" data-scroll-target="#low-enthalpy-heat">Low enthalpy heat</a></li>
  <li><a href="#high-enthalpy-heat" id="toc-high-enthalpy-heat" class="nav-link" data-scroll-target="#high-enthalpy-heat">High enthalpy heat</a></li>
  <li><a href="#furnace" id="toc-furnace" class="nav-link" data-scroll-target="#furnace">Furnace</a></li>
  <li><a href="#process-cooling" id="toc-process-cooling" class="nav-link" data-scroll-target="#process-cooling">Process cooling</a></li>
  <li><a href="#total-other-chemicals" id="toc-total-other-chemicals" class="nav-link" data-scroll-target="#total-other-chemicals">Total other chemicals</a></li>
  </ul></li>
  <li><a href="#allocating-steam-and-heat-to-a-fuel-category-1" id="toc-allocating-steam-and-heat-to-a-fuel-category-1" class="nav-link" data-scroll-target="#allocating-steam-and-heat-to-a-fuel-category-1">Allocating steam and heat to a fuel category</a>
  <ul class="collapse">
  <li><a href="#all-chemical-data" id="toc-all-chemical-data" class="nav-link" data-scroll-target="#all-chemical-data">All chemical data</a></li>
  </ul></li>
  <li><a href="#compare-aidresaidres-2.0-eurochlor-chlorine-chem-others-jrc-idees-total-idees-eurostat-chemical-non-energy" id="toc-compare-aidresaidres-2.0-eurochlor-chlorine-chem-others-jrc-idees-total-idees-eurostat-chemical-non-energy" class="nav-link" data-scroll-target="#compare-aidresaidres-2.0-eurochlor-chlorine-chem-others-jrc-idees-total-idees-eurostat-chemical-non-energy">Compare AIDRES/AIDRES 2.0 + Eurochlor (Chlorine) + Chem Others JRC-IDEES, total IDEES, EUROSTAT Chemical + non energy</a>
  <ul class="collapse">
  <li><a href="#comparison-graph-total-2" id="toc-comparison-graph-total-2" class="nav-link" data-scroll-target="#comparison-graph-total-2">Comparison graph total</a></li>
  <li><a href="#comparison-graph-fuels-2" id="toc-comparison-graph-fuels-2" class="nav-link" data-scroll-target="#comparison-graph-fuels-2">Comparison graph fuels</a></li>
  <li><a href="#diff-file-2" id="toc-diff-file-2" class="nav-link" data-scroll-target="#diff-file-2">Diff file</a></li>
  </ul></li>
  <li><a href="#aidres-data-for-eu-case-study-not-used" id="toc-aidres-data-for-eu-case-study-not-used" class="nav-link" data-scroll-target="#aidres-data-for-eu-case-study-not-used">AIDRES+ data for EU case study (not used!)</a>
  <ul class="collapse">
  <li><a href="#aidres-data-for-chlorine-and-other-chemicals" id="toc-aidres-data-for-chlorine-and-other-chemicals" class="nav-link" data-scroll-target="#aidres-data-for-chlorine-and-other-chemicals">AIDRES+ data for Chlorine, and Other Chemicals</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyzing Chemical Sector energy consumption</h1>
<p class="subtitle lead">AIDRES, JRC-IDEES, EUROSTAT</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Partha Das </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Pieter Valkering </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Hans Van de Put </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2026</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>AIDRES, EUROSTAT, JRC-IDEES</p>
  </div>
</div>

</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This is a stand-alone quarto document with code chunks and documentation for comparing Chemical sector energy consumption in AIDRES, AIDRES 2.0, EUROSTAT, and JRC-IDEES databases.</p>
<p>AIDRES only covers ‘basic chemicals’ omitting chlorine. However, in JRC IDEES database there is a breakup of basic chemical, other chemical, and pharma. Though AIDRES has separate fertilizer sector, we add it to chemical for comparison purpose. First, we compare AIDRES chemical data with JRC-IDEES basic chemical. Subsequently, we add chlorine energy consumption from Eurochlor database to the AIDRES and compare AIDRES + Eurochlor (Chlorine) with JRC_IDEES basic chemicals.</p>
<p>As AIDRES does not contain other chemicals we take it directly from JRC IDEES database. Finally we compare AIDRES + Eurochlor (Chlorine) + Chem others IDEES, total IDEES, and EUROSTAT + non-energy</p>
<p>Therefore, three comparison steps:</p>
<ul>
<li>Compare AIDRES vs IDEES basic chemicals (IDEES)</li>
<li>Compare with AIDRES + Eurochlor (Chlorine) vs JRC-IDEES basic chemicals</li>
<li>Compare AIDRES + Eurochlor (Chlorine) + Chem others JRC-IDEES, total JRC-IDEES, and EUROSTAT + non-energy</li>
</ul>
<p>Exactly the same comparison is made between AIDRES 2.0, EUROSTAT and JRC-IDEES</p>
<section id="using-this-file" class="level2">
<h2 class="anchored" data-anchor-id="using-this-file">Using this file</h2>
<p>The files are produced using <a href="https://posit.co/download/rstudio-desktop/">R</a> and <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>. Though this document can be executed using command line, it is recommended to use <code>RStudio</code> for rendering.</p>
<p>Clone this repository to your computer. Open the <code>mopo_repo.Rproj</code> (<code>RStudio needs to be installed</code>) file. Open <code>chemical_analysis.qmd</code> and click on <code>render button</code> (Crtl + Shift + K).</p>
</section>
</section>
<section id="loading-libraries" class="level1">
<h1>Loading libraries</h1>
<p>Checking whether the required packages are installed or not. If not, install them and load them. If they are already installed, just load them.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mypackages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="st">'readxl'</span>, <span class="st">'knitr'</span>, <span class="st">'janitor'</span>, <span class="st">'archive'</span>, <span class="st">'DBI'</span>, <span class="st">'odbc'</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">'RPostgres'</span>, <span class="st">'eurostat'</span>, <span class="st">'stringr'</span>, <span class="st">'forcats'</span>, <span class="st">'writexl'</span>, <span class="st">'xlsx'</span>, <span class="st">'gt'</span>, <span class="st">'here'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> mypackages){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="reading-country-names-and-codes" class="level1">
<h1>Reading country names and codes</h1>
<p>This is provided with the repository by default in the <code>input_data\europe_country_codes</code> directory.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>country_codes <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'europe_country_codes'</span>, <span class="st">'europe_country_code.xlsx'</span>), <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>country_codes</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 2
   country  country_iso_code
   &lt;chr&gt;    &lt;chr&gt;           
 1 Austria  AT              
 2 Belgium  BE              
 3 Bulgaria BG              
 4 Croatia  HR              
 5 Cyprus   CY              
 6 Czechia  CZ              
 7 Denmark  DK              
 8 Estonia  EE              
 9 Finland  FI              
10 France   FR              
# ℹ 17 more rows</code></pre>
</div>
</div>
</section>
<section id="jrc-idees-basic-chemical-energy-consumption" class="level1">
<h1>JRC-IDEES Basic Chemical Energy Consumption</h1>
<section id="download-idees-excel-files" class="level2">
<h2 class="anchored" data-anchor-id="download-idees-excel-files">Download IDEES excel files</h2>
<p><code>JRC‑IDEES provides a consistent set of disaggregated energy-economy-emissions data for each Member State of the European Union, covering all sectors of the energy system for the 2000-2021 period: industry, buildings, transport, and power generation. This data complies with Eurostat energy balances while providing a plausible decomposition of energy consumption into specific processes and end uses</code> <span class="citation" data-cites="jrc-idees_report">(<a href="#ref-jrc-idees_report" role="doc-biblioref">Mate et al. 2024</a>)</span>.</p>
<p>Checking whether there is a directory (<code>./input_data/jrc_idees_2021/industry</code>) containing JRC-IDEES excel files for energy balance. If not (only checking with <code>JRC-IDEES-2021_Industry_AT.xlsx</code>), creating the directory, downloading the zipped files, and extracting them for each country.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>idees_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'jrc_idees_2021'</span>, <span class="st">'industry'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(idees_data)){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Directory doesn't exists! Creating one"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(idees_data, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Downloading files"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(country_code <span class="cf">in</span> country_codes<span class="sc">$</span>country_iso_code){</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  zip_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/JRC-IDEES/JRC-IDEES-2021_v1/JRC-IDEES-2021_"</span>, country_code)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"JRC-IDEES-2021_Industry_"</span>, country_code, <span class="st">".xlsx"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">archive_extract</span>(<span class="at">archive =</span> zip_file,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir =</span> idees_data,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">files =</span> filename)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Directory'</span>, idees_data,  <span class="st">'already exists!'</span>))</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">here</span>(idees_data, <span class="st">'JRC-IDEES-2021_Industry_AT.xlsx'</span>))){</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="st">"But files does not exists! downloading them"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(country_code <span class="cf">in</span> country_codes<span class="sc">$</span>country_iso_code){</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  zip_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/JRC-IDEES/JRC-IDEES-2021_v1/JRC-IDEES-2021_"</span>, country_code)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"JRC-IDEES-2021_Industry_"</span>, country_code, <span class="st">".xlsx"</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">archive_extract</span>(<span class="at">archive =</span> zip_file,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir =</span> idees_data,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">files =</span> filename)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Files also already exist inside the directory, not downloading them again!'</span>))</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Directory C:/Users/VDPUTH/OneDrive - VITO/Mopo/Mopo_repo_github/technology-catalogue-and-gap-analysis/input_data/jrc_idees_2021/industry already exists!"
[1] "Files also already exist inside the directory, not downloading them again!"</code></pre>
</div>
</div>
<section id="basic-chemical-energy-consumption-by-fuel" class="level3">
<h3 class="anchored" data-anchor-id="basic-chemical-energy-consumption-by-fuel">Basic chemical energy consumption by fuel</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_bc <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="at">range =</span> <span class="st">'A2:W100'</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">37</span><span class="sc">:</span><span class="dv">42</span>, <span class="dv">44</span>, <span class="dv">46</span><span class="sc">:</span><span class="dv">56</span>, <span class="dv">57</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'Lighting'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Air compressors'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Motor drives'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Motor drives'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fans and pumps'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solar and geothermal'</span> <span class="sc">~</span> <span class="st">'renew_bio'</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Electricity'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'LPG'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Diesel oil and liquid biofuels'</span>  <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Diesel oil'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Naphtha'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas and biogas'</span> <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas'</span>  <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solids'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Refinery gas'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fuel oil'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Other liquids'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Derived gases'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Biomass and waste'</span> <span class="sc">~</span> <span class="st">'renew_bio'</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Process cooling - Electric'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Furnaces - Electric'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Process cooling - Natural gas and biogas'</span> <span class="sc">~</span><span class="st">'natural_gas'</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Distributed steam'</span> <span class="sc">~</span> <span class="st">'steam'</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Generic electric process'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Ambient heat'</span> <span class="sc">~</span> <span class="st">'heat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">product =</span> <span class="st">'chem_basic'</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>     <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(country_code, product, fuel) <span class="sc">|&gt;</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_bc <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_bc)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>chem_fec_bc <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_bc, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="allocating-steam-and-heat-to-a-fuel-category" class="level3">
<h3 class="anchored" data-anchor-id="allocating-steam-and-heat-to-a-fuel-category">Allocating steam and heat to a fuel category</h3>
<p>Lets assume the heat and steam is produced by gas. Assume the heat production from gas is 95% efficient</p>
<p>Deactivated</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gas_heat_eff <span class="ot">=</span> .<span class="dv">95</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>chem_fec_bc <span class="ot">&lt;-</span> chem_fec_bc <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> gj_idees) <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">natural_gas =</span> natural_gas <span class="sc">+</span> (heat<span class="sc">+</span>steam)<span class="sc">/</span>gas_heat_eff, <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> electricity<span class="sc">:</span>solid_fossil_fuels, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'gj_idees'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
</section>
<section id="aidres-aidres-2.0-chemical-sector-energy-consumption" class="level1">
<h1>AIDRES + AIDRES 2.0 Chemical sector energy consumption</h1>
<section id="establishing-aidres-database-connection-and-fetching-tables" class="level2">
<h2 class="anchored" data-anchor-id="establishing-aidres-database-connection-and-fetching-tables">Establishing AIDRES database connection and fetching tables</h2>
<p>AIDRES database is open source <span class="citation" data-cites="aidres_report">(<a href="#ref-aidres_report" role="doc-biblioref">Vermeiren et al. 2023</a>)</span>. However the data is available as a raw <code>.sql</code> file which needs to be further used to setup a PostgreSQL database connection to fetch various tables. The data is also available as an Excel workbook. However, it is very customized to be used for specific analysis.</p>
</section>
<section id="importing-aidres-and-aidres-2.0-data-from-local-.csv-files" class="level2">
<h2 class="anchored" data-anchor-id="importing-aidres-and-aidres-2.0-data-from-local-.csv-files">Importing AIDRES and AIDRES 2.0 data from local <code>.csv</code> files</h2>
<p>However, for an external user setting up a PostgreSQL server is not straight forward. Therefore, AIDRES tables are provided with this repository in the <code>input_data\aidres_data</code> directory.</p>
<p>the AIDRES tables used for this analysis are first exported into <code>.csv</code> files and then they are used further in the analysis. Following code chunks create the directory (<code>input_data\aidres_data</code>) for storing the AIDRES files, and exports the AIDRES data files into <code>.csv</code> format. However, they are currently deactivated as we provide the files already with the repo.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>aidres_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'aidres_data'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(aidres_data)){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"AIDRES input data folder doesn't exist. Request VITO to provide the data"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(aidres_data)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"AIDRES input data directory already exists. Not creating a new one!"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"AIDRES data tables also exist!"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AIDRES input data directory already exists. Not creating a new one!"
[1] "AIDRES data tables also exist!"</code></pre>
</div>
</div>
<p>The following AIDRES data tables namely <code>aidres_scenarios.csv</code>, <code>aidres_sectors.csv</code>, <code>aidres_result.csv</code>, <code>aidres_configurations.csv</code>, <code>aidres_perton.csv</code> are made available in the <code>aidres_data</code> folder. The code chunk is currently deactivated.</p>
<p>Dumping AIDRES PSQL tables to <code>.csv</code> files (currently deactivated)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aidres_scenarios <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_scenarios.csv'</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>aidres_sectors <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span>  <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_sectors.csv'</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span>  <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_result.csv'</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>aidres_configurations<span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_configurations.csv'</span>)) </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>aidres_perton<span class="sc">|&gt;</span> <span class="fu">collect</span>() <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_perton.csv'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="reading-the-aidres-and-aidres-2.0-data-from-.csv-files." class="level3">
<h3 class="anchored" data-anchor-id="reading-the-aidres-and-aidres-2.0-data-from-.csv-files.">Reading the AIDRES and AIDRES 2.0 data from <code>.csv</code> files.</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>aidres_scenarios <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_scenarios.csv'</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>aidres_sectors <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_sectors.csv'</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_result.csv'</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>aidres_configurations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_configurations.csv'</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>aidres_perton <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_perton.csv'</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>aidres_2_0_sectors <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_2_0_sectors.csv'</span>))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(aidres_data, <span class="st">"aidres_2_0_results.csv"</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>, <span class="at">grouping_mark =</span> <span class="st">","</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">guess_max =</span> <span class="dv">6000</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>aidres_2_0_configurations <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_2_0_configurations.csv'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="energy-consumption-all-sectors-in-2018" class="level2">
<h2 class="anchored" data-anchor-id="energy-consumption-all-sectors-in-2018">Energy consumption all sectors in 2018</h2>
<p>Energy consumption by different production routes in different sectors (AIDRES)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nuts3, <span class="fu">contains</span>(<span class="st">'id'</span>), <span class="fu">contains</span>(<span class="st">'is_'</span>), <span class="fu">contains</span>(<span class="st">'_pj_y'</span>))<span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">'electricity_pj_y'</span><span class="sc">:</span><span class="st">'total_energy_vectors_pj_y'</span>, <span class="at">names_to =</span> <span class="st">'indicators'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_ref_scenario <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>         is_ref_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_pareto_solution, is_direct_emission_solution, is_mix)) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'aidres_sector_id'</span> <span class="sc">==</span> <span class="st">'id'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>description) <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'aidres_sector_id'</span> <span class="sc">==</span> <span class="st">'aidres_sector_id'</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( <span class="fu">c</span>(<span class="st">'nuts3'</span>, <span class="st">'sector_id'</span>, <span class="st">'product_id'</span>), <span class="fu">everything</span>(), <span class="sc">-</span><span class="st">'aidres_sector_id'</span>, <span class="sc">-</span><span class="st">'name'</span>, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">'mix'</span>), <span class="sc">-</span>abbreviation, <span class="sc">-</span>description,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"is"</span>), <span class="sc">-</span><span class="st">'value'</span>, <span class="sc">-</span><span class="st">'indicators'</span>, <span class="st">'indicators'</span>, <span class="st">'value'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(configuration_id,   solution_id,    scenario_id,    route_id, id)) <span class="sc">|&gt;</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_route_name'</span> <span class="ot">=</span> route_name) <span class="sc">|&gt;</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nuts3, sector_id, product_id, production_route_name, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector_id, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, indicators) <span class="sc">|&gt;</span> </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">country_total =</span> <span class="fu">sum</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'country_code'</span> <span class="sc">==</span> <span class="st">'country_iso_code'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sector_id, <span class="at">values_from =</span> country_total) <span class="ot">-&gt;</span> aidres_energy_all</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  aidres_energy_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 338 × 9
   country_code country indicators   cement chemical fertiliser glass refineries
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           Austria alternative…   3.12     0         0     0          0    
 2 AT           Austria biomass_pj_y   0        0         0     0          0    
 3 AT           Austria biomass_was…   1.87     0         0     0          0    
 4 AT           Austria coal_pj_y      4.85     0         0     0          0    
 5 AT           Austria coke_pj_y      0        0         0     0          0    
 6 AT           Austria crude_oil_p…   0        0         0     0        416.   
 7 AT           Austria electricity…   1.22     1.56      0.795 0.619      0.888
 8 AT           Austria hydrogen_pj…   0        0         0     0.025      0    
 9 AT           Austria methanol_pj…   0        0         0     0          0    
10 AT           Austria naphtha_pj_y   0       77.0       0     0          0    
# ℹ 328 more rows
# ℹ 1 more variable: steel &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Energy consumption by different production routes in different sectors (AIDRES 2.0)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nuts3, <span class="fu">contains</span>(<span class="st">'id'</span>), <span class="fu">contains</span>(<span class="st">'is_'</span>), <span class="fu">contains</span>(<span class="st">'_pj_y'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">'_pj_y'</span>), as.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">'alternative_fuel_mixture_usage_pj_y'</span><span class="sc">:</span><span class="st">'total_energy_vectors_pj_y'</span>, <span class="at">names_to =</span> <span class="st">'indicators'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario_id <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         is_reference_route <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_mix, is_reference_route)) <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'nuts3'</span>,<span class="st">'sector'</span>,<span class="st">'product_id'</span>,<span class="st">'configuration'</span>,<span class="st">'indicators'</span>, <span class="st">'value'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(value), <span class="dv">0</span>, value),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">sector =</span> <span class="fu">tolower</span>(sector)) <span class="sc">|&gt;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_route_name'</span> <span class="ot">=</span> configuration)<span class="sc">|&gt;</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector, indicators) <span class="sc">|&gt;</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">country_total =</span> <span class="fu">sum</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'country_code'</span> <span class="sc">==</span> <span class="st">'country_iso_code'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sector, <span class="at">values_from =</span> country_total)<span class="ot">-&gt;</span> aidres_2_0_energy_all</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>aidres_2_0_energy_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 598 × 9
   country_code country indicators   cement chemical fertiliser glass refineries
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           Austria alternative…   3.12        0          0     0          0
 2 AT           Austria ammonia_usa…   0           0          0     0          0
 3 AT           Austria bio_methano…   0           0          0     0          0
 4 AT           Austria bio_methano…   0           0          0     0          0
 5 AT           Austria bio_naphtha…   0           0          0     0          0
 6 AT           Austria bio_naphtha…   0           0          0     0          0
 7 AT           Austria biomass_imp…   0           0          0     0          0
 8 AT           Austria biomass_loc…   0           0          0     0          0
 9 AT           Austria biomass_usa…   0           0          0     0          0
10 AT           Austria biomass_was…   1.87        0          0     0          0
# ℹ 588 more rows
# ℹ 1 more variable: steel &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="chemical-sector-energy-consumption" class="level2">
<h2 class="anchored" data-anchor-id="chemical-sector-energy-consumption">Chemical sector energy consumption</h2>
<p>Energy consumption for chemical sector (AIDRES)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>aidres_cleaned_chem <span class="ot">&lt;-</span> aidres_energy_all <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>indicators, chemical, fertiliser) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(chemical, fertiliser), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">"</span><span class="sc">\\</span><span class="st">_pj_y"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'chem_aidres'</span> <span class="ot">=</span> chemical,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">'fuel'</span> <span class="ot">=</span> indicators) <span class="sc">|&gt;</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> chem_aidres, <span class="at">names_to =</span> <span class="st">'metadata'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'total'</span> <span class="ot">=</span> total_energy_vectors) <span class="sc">|&gt;</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(coal, coke), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(biomass, biomass_waste), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(plastic_mix, alternative_fuel_mixture), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(crude_oil, naphtha), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(alternative_fuel_mixture, coal, coke, biomass, biomass_waste, plastic_mix, crude_oil, naphtha)) <span class="sc">|&gt;</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(country_code<span class="sc">:</span>metadata), <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metadata, <span class="at">values_from =</span> pj)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>aidres_cleaned_chem</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 4
   country_code country fuel               chem_aidres
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                    &lt;dbl&gt;
 1 AT           Austria electricity               2.36
 2 AT           Austria hydrogen                  0   
 3 AT           Austria methanol                  0   
 4 AT           Austria natural_gas              11.9 
 5 AT           Austria total                    91.3 
 6 AT           Austria solid_fossil_fuels        0   
 7 AT           Austria renew_bio                 0   
 8 AT           Austria non_renew_waste           0   
 9 AT           Austria oil_petro_products       77.0 
10 BE           Belgium electricity              20.7 
# ℹ 224 more rows</code></pre>
</div>
</div>
<p>Energy consumption for chemical sector (AIDRES 2.0)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_cleaned_chem <span class="ot">&lt;-</span> aidres_2_0_energy_all <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>indicators, chemical, fertiliser) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(chemical, fertiliser), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">"</span><span class="sc">\\</span><span class="st">_usage_pj_y"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicators =</span> <span class="fu">str_replace</span>(indicators, <span class="st">"</span><span class="sc">\\</span><span class="st">_pj_y"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'chem_aidres'</span> <span class="ot">=</span> chemical,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'fuel'</span> <span class="ot">=</span> indicators) <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> chem_aidres, <span class="at">names_to =</span> <span class="st">'metadata'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'total'</span> <span class="ot">=</span> total_energy_vectors) <span class="sc">|&gt;</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">solid_fossil_fuels =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(coal, coke, coal_steel), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(biomass, biomass_waste), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">non_renew_waste =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(plastic_mix, alternative_fuel_mixture), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_products =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(crude_oil, naphtha), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ammonia,alternative_fuel_mixture, coal, coal_steel, coke, biomass, biomass_waste, plastic_mix, crude_oil, naphtha)) <span class="sc">|&gt;</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(country_code<span class="sc">:</span>metadata), <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metadata, <span class="at">values_from =</span> pj)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>aidres_2_0_cleaned_chem</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 442 × 4
   country_code country fuel                chem_aidres
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                     &lt;dbl&gt;
 1 AT           Austria bio_methanol_import        0   
 2 AT           Austria bio_methanol_local         0   
 3 AT           Austria bio_naphtha_import         0   
 4 AT           Austria bio_naphtha_local          0   
 5 AT           Austria biomass_import             0   
 6 AT           Austria biomass_local              0   
 7 AT           Austria electricity                2.36
 8 AT           Austria ethane                     0   
 9 AT           Austria hydrogen                   0   
10 AT           Austria methanol                   0   
# ℹ 432 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="eurostat-chemical-energy-consumption" class="level1">
<h1>EUROSTAT Chemical Energy Consumption</h1>
<section id="downloading-eurostat-energy-balance" class="level2">
<h2 class="anchored" data-anchor-id="downloading-eurostat-energy-balance">Downloading Eurostat energy balance</h2>
<p>EUROSTAT API is used to dynamically fetch EUROSTAT data using <code>eurostat</code> package <span class="citation" data-cites="RJ-2017-019">(<a href="#ref-RJ-2017-019" role="doc-biblioref">Lahti et al. 2017</a>)</span>. Please refer this <a href="https://ropengov.github.io/eurostat/index.html">link</a> to more about the usage of the <code>eurostat</code> package.</p>
<p>For chemical sector aggregated energy balance data of EUROSTAT (nrg_bal_c) is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dat_aggregated_chem <span class="ot">&lt;-</span> <span class="fu">get_eurostat</span>(<span class="st">'nrg_bal_c'</span>, <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="dv">2018</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">time_format =</span> <span class="st">"num"</span>, <span class="at">type =</span> <span class="st">'label'</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>We include aggregated total non-energy consumption to the Chemical sector. for EUROSTAT includes non-energy; chemical for AIDRES includes Fertilizer also.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chem_energy_eurostat <span class="ot">&lt;-</span> dat_aggregated_chem <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unit <span class="sc">==</span> <span class="st">'Terajoule'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(siec <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Solid fossil fuels'</span>, <span class="st">'Manufactured gases'</span>, <span class="st">'Oil and petroleum products (excluding biofuel portion)'</span>, <span class="st">'Renewables and biofuels'</span>, <span class="st">'Electricity'</span>, <span class="st">'Natural gas'</span>, <span class="st">'Non-renewable waste'</span>, <span class="st">'Heat'</span>, <span class="st">'Total'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> siec, <span class="at">values_from =</span>  values) <span class="sc">|&gt;</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'oil_petro_products'</span> <span class="ot">=</span> oil_and_petroleum_products_excluding_biofuel_portion,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'renew_bio'</span> <span class="ot">=</span> renewables_and_biofuels,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'non_renew_waste'</span> <span class="ot">=</span> non_renewable_waste) <span class="sc">|&gt;</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">natural_gas  =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(natural_gas, manufactured_gases), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>manufactured_gases) <span class="sc">|&gt;</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nrg_bal <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Final consumption - industry sector - chemical and petrochemical - energy use'</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Final consumption - industry sector - non-energy use'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col =</span> total<span class="sc">:</span>heat, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span>  <span class="st">'values'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> nrg_bal, <span class="at">values_from =</span>  values) <span class="sc">|&gt;</span> </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"FC_IND_CPC_E"</span> <span class="ot">=</span> final_consumption_industry_sector_chemical_and_petrochemical_energy_use,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"FC_IND_NE"</span> <span class="ot">=</span> final_consumption_industry_sector_non_energy_use) <span class="sc">|&gt;</span> </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuel, geo, time) <span class="sc">|&gt;</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(FC_IND_CPC_E, FC_IND_NE), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net =</span> net<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'country_code'</span> <span class="ot">=</span> geo,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">'year'</span> <span class="ot">=</span> time,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>           <span class="st">'chem_eurostat_pj'</span> <span class="ot">=</span>  net) <span class="sc">|&gt;</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code)<span class="sc">|&gt;</span> </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, year, fuel, chem_eurostat_pj) <span class="sc">|&gt;</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span> <span class="fu">join_by</span>(country_code <span class="sc">==</span> country)) <span class="sc">|&gt;</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_iso_code)) <span class="sc">|&gt;</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'country'</span> <span class="ot">=</span> country_code,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">'country_code'</span> <span class="ot">=</span> country_iso_code,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>         <span class="st">'chem_eurostat'</span> <span class="ot">=</span> chem_eurostat_pj) <span class="sc">|&gt;</span> </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>(), <span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `year`</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chem_energy_eurostat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 216 × 5
    year country_code country fuel               chem_eurostat
   &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1  2018 AT           Austria electricity               17.1  
 2  2018 AT           Austria heat                       2.61 
 3  2018 AT           Austria natural_gas               30.0  
 4  2018 AT           Austria non_renew_waste            2.64 
 5  2018 AT           Austria oil_petro_products        64.6  
 6  2018 AT           Austria renew_bio                  2.18 
 7  2018 AT           Austria solid_fossil_fuels         0.953
 8  2018 AT           Austria total                    120.   
 9  2018 BE           Belgium electricity               52.6  
10  2018 BE           Belgium heat                      11.6  
# ℹ 206 more rows</code></pre>
</div>
</div>
<section id="joining-aidresaidres-2.0-and-eurostat-chemical-energy-consumption" class="level3">
<h3 class="anchored" data-anchor-id="joining-aidresaidres-2.0-and-eurostat-chemical-energy-consumption">Joining AIDRES/AIDRES 2.0 and EUROSTAT Chemical energy consumption</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres <span class="ot">&lt;-</span> chem_energy_eurostat <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(aidres_cleaned_chem, <span class="at">by =</span> <span class="fu">join_by</span>(country_code, country, fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> chem_eurostat<span class="sc">:</span>chem_aidres, <span class="at">names_to =</span> <span class="st">'metadata'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">round</span>(pj, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(metadata, <span class="at">delim =</span> <span class="st">'_'</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">'sector'</span>, <span class="st">'source'</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 536 × 7
   country_code country fuel                year sector source      pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
 1 AT           Austria electricity         2018 chem   eurostat 17.1 
 2 AT           Austria electricity         2018 chem   aidres    2.36
 3 AT           Austria heat                2018 chem   eurostat  2.61
 4 AT           Austria heat                2018 chem   aidres   NA   
 5 AT           Austria natural_gas         2018 chem   eurostat 30.0 
 6 AT           Austria natural_gas         2018 chem   aidres   11.9 
 7 AT           Austria non_renew_waste     2018 chem   eurostat  2.64
 8 AT           Austria non_renew_waste     2018 chem   aidres    0   
 9 AT           Austria oil_petro_products  2018 chem   eurostat 64.6 
10 AT           Austria oil_petro_products  2018 chem   aidres   77.0 
# ℹ 526 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres_2_0 <span class="ot">&lt;-</span> chem_energy_eurostat <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(aidres_2_0_cleaned_chem, <span class="at">by =</span> <span class="fu">join_by</span>(country_code, country, fuel)) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, country, fuel, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> chem_eurostat<span class="sc">:</span>chem_aidres, <span class="at">names_to =</span> <span class="st">'metadata'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">round</span>(pj, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(metadata, <span class="at">delim =</span> <span class="st">'_'</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">'sector'</span>, <span class="st">'source'</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 952 × 7
   country_code country fuel                year sector source      pj
   &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
 1 AT           Austria electricity         2018 chem   eurostat 17.1 
 2 AT           Austria electricity         2018 chem   aidres    2.36
 3 AT           Austria heat                2018 chem   eurostat  2.61
 4 AT           Austria heat                2018 chem   aidres   NA   
 5 AT           Austria natural_gas         2018 chem   eurostat 30.0 
 6 AT           Austria natural_gas         2018 chem   aidres   11.9 
 7 AT           Austria non_renew_waste     2018 chem   eurostat  2.64
 8 AT           Austria non_renew_waste     2018 chem   aidres    0   
 9 AT           Austria oil_petro_products  2018 chem   eurostat 64.6 
10 AT           Austria oil_petro_products  2018 chem   aidres   77.0 
# ℹ 942 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-aidresaidres-2.0-chemical-fertiliser-vs-jrc-idees-basic-chemicals" class="level2">
<h2 class="anchored" data-anchor-id="compare-aidresaidres-2.0-chemical-fertiliser-vs-jrc-idees-basic-chemicals">Compare AIDRES/AIDRES 2.0 Chemical + Fertiliser vs JRC-IDEES basic chemicals</h2>
<section id="creating-output-directory" class="level3">
<h3 class="anchored" data-anchor-id="creating-output-directory">Creating output directory</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'outputs'</span>, <span class="st">'chemical'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)){</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Output directory doesn't exist. Creating a new one!"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_dir)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Output directory already exists. Not creating a new one!"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Output directory doesn't exist. Creating a new one!"</code></pre>
</div>
</div>
</section>
<section id="prepare-data" class="level3">
<h3 class="anchored" data-anchor-id="prepare-data">Prepare data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chem_fec_bc1 <span class="ot">&lt;-</span> chem_fec_bc <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code, product) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(gj_idees), <span class="at">groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> total, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'gj_idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc) <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">'idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> gj_idees<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pj =</span> <span class="fu">sum</span>(pj), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, fuel, <span class="fu">everything</span>())</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">'chem'</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                   source <span class="sc">!=</span> <span class="st">'eurostat'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country, <span class="sc">-</span>sector) <span class="sc">|&gt;</span> </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc1) <span class="sc">|&gt;</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel) <span class="ot">-&gt;</span> compare_aidres_idess_basic_chem</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>compare_aidres_idess_basic_chem</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 484 × 4
   country_code fuel               source      pj
   &lt;chr&gt;        &lt;chr&gt;              &lt;chr&gt;    &lt;dbl&gt;
 1 AT           electricity        aidres  2.36  
 2 AT           electricity        idees   9.98  
 3 AT           heat               aidres NA     
 4 AT           heat               idees   0.0284
 5 AT           hydrogen           aidres  0     
 6 AT           methanol           aidres  0     
 7 AT           natural_gas        aidres 11.9   
 8 AT           natural_gas        idees  24.8   
 9 AT           non_renew_waste    aidres  0     
10 AT           oil_petro_products aidres 77.0   
# ℹ 474 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres_2_0 <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">'chem'</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                   source <span class="sc">!=</span> <span class="st">'eurostat'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country, <span class="sc">-</span>sector) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc1) <span class="sc">|&gt;</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel) <span class="ot">-&gt;</span> compare_aidres_2_0_idess_basic_chem</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>compare_aidres_2_0_idess_basic_chem</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 692 × 4
   country_code fuel                source    pj
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;  &lt;dbl&gt;
 1 AT           bio_methanol_import aidres  0   
 2 AT           bio_methanol_local  aidres  0   
 3 AT           bio_naphtha_import  aidres  0   
 4 AT           bio_naphtha_local   aidres  0   
 5 AT           biomass_import      aidres  0   
 6 AT           biomass_local       aidres  0   
 7 AT           electricity         aidres  2.36
 8 AT           electricity         idees   9.98
 9 AT           ethane              aidres  0   
10 AT           heat                aidres NA   
# ℹ 682 more rows</code></pre>
</div>
</div>
</section>
<section id="plots" class="level3">
<h3 class="anchored" data-anchor-id="plots">Plots</h3>
<section id="comparison-graph-total" class="level4">
<h4 class="anchored" data-anchor-id="comparison-graph-total">Comparison graph total</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>compare_aidres_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AIDRES and JRC-IDEES'</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Only Basic Chemical componenet of JRC IDEES is compared with Aidres. Chlorine is missing in AIDRES'</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_total_aidres_idees.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>compare_aidres_2_0_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AIDRES 2.0 and JRC-IDEES'</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Only Basic Chemical componenet of JRC IDEES is compared with Aidres. Chlorine is missing in AIDRES'</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_total_aidres_2_0_idees.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="comparison-graph-fuels" class="level4">
<h4 class="anchored" data-anchor-id="comparison-graph-fuels">Comparison graph fuels</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>compare_aidres_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Fuel-wise energy consumption in the chemical sector in AIDRES and JRC-IDEES'</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Only Basic Chemical componenet of JRC IDEES is compared with Aidres. Chlorine is missing in AIDRES'</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'country'</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_fuel_aidres_idees.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>compare_aidres_2_0_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Fuel-wise energy consumption in the chemical sector in AIDRES 2.0 and JRC-IDEES'</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Only Basic Chemical componenet of JRC IDEES is compared with Aidres 2.0. Chlorine is missing in AIDRES'</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'country'</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_fuel_aidres_2_0_idees.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="diff-file" class="level3">
<h3 class="anchored" data-anchor-id="diff-file">Diff file</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>compare_aidres_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_basic_aidres_idees.xlsx'</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>compare_aidres_2_0_idess_basic_chem <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_basic_aidres_2_0_idees.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="filling-the-gap-for-basic-chemical" class="level2">
<h2 class="anchored" data-anchor-id="filling-the-gap-for-basic-chemical">Filling the gap for Basic Chemical</h2>
<p>AIDRES does not contain the information of Chlorine. Eurochlor database is used to procure country wise Chlorine production. Specific energy consumption values of various process routes for Chlorine production is taken from JRC-EU-TIMES model.</p>
<section id="creating-input-directory-for-chlorine-data" class="level3">
<h3 class="anchored" data-anchor-id="creating-input-directory-for-chlorine-data">Creating input directory for Chlorine data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>eurochlor_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'eurochlor_data'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(eurochlor_data)){</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Eurochlor input data folder doesn't exist. Request VITO to provide the data"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(eurochlor_data)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Eurochlor input data directory already exists. Not creating a new one!"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Eurochlor data tables also exist!"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Eurochlor input data directory already exists. Not creating a new one!"
[1] "Eurochlor data tables also exist!"</code></pre>
</div>
</div>
</section>
<section id="getting-chlorine-data" class="level3">
<h3 class="anchored" data-anchor-id="getting-chlorine-data">Getting Chlorine data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(eurochlor_data, <span class="st">'chlorine_data_2018.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'Sheet2'</span>, <span class="at">range =</span> <span class="st">'A1:H67'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'country'</span> <span class="sc">==</span> <span class="st">'country'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_iso_code, country, company, site, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_iso_code)) <span class="sc">|&gt;</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thousand_tonnes) <span class="sc">|&gt;</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> murcury<span class="sc">:</span>other, <span class="at">names_to =</span> <span class="st">'production_routes'</span>, <span class="at">values_to =</span> <span class="st">'kt'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kt =</span> <span class="fu">replace_na</span>(kt, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_iso_code , country, production_routes) <span class="sc">|&gt;</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">kt =</span> <span class="fu">sum</span>(<span class="fu">cbind</span>(kt)))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 4
   country_iso_code country production_routes    kt
   &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
 1 AT               Austria diapharm              0
 2 AT               Austria membrane             75
 3 AT               Austria murcury               0
 4 AT               Austria other                 0
 5 BE               Belgium diapharm              0
 6 BE               Belgium membrane           1074
 7 BE               Belgium murcury               0
 8 BE               Belgium other                 0
 9 CZ               Czechia diapharm              0
10 CZ               Czechia membrane             82
# ℹ 62 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>chlorine_sec <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(eurochlor_data, <span class="st">'chlorine_data_2018.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'Sheet2'</span>, <span class="at">range =</span> <span class="st">'L1:M5'</span>) </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>chlorine_production_energy <span class="ot">&lt;-</span> <span class="fu">left_join</span>(chlorine_data_2018, chlorine_sec, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="fu">join_by</span>(production_routes <span class="sc">==</span> process_routes)) <span class="sc">|&gt;</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> kt<span class="sc">*</span>pj_mt<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pj_mt, <span class="sc">-</span>country,<span class="sc">-</span>pj_mt, <span class="sc">-</span>kt) <span class="sc">|&gt;</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_iso_code ) <span class="sc">|&gt;</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">electricity =</span> <span class="fu">sum</span>(pj)) <span class="sc">|&gt;</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> electricity) <span class="sc">|&gt;</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> electricity<span class="sc">:</span>total, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'pj_cl'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'country_code'</span> <span class="ot">=</span> country_iso_code )</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>chlorine_production_energy</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   country_code fuel         pj_cl
   &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;
 1 AT           electricity  0.562
 2 AT           total        0.562
 3 BE           electricity  8.06 
 4 BE           total        8.06 
 5 CZ           electricity  0.615
 6 CZ           total        0.615
 7 DE           electricity 43.9  
 8 DE           total       43.9  
 9 EL           electricity  0.075
10 EL           total        0.075
# ℹ 26 more rows</code></pre>
</div>
</div>
<section id="prepare-aidresaidres-2.0-and-jrc-idees-data" class="level4">
<h4 class="anchored" data-anchor-id="prepare-aidresaidres-2.0-and-jrc-idees-data">Prepare AIDRES/AIDRES 2.0, and JRC-IDEES data</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>chem_fec_bc_ <span class="ot">&lt;-</span> chem_fec_bc <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code, product) <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> total, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'gj_idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">'idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> gj_idees<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pj =</span> <span class="fu">sum</span>(pj), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, fuel, <span class="fu">everything</span>())</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">'chem'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country, <span class="sc">-</span>sector, <span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc_) <span class="sc">|&gt;</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel) <span class="ot">-&gt;</span> chem_basic_energy</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>chem_basic_energy</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 752 × 4
   country_code fuel        source        pj
   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
 1 AT           electricity eurostat 17.1   
 2 AT           electricity aidres    2.36  
 3 AT           electricity idees     9.98  
 4 AT           heat        eurostat  2.61  
 5 AT           heat        aidres   NA     
 6 AT           heat        idees     0.0284
 7 AT           hydrogen    eurostat NA     
 8 AT           hydrogen    aidres    0     
 9 AT           methanol    eurostat NA     
10 AT           methanol    aidres    0     
# ℹ 742 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>chem_eurostat_aidres_2_0 <span class="sc">|&gt;</span> <span class="fu">filter</span>(sector <span class="sc">==</span> <span class="st">'chem'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country, <span class="sc">-</span>sector, <span class="sc">-</span>year) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_bc_) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel) <span class="ot">-&gt;</span> chem_basic_energy_2_0</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,168 × 4
   country_code fuel                source      pj
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;    &lt;dbl&gt;
 1 AT           bio_methanol_import eurostat    NA
 2 AT           bio_methanol_import aidres       0
 3 AT           bio_methanol_local  eurostat    NA
 4 AT           bio_methanol_local  aidres       0
 5 AT           bio_naphtha_import  eurostat    NA
 6 AT           bio_naphtha_import  aidres       0
 7 AT           bio_naphtha_local   eurostat    NA
 8 AT           bio_naphtha_local   aidres       0
 9 AT           biomass_import      eurostat    NA
10 AT           biomass_import      aidres       0
# ℹ 1,158 more rows</code></pre>
</div>
</div>
</section>
<section id="joining-chlorine-data-with-aidresaidres-2.0" class="level4">
<h4 class="anchored" data-anchor-id="joining-chlorine-data-with-aidresaidres-2.0">Joining Chlorine data with AIDRES/AIDRES 2.0</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2 <span class="ot">&lt;-</span> chem_basic_energy <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(chlorine_production_energy, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'country_code'</span>, <span class="st">'fuel'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres, pj_cl), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>idees, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">replace_na</span>(pj, <span class="dv">0</span>))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 885 × 4
   country_code fuel        source        pj
   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
 1 AT           electricity eurostat 17.1   
 2 AT           electricity aidres    2.92  
 3 AT           electricity idees     9.98  
 4 AT           heat        eurostat  2.61  
 5 AT           heat        aidres    0     
 6 AT           heat        idees     0.0284
 7 AT           hydrogen    eurostat  0     
 8 AT           hydrogen    aidres    0     
 9 AT           hydrogen    idees     0     
10 AT           methanol    eurostat  0     
# ℹ 875 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2 <span class="ot">&lt;-</span> chem_basic_energy_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(chlorine_production_energy, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'country_code'</span>, <span class="st">'fuel'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres, pj_cl), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>idees, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">replace_na</span>(pj, <span class="dv">0</span>))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,509 × 4
   country_code fuel                source      pj
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;    &lt;dbl&gt;
 1 AT           bio_methanol_import eurostat     0
 2 AT           bio_methanol_import aidres       0
 3 AT           bio_methanol_import idees        0
 4 AT           bio_methanol_local  eurostat     0
 5 AT           bio_methanol_local  aidres       0
 6 AT           bio_methanol_local  idees        0
 7 AT           bio_naphtha_import  eurostat     0
 8 AT           bio_naphtha_import  aidres       0
 9 AT           bio_naphtha_import  idees        0
10 AT           bio_naphtha_local   eurostat     0
# ℹ 1,499 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-aidresaidres-2.0-chemical-fertilizer-eurochlor-chlorine-with-idees-basic-chemicals" class="level3">
<h3 class="anchored" data-anchor-id="compare-aidresaidres-2.0-chemical-fertilizer-eurochlor-chlorine-with-idees-basic-chemicals">Compare AIDRES/AIDRES 2.0 Chemical + Fertilizer + Eurochlor (Chlorine) with IDEES Basic Chemicals</h3>
<section id="comparison-graph-total-1" class="level4">
<h4 class="anchored" data-anchor-id="comparison-graph-total-1">Comparison graph total</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2 <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the Basic Chemical Sector in AIDRES, and JRC-IDEES'</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Chlorine added to AIDRES from Eurochlor 2018 database'</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'country'</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir,<span class="st">'chem_fec_basic_compare_total_with_cl.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2 <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the </span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="st">       Basic Chemical Sector in AIDRES 2.0, and JRC-IDEES'</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Chlorine added to AIDRES 2.0 from Eurochlor 2018 database'</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'country'</span>,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare_2_0</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>p_chem_compare_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir,<span class="st">'chem_fec_basic_compare_total_with_cl_2_0.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="comparison-graph-fuels-1" class="level4">
<h4 class="anchored" data-anchor-id="comparison-graph-fuels-1">Comparison graph fuels</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2 <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span> <span class="st">'eurostat'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the Basic Chemical Sector in AIDRES, and JRC-IDEES'</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Chlorine added to AIDRES from Eurochlor 2018 database'</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare_fuel</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>p_chem_compare_fuel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_fuel_with_cl.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2 <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span> <span class="st">'eurostat'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the Basic Chemical Sector in AIDRES 2.0, and JRC-IDEES'</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Chlorine added to AIDRES 2.0 from Eurochlor 2018 database'</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare_fuel_2_0</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>p_chem_compare_fuel_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_basic_compare_fuel_with_cl_2_0.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="diff-file-1" class="level4">
<h4 class="anchored" data-anchor-id="diff-file-1">Diff file</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_basic_with_cl.xlsx'</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_basic_with_cl_2_0.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="other-chemicals-and-pharmaceuticals" class="level1">
<h1>Other Chemicals and Pharmaceuticals</h1>
<p>AIDRES database does not have information of Other Chemicals and Pharmaceuticals. Together we call them ‘Other Chemicals’. JRC-IDEES reports both production volume (in ethylene equivalent) and the energy consumption for Other Chemicals. For simplicity we only track energy demand for Other Chemicals.</p>
<section id="jrc-idees-other-chemicals" class="level2">
<h2 class="anchored" data-anchor-id="jrc-idees-other-chemicals">JRC-IDEES Other Chemicals</h2>
<section id="generic-electricity-process" class="level3">
<h3 class="anchored" data-anchor-id="generic-electricity-process">Generic electricity process</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_oc_gep <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="at">range =</span> <span class="st">'A2:W160'</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">61</span><span class="sc">:</span><span class="dv">64</span>, <span class="dv">106</span>, <span class="dv">110</span><span class="sc">:</span><span class="dv">113</span>, <span class="dv">155</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'Lighting'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Air compressors'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Motor drives'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Motor drives'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fans and pumps'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Generic electric process'</span> <span class="sc">~</span> <span class="st">'electricity'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">process =</span> <span class="st">'chem_other_gen_elec'</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, process, fuel) <span class="sc">|&gt;</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_oc_gep <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_oc_gep)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_gep <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_oc_gep, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_gep</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 4
   country_code process             fuel         gj_idees
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;           &lt;dbl&gt;
 1 AT           chem_other_gen_elec electricity  6599018.
 2 BE           chem_other_gen_elec electricity 10529552.
 3 BG           chem_other_gen_elec electricity  2218191.
 4 HR           chem_other_gen_elec electricity   835223.
 5 CY           chem_other_gen_elec electricity   133286.
 6 CZ           chem_other_gen_elec electricity  3259530.
 7 DK           chem_other_gen_elec electricity  4521698.
 8 EE           chem_other_gen_elec electricity    65033.
 9 FI           chem_other_gen_elec electricity  6818156.
10 FR           chem_other_gen_elec electricity 23251675.
# ℹ 17 more rows</code></pre>
</div>
</div>
</section>
<section id="low-enthalpy-heat" class="level3">
<h3 class="anchored" data-anchor-id="low-enthalpy-heat">Low enthalpy heat</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_oc_lt <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>      file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="at">range =</span> <span class="st">'A2:W100'</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">66</span><span class="sc">:</span><span class="dv">70</span>, <span class="dv">115</span><span class="sc">:</span><span class="dv">119</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'Diesel oil and liquid biofuels'</span>  <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas and biogas'</span> <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solar and geothermal'</span> <span class="sc">~</span> <span class="st">'renew_bio'</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Electricity'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Ambient heat'</span> <span class="sc">~</span> <span class="st">'heat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">process =</span> <span class="st">'chem_other_heat_lt'</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, process, fuel) <span class="sc">|&gt;</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_oc_lt <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_oc_lt)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_lt <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_oc_lt, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_lt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 135 × 4
   country_code process            fuel               gj_idees
   &lt;chr&gt;        &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           chem_other_heat_lt electricity          88170.
 2 AT           chem_other_heat_lt heat                  9035.
 3 AT           chem_other_heat_lt natural_gas         147360.
 4 AT           chem_other_heat_lt oil_petro_products    1025.
 5 AT           chem_other_heat_lt renew_bio                0 
 6 BE           chem_other_heat_lt electricity         262738.
 7 BE           chem_other_heat_lt heat                 26626.
 8 BE           chem_other_heat_lt natural_gas         604687.
 9 BE           chem_other_heat_lt oil_petro_products    8471.
10 BE           chem_other_heat_lt renew_bio                0 
# ℹ 125 more rows</code></pre>
</div>
</div>
</section>
<section id="high-enthalpy-heat" class="level3">
<h3 class="anchored" data-anchor-id="high-enthalpy-heat">High enthalpy heat</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_oc_ht <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="st">'A2:W100'</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">73</span><span class="sc">:</span><span class="dv">83</span>, <span class="dv">122</span><span class="sc">:</span><span class="dv">132</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'LPG'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Diesel oil and liquid biofuels'</span>  <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Naphtha'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas and biogas'</span> <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas'</span>  <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solids'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Refinery gas'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fuel oil'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Other liquids'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Derived gases'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Biomass and waste'</span> <span class="sc">~</span> <span class="st">'renew_bio'</span>,</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Distributed steam'</span> <span class="sc">~</span> <span class="st">'steam'</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'High-enthalpy heat processing - Electric (microwave)'</span> <span class="sc">~</span> <span class="st">'electricity'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">process =</span> <span class="st">'chem_other_heat_ht'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, process, fuel) <span class="sc">|&gt;</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_oc_ht <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_oc_ht)</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_ht <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_oc_ht, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_ht</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 162 × 4
   country_code process            fuel               gj_idees
   &lt;chr&gt;        &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           chem_other_heat_ht electricity           3232.
 2 AT           chem_other_heat_ht natural_gas        1902666.
 3 AT           chem_other_heat_ht oil_petro_products   63379.
 4 AT           chem_other_heat_ht renew_bio           906155.
 5 AT           chem_other_heat_ht solid_fossil_fuels  105928.
 6 AT           chem_other_heat_ht steam               520882.
 7 BE           chem_other_heat_ht electricity          10715.
 8 BE           chem_other_heat_ht natural_gas        4486477.
 9 BE           chem_other_heat_ht oil_petro_products 8711240.
10 BE           chem_other_heat_ht renew_bio            45345.
# ℹ 152 more rows</code></pre>
</div>
</div>
</section>
<section id="furnace" class="level3">
<h3 class="anchored" data-anchor-id="furnace">Furnace</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_oc_fur <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="at">range =</span> <span class="st">'A2:W100'</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">86</span><span class="sc">:</span><span class="dv">91</span>, <span class="dv">135</span><span class="sc">:</span><span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'LPG'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Diesel oil and liquid biofuels'</span>  <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas and biogas'</span> <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas'</span>  <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solids'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fuel oil'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Furnaces - Electric'</span> <span class="sc">~</span> <span class="st">'electricity'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">process =</span> <span class="st">'chem_other_heat_fur'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, process, fuel) <span class="sc">|&gt;</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_oc_fur <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_oc_fur)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_fur <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_oc_fur, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_fur</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 108 × 4
   country_code process             fuel               gj_idees
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           chem_other_heat_fur electricity          86864.
 2 AT           chem_other_heat_fur natural_gas        1451776.
 3 AT           chem_other_heat_fur oil_petro_products   35353.
 4 AT           chem_other_heat_fur solid_fossil_fuels   80825.
 5 BE           chem_other_heat_fur electricity         218964.
 6 BE           chem_other_heat_fur natural_gas        5039404.
 7 BE           chem_other_heat_fur oil_petro_products 1155371.
 8 BE           chem_other_heat_fur solid_fossil_fuels   34138.
 9 BG           chem_other_heat_fur electricity           5840.
10 BG           chem_other_heat_fur natural_gas        1921715.
# ℹ 98 more rows</code></pre>
</div>
</div>
</section>
<section id="process-cooling" class="level3">
<h3 class="anchored" data-anchor-id="process-cooling">Process cooling</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>read_data_chem_fec_oc_cool <span class="ot">&lt;-</span> <span class="cf">function</span>(country){</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(idees_data, <span class="st">'/JRC-IDEES-2021_Industry_'</span>, country, <span class="st">'.xlsx'</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">'CHI_fec'</span>, <span class="st">'A2:W100'</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'product'</span>, <span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_code =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">product =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">93</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">105</span>, <span class="dv">142</span>, <span class="dv">144</span><span class="sc">:</span><span class="dv">154</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fuel =</span> <span class="fu">case_when</span>(product <span class="sc">==</span> <span class="st">'LPG'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Diesel oil and liquid biofuels'</span>  <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Naphtha'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas and biogas'</span> <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Natural gas'</span>  <span class="sc">~</span> <span class="st">'natural_gas'</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Solids'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Refinery gas'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Fuel oil'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Other liquids'</span> <span class="sc">~</span> <span class="st">'oil_petro_products'</span>,</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Derived gases'</span> <span class="sc">~</span> <span class="st">'solid_fossil_fuels'</span>,</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Biomass and waste'</span> <span class="sc">~</span> <span class="st">'renew_bio'</span>,</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Distributed steam'</span> <span class="sc">~</span> <span class="st">'steam'</span>,</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Process cooling - Electric'</span> <span class="sc">~</span> <span class="st">'electricity'</span>,</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                            product <span class="sc">==</span> <span class="st">'Chemicals: Process cooling - Natural gas and biogas'</span> <span class="sc">~</span><span class="st">'natural_gas'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">process =</span> <span class="st">'chem_other_process_cool'</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span><span class="st">'2018'</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'ktoe'</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gj_idees =</span> ktoe<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="fl">41.87</span>,</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">ktoe =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(country_code, process, fuel) <span class="sc">|&gt;</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">gj_idees=</span><span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>test_list_chem_fec_oc_cool <span class="ot">&lt;-</span> <span class="fu">lapply</span>(country_codes<span class="sc">$</span>country_iso_code, read_data_chem_fec_oc_cool)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_cool <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(test_list_chem_fec_oc_cool, <span class="at">.id =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_cool</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 4
   country_code process                 fuel               gj_idees
   &lt;chr&gt;        &lt;chr&gt;                   &lt;chr&gt;                 &lt;dbl&gt;
 1 AT           chem_other_process_cool natural_gas         161788.
 2 AT           chem_other_process_cool oil_petro_products    1016.
 3 AT           chem_other_process_cool solid_fossil_fuels    2323.
 4 BE           chem_other_process_cool natural_gas         664290.
 5 BE           chem_other_process_cool oil_petro_products   22561.
 6 BE           chem_other_process_cool solid_fossil_fuels     667.
 7 BG           chem_other_process_cool natural_gas         467030.
 8 BG           chem_other_process_cool oil_petro_products   12037.
 9 BG           chem_other_process_cool solid_fossil_fuels   30673.
10 HR           chem_other_process_cool natural_gas         109273.
# ℹ 71 more rows</code></pre>
</div>
</div>
</section>
<section id="total-other-chemicals" class="level3">
<h3 class="anchored" data-anchor-id="total-other-chemicals">Total other chemicals</h3>
<p>For final energy consumption calculation we assume certain efficiency of the following process.</p>
<ul>
<li>Furnace efficiency from <a href="https://thermalprocessing.com/efficient-gas-heating-of-industrial-furnaces/">source</a> —90%</li>
<li>Cooling efficiency is assumed to be 80% ——– own assumption</li>
<li>High enthalpy heat efficiency is from TIMES-BE——95% efficiency</li>
<li>Low enthalpy heat efficiency is from TIMES_BE ——- 95% efficiency</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>chem_fec_oc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(chem_fec_oc_gep, chem_fec_oc_lt, chem_fec_oc_ht, chem_fec_oc_fur, chem_fec_oc_cool)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>chem_fec_oc3 <span class="ot">&lt;-</span> chem_fec_oc <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code, process) <span class="sc">|&gt;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(gj_idees), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> total, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'gj_idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_fec_oc)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add efficiency and multiply by process type</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>process <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chem_other_gen_elec'</span>, <span class="st">'chem_other_heat_lt'</span>, <span class="st">'chem_other_heat_ht'</span>, <span class="st">'chem_other_heat_fur'</span>, <span class="st">'chem_other_process_cool'</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>efficiency <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">95</span>, .<span class="dv">95</span>, .<span class="dv">90</span>, .<span class="dv">80</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>chem_oth_process_eff <span class="ot">&lt;-</span> <span class="fu">tibble</span>(process, efficiency)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(chem_fec_oc3, chem_oth_process_eff, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'process'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj_idees =</span> gj_idees<span class="sc">*</span>efficiency<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>efficiency) <span class="ot">-&gt;</span> chem_fec_oc_</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_ <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code , fuel) <span class="sc">|&gt;</span> </span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">pj_idees =</span> <span class="fu">sum</span>(pj_idees)) <span class="sc">|&gt;</span> </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">'idees_oth'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'pj'</span> <span class="ot">=</span> <span class="st">'pj_idees'</span>) <span class="ot">-&gt;</span> chem_others_idees</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>chem_others_idees</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 216 × 4
   country_code fuel                     pj source   
   &lt;chr&gt;        &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;    
 1 AT           electricity         6.76    idees_oth
 2 AT           heat                0.00858 idees_oth
 3 AT           natural_gas         3.38    idees_oth
 4 AT           oil_petro_products  0.0938  idees_oth
 5 AT           renew_bio           0.861   idees_oth
 6 AT           solid_fossil_fuels  0.175   idees_oth
 7 AT           steam               0.495   idees_oth
 8 AT           total              11.8     idees_oth
 9 BE           electricity        11.0     idees_oth
10 BE           heat                0.0253  idees_oth
# ℹ 206 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="allocating-steam-and-heat-to-a-fuel-category-1" class="level2">
<h2 class="anchored" data-anchor-id="allocating-steam-and-heat-to-a-fuel-category-1">Allocating steam and heat to a fuel category</h2>
<p>Lets assume the heat and steam is produced by gas. Assume the heat production from gas is 95% efficient.</p>
<p>Deactivated</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gas_heat_eff <span class="ot">=</span> .<span class="dv">95</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>chem_others_idees <span class="ot">&lt;-</span> chem_others_idees <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">natural_gas =</span> natural_gas <span class="sc">+</span> (heat<span class="sc">+</span>steam)<span class="sc">/</span>gas_heat_eff, <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> electricity<span class="sc">:</span>total, <span class="at">names_to =</span> <span class="st">'fuel'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="all-chemical-data" class="level3">
<h3 class="anchored" data-anchor-id="all-chemical-data">All chemical data</h3>
<p>Final data frame containing Chemical sector energy consumption in AIDRES, EUROSTAT, and JRC-IDEES</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2 <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_others_idees) <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">pj =</span> <span class="fu">sum</span>(pj)) <span class="ot">-&gt;</span> chem_fec_source</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>chem_fec_source</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,101 × 4
   country_code fuel        source          pj
   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
 1 AT           electricity aidres     2.92   
 2 AT           electricity eurostat  17.1    
 3 AT           electricity idees      9.98   
 4 AT           electricity idees_oth  6.76   
 5 AT           heat        aidres     0      
 6 AT           heat        eurostat   2.61   
 7 AT           heat        idees      0.0284 
 8 AT           heat        idees_oth  0.00858
 9 AT           hydrogen    aidres     0      
10 AT           hydrogen    eurostat   0      
# ℹ 1,091 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2 <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_others_idees) <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">pj =</span> <span class="fu">sum</span>(pj)) <span class="ot">-&gt;</span> chem_fec_source_2_0</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>chem_fec_source_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,725 × 4
   country_code fuel                source      pj
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;    &lt;dbl&gt;
 1 AT           bio_methanol_import aidres       0
 2 AT           bio_methanol_import eurostat     0
 3 AT           bio_methanol_import idees        0
 4 AT           bio_methanol_local  aidres       0
 5 AT           bio_methanol_local  eurostat     0
 6 AT           bio_methanol_local  idees        0
 7 AT           bio_naphtha_import  aidres       0
 8 AT           bio_naphtha_import  eurostat     0
 9 AT           bio_naphtha_import  idees        0
10 AT           bio_naphtha_local   aidres       0
# ℹ 1,715 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-aidresaidres-2.0-eurochlor-chlorine-chem-others-jrc-idees-total-idees-eurostat-chemical-non-energy" class="level2">
<h2 class="anchored" data-anchor-id="compare-aidresaidres-2.0-eurochlor-chlorine-chem-others-jrc-idees-total-idees-eurostat-chemical-non-energy">Compare AIDRES/AIDRES 2.0 + Eurochlor (Chlorine) + Chem Others JRC-IDEES, total IDEES, EUROSTAT Chemical + non energy</h2>
<p>Prepare data</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy2 <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'idees_basic'</span> <span class="ot">=</span> idees,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'aidres_cl'</span> <span class="ot">=</span> aidres) <span class="sc">|&gt;</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>idees_basic, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_others_idees) <span class="sc">|&gt;</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres_cl,idees_oth), <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">idees =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(idees_oth,idees_basic), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(eurostat<span class="sc">:</span>idees, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="ot">-&gt;</span> chem_fec_source2</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>chem_fec_source2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 885 × 4
   country_code fuel        source         pj
   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
 1 AT           electricity eurostat 17.1    
 2 AT           electricity aidres    9.69   
 3 AT           electricity idees    16.7    
 4 AT           heat        eurostat  2.61   
 5 AT           heat        aidres    0.00858
 6 AT           heat        idees     0.0370 
 7 AT           hydrogen    eurostat  0      
 8 AT           hydrogen    aidres    0      
 9 AT           hydrogen    idees     0      
10 AT           methanol    eurostat  0      
# ℹ 875 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>chem_basic_energy_2_0_2 <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'idees_basic'</span> <span class="ot">=</span> idees,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'aidres_cl'</span> <span class="ot">=</span> aidres) <span class="sc">|&gt;</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> eurostat<span class="sc">:</span>idees_basic, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chem_others_idees) <span class="sc">|&gt;</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country_code, fuel, source) <span class="sc">|&gt;</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> source, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aidres =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(aidres_cl,idees_oth), <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">idees =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(idees_oth,idees_basic), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(eurostat<span class="sc">:</span>idees, <span class="at">names_to =</span> <span class="st">'source'</span>, <span class="at">values_to =</span> <span class="st">'pj'</span>) <span class="ot">-&gt;</span> chem_fec_source_2_0_2</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>chem_fec_source_2_0_2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,509 × 4
   country_code fuel                source      pj
   &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;    &lt;dbl&gt;
 1 AT           bio_methanol_import eurostat     0
 2 AT           bio_methanol_import aidres       0
 3 AT           bio_methanol_import idees        0
 4 AT           bio_methanol_local  eurostat     0
 5 AT           bio_methanol_local  aidres       0
 6 AT           bio_methanol_local  idees        0
 7 AT           bio_naphtha_import  eurostat     0
 8 AT           bio_naphtha_import  aidres       0
 9 AT           bio_naphtha_import  idees        0
10 AT           bio_naphtha_local   eurostat     0
# ℹ 1,499 more rows</code></pre>
</div>
</div>
<section id="comparison-graph-total-2" class="level3">
<h3 class="anchored" data-anchor-id="comparison-graph-total-2">Comparison graph total</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>chem_fec_source2 <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AIDRES and JRC-IDEES and Eurostat'</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Total JRC-IDEES vs AIDRES Chemical + Fertiliser vs Eurostat Chemical + Non energy'</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_total_compare_total_aidres_idees_eurostat.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>chem_fec_source_2_0_2 <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fuel <span class="sc">==</span> <span class="st">'total'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AIDRES 2.0 and JRC-IDEES and Eurostat'</span>,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Total JRC-IDEES vs AIDRES 2.0 Chemical + Fertiliser vs Eurostat Chemical + Non energy'</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare_2_0</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>p_chem_compare_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_total_compare_total_aidres_2_0_idees_eurostat.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="comparison-graph-fuels-2" class="level3">
<h3 class="anchored" data-anchor-id="comparison-graph-fuels-2">Comparison graph fuels</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>chem_fec_source2 <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AidRes and JRC-IDEES and Eurostat'</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Total JRC IDEES vs Aidres Chemical + Fertiliser vs Eurostat Chemical + Non energy'</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>p_chem_compare</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_total_compare_fuel_aidres_idees_eurostat.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>chem_fec_source_2_0_2 <span class="sc">|&gt;</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pj, <span class="fu">fct_reorder</span>(country_code, pj, <span class="at">.fun =</span> sum))) <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> source), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fuel, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Total energy consumption in the chemical sector in AidRes 2.0 and JRC-IDEES and Eurostat'</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Total JRC IDEES vs Aidres 2.0 Chemical + Fertiliser vs Eurostat Chemical + Non energy'</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Country'</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'PJ'</span>) <span class="sc">+</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> p_chem_compare_2_0</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>p_chem_compare_2_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chemical_analysis_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(output_dir, <span class="st">'chem_fec_total_compare_fuel_aidres_2_0_idees_eurostat.pdf'</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">dpi =</span> <span class="dv">900</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="diff-file-2" class="level3">
<h3 class="anchored" data-anchor-id="diff-file-2">Diff file</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>chem_fec_source <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_total_aidres_idees_eurostat.xlsx'</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>chem_fec_source_2_0 <span class="sc">|&gt;</span> </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> pj, <span class="at">names_from =</span> source) <span class="sc">|&gt;</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="fu">here</span>(output_dir, <span class="st">'diff_chem_total_aidres_2_0_idees_eurostat.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="aidres-data-for-eu-case-study-not-used" class="level2">
<h2 class="anchored" data-anchor-id="aidres-data-for-eu-case-study-not-used">AIDRES+ data for EU case study (not used!)</h2>
<section id="aidres-data-for-chlorine-and-other-chemicals" class="level3">
<h3 class="anchored" data-anchor-id="aidres-data-for-chlorine-and-other-chemicals">AIDRES+ data for Chlorine, and Other Chemicals</h3>
<p>Specific energy consumption for Chlorine is taken from JRC-EU-TIMES model. For other chemicals specific energy consumption values is calculated using JRC-IDEES data aggregating over the individual processes. Final energy demand for Other Chemicals, specific energy consumption of Other Chemicals, Chlorine production volume, and specific energy consumption for Chlorine is written to <code>outputs/chemicals/chem_aidres_extra.xlsx' file.</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(chem_fec_oc3, chem_oth_process_eff, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'process'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj_idees =</span> gj_idees<span class="sc">*</span>efficiency<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>efficiency) <span class="ot">-&gt;</span> chem_fec_oc_</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>chem_fec_oc_ <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code , fuel) <span class="sc">|&gt;</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">pj_idees =</span> <span class="fu">sum</span>(pj_idees)) <span class="sc">|&gt;</span> </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">'idees'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'pj'</span> <span class="ot">=</span> <span class="st">'pj_idees'</span>) <span class="ot">-&gt;</span> chem_others_idees</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>chem_others_idees <span class="sc">|&gt;</span> </span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> pj) <span class="sc">|&gt;</span> </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">electricity =</span> electricity<span class="sc">/</span> total,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">oil_petro_product =</span> oil_petro_products <span class="sc">/</span> total,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">renew_bio =</span> renew_bio <span class="sc">/</span> total,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">solid_fossil_fuels =</span> solid_fossil_fuels <span class="sc">/</span> total,</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">total =</span> total <span class="sc">/</span> total,</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">'unused'</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'pj_pj'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, source, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> other_chem_sec</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>other_chem_sec</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>chem_others_idees <span class="ot">&lt;-</span> chem_others_idees <span class="sc">|&gt;</span> </span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, fuel, source, pj) <span class="sc">|&gt;</span> </span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pj =</span> <span class="fu">round</span>(pj , <span class="dv">3</span>))</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>chem_others_idees</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>chlorine_sec <span class="sc">|&gt;</span> </span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'pj_mt'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'electricity'</span> <span class="ot">=</span> pj_mt) <span class="sc">|&gt;</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(process_routes, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> chlorine_sec_</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>chlorine_sec_</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">'other_chem_fec'</span> <span class="ot">=</span> chem_others_idees,</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'other_chem_sec'</span> <span class="ot">=</span> other_chem_sec, </span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'chlorine_dem'</span> <span class="ot">=</span> chlorine_data_2018,</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'chlorine_sec'</span> <span class="ot">=</span> chlorine_sec_),</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>              <span class="fu">here</span>(output_dir,<span class="st">'chem_aidres_extra.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>

</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-RJ-2017-019" class="csl-entry" role="listitem">
Lahti, Leo, Janne Huovari, Markus Kainu, and Przemysław Biecek. 2017. <span>“<span class="nocase">Retrieval and Analysis of Eurostat Open Data with the eurostat Package</span>.”</span> <em><span>The R Journal</span></em> 9 (1): 385–92. <a href="https://doi.org/10.32614/RJ-2017-019">https://doi.org/10.32614/RJ-2017-019</a>.
</div>
<div id="ref-jrc-idees_report" class="csl-entry" role="listitem">
Mate, Rozsai, Jaxa-Rozen Marc, Salvucci Raffaele, Sikora Przemyslaw, Tattini Jacopo, and Neuwahl Frederik. 2024. <span>“JRC-IDEES-2021.”</span> European Commission, Joint Research Centre. <a href="http://data.europa.eu/89h/82322924-506a-4c9a-8532-2bdd30d69bf5">http://data.europa.eu/89h/82322924-506a-4c9a-8532-2bdd30d69bf5</a>.
</div>
<div id="ref-aidres_report" class="csl-entry" role="listitem">
Vermeiren, Karolien, Wim Clymans, Lorenz Hambsch, and Leen Van Esch. 2023. <span>“AIDRES - Advancing Industrial Decarbonization by Assessing the Future Use of Renewable Energies in Industrial Processes.”</span> European Commission, Joint Research Centre. <a href="http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d">http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{das2026,
  author = {Das, Partha and Valkering, Pieter and Van de Put, Hans},
  title = {Analyzing {Chemical} {Sector} Energy Consumption},
  date = {2026-01-29},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-das2026" class="csl-entry quarto-appendix-citeas" role="listitem">
Das, Partha, Pieter Valkering, and Hans Van de Put. 2026.
<span>“Analyzing Chemical Sector Energy Consumption.”</span> January 29,
2026.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>