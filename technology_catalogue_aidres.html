<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Partha Das">
<meta name="author" content="Pieter Valkering">
<meta name="author" content="Hans Van de Put">
<meta name="dcterms.date" content="2026-02-27">
<meta name="keywords" content="AIDRES, EUROSTAT, JRC-IDEES">

<title>Preparation of Technology Catalogue for MOPO EU/ Industrial Cluster Case Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="technology_catalogue_aidres_files/libs/clipboard/clipboard.min.js"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/popper.min.js"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="technology_catalogue_aidres_files/libs/quarto-html/anchor.min.js"></script>
<link href="technology_catalogue_aidres_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="technology_catalogue_aidres_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="technology_catalogue_aidres_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="technology_catalogue_aidres_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="technology_catalogue_aidres_files/libs/bootstrap/bootstrap-2b16cb1ea19488d2d80dabb165e63084.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#using-the-application" id="toc-using-the-application" class="nav-link" data-scroll-target="#using-the-application">Using the application</a></li>
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries">Loading libraries</a></li>
  <li><a href="#reading-aidres-data" id="toc-reading-aidres-data" class="nav-link" data-scroll-target="#reading-aidres-data">Reading AIDRES data</a>
  <ul class="collapse">
  <li><a href="#establishing-aidres-database-connection-and-fetching-tables-not-used" id="toc-establishing-aidres-database-connection-and-fetching-tables-not-used" class="nav-link" data-scroll-target="#establishing-aidres-database-connection-and-fetching-tables-not-used">Establishing AIDRES database connection and fetching tables (not used)</a></li>
  <li><a href="#importing-aidres-2.0-data-from-local-.csv-files" id="toc-importing-aidres-2.0-data-from-local-.csv-files" class="nav-link" data-scroll-target="#importing-aidres-2.0-data-from-local-.csv-files">Importing AIDRES 2.0 data from local <code>.csv</code> files</a></li>
  </ul></li>
  <li><a href="#get-additional-data" id="toc-get-additional-data" class="nav-link" data-scroll-target="#get-additional-data">Get additional data</a></li>
  <li><a href="#aidres-data-for-mopo-eu-industrial-cluster-case-study" id="toc-aidres-data-for-mopo-eu-industrial-cluster-case-study" class="nav-link" data-scroll-target="#aidres-data-for-mopo-eu-industrial-cluster-case-study">AIDRES data for MOPO EU/ Industrial cluster case study</a>
  <ul class="collapse">
  <li><a href="#specific-energy-consumption-factors" id="toc-specific-energy-consumption-factors" class="nav-link" data-scroll-target="#specific-energy-consumption-factors">Specific energy consumption factors</a></li>
  <li><a href="#costs-capex-and-fom" id="toc-costs-capex-and-fom" class="nav-link" data-scroll-target="#costs-capex-and-fom">Costs: capex and fom</a></li>
  <li><a href="#co2-emissions-and-capture" id="toc-co2-emissions-and-capture" class="nav-link" data-scroll-target="#co2-emissions-and-capture">CO2 emissions and capture</a></li>
  <li><a href="#additional-production-data" id="toc-additional-production-data" class="nav-link" data-scroll-target="#additional-production-data">Additional production data</a></li>
  <li><a href="#production" id="toc-production" class="nav-link" data-scroll-target="#production">Production</a>
  <ul class="collapse">
  <li><a href="#production-volume-at-nuts0" id="toc-production-volume-at-nuts0" class="nav-link" data-scroll-target="#production-volume-at-nuts0">Production volume at nuts0</a></li>
  <li><a href="#production-volume-at-nuts3" id="toc-production-volume-at-nuts3" class="nav-link" data-scroll-target="#production-volume-at-nuts3">Production volume at nuts3</a></li>
  </ul></li>
  <li><a href="#life" id="toc-life" class="nav-link" data-scroll-target="#life">Life</a></li>
  <li><a href="#get-chlorine-production-data-and-add-to-technology-catalogue" id="toc-get-chlorine-production-data-and-add-to-technology-catalogue" class="nav-link" data-scroll-target="#get-chlorine-production-data-and-add-to-technology-catalogue">Get chlorine production data and add to technology catalogue</a></li>
  <li><a href="#get-chlorine-production-route-and-add-to-technology-catalogue" id="toc-get-chlorine-production-route-and-add-to-technology-catalogue" class="nav-link" data-scroll-target="#get-chlorine-production-route-and-add-to-technology-catalogue">Get chlorine production route and add to technology catalogue</a></li>
  </ul></li>
  <li><a href="#add-production-production-route-and-co2-emission-data-for-non-aidres-sectors" id="toc-add-production-production-route-and-co2-emission-data-for-non-aidres-sectors" class="nav-link" data-scroll-target="#add-production-production-route-and-co2-emission-data-for-non-aidres-sectors">Add production, production route and CO2 emission data for non-AIDRES sectors</a>
  <ul class="collapse">
  <li><a href="#writing-all-data-in-an-excel-workbook" id="toc-writing-all-data-in-an-excel-workbook" class="nav-link" data-scroll-target="#writing-all-data-in-an-excel-workbook">writing all data in an excel workbook</a>
  <ul class="collapse">
  <li><a href="#creating-output-directory" id="toc-creating-output-directory" class="nav-link" data-scroll-target="#creating-output-directory">Creating output directory</a></li>
  <li><a href="#writing-final-excel-workbook" id="toc-writing-final-excel-workbook" class="nav-link" data-scroll-target="#writing-final-excel-workbook">Writing final Excel workbook</a></li>
  <li><a href="#filter-out-all-data-except-hc-meoh-and-nh3-save-excel-file" id="toc-filter-out-all-data-except-hc-meoh-and-nh3-save-excel-file" class="nav-link" data-scroll-target="#filter-out-all-data-except-hc-meoh-and-nh3-save-excel-file">Filter out all data except HC, MeOH and NH3 + save excel file</a></li>
  <li><a href="#filter-out-hc-meoh-and-nh3-and-convert-ton-nh3-to-mwh-save-excel-file" id="toc-filter-out-hc-meoh-and-nh3-and-convert-ton-nh3-to-mwh-save-excel-file" class="nav-link" data-scroll-target="#filter-out-hc-meoh-and-nh3-and-convert-ton-nh3-to-mwh-save-excel-file">Filter out HC, MeOH and NH3 (and convert ton NH3 to mwh) + save excel file</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Preparation of Technology Catalogue for MOPO EU/ Industrial Cluster Case Study</h1>
<p class="subtitle lead">AIDRES, JRC-IDEES, EUROSTAT</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Partha Das </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Pieter Valkering </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Hans Van de Put </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://vito.be/nl">
            VITO
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 27, 2026</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>AIDRES, EUROSTAT, JRC-IDEES</p>
  </div>
</div>

</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This is a stand-alone quarto document with code chunks and documentation for an application preparing raw input data for MOPO EU/ Industrial cluster case study directly from the AIDRES database and other sources.</p>
</section>
<section id="using-the-application" class="level1">
<h1>Using the application</h1>
<p>The files are produced using <a href="https://cran.r-project.org/">R</a> and <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>. Though the scripts can be executed using command line, it is recommended to use <code>RStudio</code> for rendering.</p>
<p>Clone this <a href="https://github.com/MOPO-industry/technology-catalogue-and-gap-analysis">repository</a> to your computer. Readily start browsing documentation and data analyses via the .html files. For further data analysis (advanced users), open the <code>mopo_repo.Rproj</code> (<code>RStudio needs to be installed</code>) file. Open for example <code>refinery_analysis.qmd</code> and click on <code>render button</code> (Crtl + Shift + K).</p>
</section>
<section id="loading-libraries" class="level1">
<h1>Loading libraries</h1>
<p>The application checks whether the required packages for running the scripts are installed or not. If not, it automatically installs them and loads them. If they are already installed, it just loads them.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mypackages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="st">'readxl'</span>, <span class="st">'janitor'</span>, <span class="st">'archive'</span>, <span class="st">'DBI'</span>, <span class="st">'odbc'</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">'RPostgres'</span>, <span class="st">'eurostat'</span>, <span class="st">'stringr'</span>, <span class="st">'forcats'</span>, <span class="st">'writexl'</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">'xlsx'</span>, <span class="st">'gt'</span>, <span class="st">'here'</span>, <span class="st">'giscoR'</span>, <span class="st">'sf'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> mypackages) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">==</span> <span class="st">"sf"</span>) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(p, <span class="at">type =</span> <span class="st">"binary"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(p)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="reading-aidres-data" class="level1">
<h1>Reading AIDRES data</h1>
<section id="establishing-aidres-database-connection-and-fetching-tables-not-used" class="level2">
<h2 class="anchored" data-anchor-id="establishing-aidres-database-connection-and-fetching-tables-not-used">Establishing AIDRES database connection and fetching tables (not used)</h2>
<p>The AIDRES database is open source <span class="citation" data-cites="aidres_report">(<a href="#ref-aidres_report" role="doc-biblioref">Vermeiren et al. 2023</a>)</span>. However, the data is <a href="https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/EIGL-Data/AIDRES/">available</a> as a raw <code>.sql</code> file which needs to be further used to setup a PostgreSQL database connection to fetch various tables.</p>
<p>We have set up an AIDRES postgreSQL database server at VITO. The following code chunks are used to fetch the tables dynamically for the analysis. Username and password are not explicitly mentioned due to security reasons; they are read from a local R env profile file. For a different computer, a separate profile file needs to be used.</p>
<p>These code chunks are currently deactivated, because we work with an updated version of the AIDRES database (AIDRES 2.0).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RPostgres<span class="sc">::</span><span class="fu">Postgres</span>(),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">host =</span> <span class="st">"kaartenbak.marvin.vito.local"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dbname =</span> <span class="st">"zandbakken"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">user =</span> <span class="fu">Sys.getenv</span>(<span class="st">"user"</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">password =</span> <span class="fu">Sys.getenv</span>(<span class="st">"password"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">port =</span> <span class="dv">5432</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Fetching tables from AIDRES database (currently deactivated)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>aidres_scenarios <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, dbplyr<span class="sc">::</span><span class="fu">in_schema</span>(<span class="st">'aidres'</span>,<span class="st">'model_scenario'</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>aidres_sectors <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, dbplyr<span class="sc">::</span><span class="fu">in_schema</span>(<span class="st">'aidres'</span>,<span class="st">'aidres_sectors'</span>))  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>aidres_result <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, dbplyr<span class="sc">::</span><span class="fu">in_schema</span>(<span class="st">'aidres'</span>,<span class="st">'model_results'</span>)) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>aidres_configurations <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, dbplyr<span class="sc">::</span><span class="fu">in_schema</span>(<span class="st">'aidres'</span>,<span class="st">'model_configurations'</span>)) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>aidres_perton <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, dbplyr<span class="sc">::</span><span class="fu">in_schema</span>(<span class="st">'aidres'</span>,<span class="st">'model_perton'</span>)) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="importing-aidres-2.0-data-from-local-.csv-files" class="level2">
<h2 class="anchored" data-anchor-id="importing-aidres-2.0-data-from-local-.csv-files">Importing AIDRES 2.0 data from local <code>.csv</code> files</h2>
<p>We use an updated version of the AIDRES database (AIDRES 2.0), in which the production capacities of particularly the chemical sector have been revised for both the Netherlands (based on MIDDEN: https://www.pbl.nl/en/publications/manufacturing-industry-decarbonisation-data-exchange-network) and Flanders (based on the GPBV database: https://omgeving.vlaanderen.be/nl/omgevingsvergunning/meer/overzicht-gpbv-installaties-in-vlaanderen-industrie). For the Netherlands, also all other AIDRES sectors have been checked based on Midden and updated where necessary.</p>
<p>The AIDRES 2.0 tables are included in this repository under input_data/aidres_data and consist of:<br>
aidres_2_0_scenarios.csv<br>
aidres_2_0_sectors.csv<br>
aidres_2_0_result.csv<br>
aidres_2_0_configurations.csv<br>
aidres_2_0_perton.csv</p>
<p>This chunk of code reads the AIDRES 2.0 data <code>.csv</code> files.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>aidres_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'aidres_data'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>aidres_2_0_sectors <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_2_0_sectors.csv'</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(aidres_data, <span class="st">"aidres_2_0_results.csv"</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>, <span class="at">grouping_mark =</span> <span class="st">","</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">guess_max =</span> <span class="dv">6000</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>aidres_2_0_configurations <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_2_0_configurations.csv'</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>aidres_2_0_products <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="fu">here</span>(aidres_data, <span class="st">'aidres_2_0_products.csv'</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>aidres_2_0_perton <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(aidres_data, <span class="st">"aidres_2_0_perton.csv"</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>, <span class="at">grouping_mark =</span> <span class="st">","</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">guess_max =</span> <span class="dv">6000</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>CCS_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'aidres_data'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>CCS_correction <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(CCS_path, <span class="st">'CCS capex correction.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'Sheet1'</span>, <span class="at">range =</span> <span class="st">'A1:M86'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>CCS_correction <span class="ot">&lt;-</span> CCS_correction <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">'configuration_id'</span>, <span class="st">'CAPEX to add (eur_ton product)'</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>CCS_correction</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 85 × 2
   configuration_id `CAPEX to add (eur_ton product)`
              &lt;dbl&gt; &lt;chr&gt;                           
 1                2 20.811664                       
 2                4 24.368992000000002              
 3                7 17.100608000000001              
 4                9 26.388016000000004              
 5               12 19.433600000000002              
 6               14 19.119632000000003              
 7               17 25.266336000000003              
 8               19 28.701983999999999              
 9               22 15.562304000000003              
10               24 19.158192                       
# ℹ 75 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="get-additional-data" class="level1">
<h1>Get additional data</h1>
<p>Get data on the CO2 consumption for the co electrolysis processes in AIDRES (based on Figure 12 and 13 of the <a href="https://op.europa.eu/en/publication-detail/-/publication/577d820d-5115-11ee-9220-01aa75ed71a1à">final aidres report</a>). For (COEL)FT-MEA, (COEL)MeOH-MEA, CO2 consumption in the final aidres report is expressed in ton CO2/ton of Light Liquid Fuels (LLF), which is converted to ton CO2/MWh LLF based on a lower heating value of 11.91 MWh/ton LLF. For ((COEL)MeOH)O-MEA, ton CO2/ton LLF is converted to ton CO2/ton olefins by dividing by 2.15 ton MeOH/ton LLF (source: original AIDRES report Figure 13) and by 0.41 ton olefins/ton MeOH (source: AIDRES configuration (MeOH)O).</p>
<p>Two new production routes for LLFs have been added based on the <a href="https://ens.dk/en/analyses-and-statistics/technology-catalogues">Danish technology catalogue</a>: ‘Hydrogen to Jet’ ((H2)FT-DC) and ‘Methanol from hydrogen and carbon dioxide’ ((H2)MeOH-DC).</p>
<p>For the ‘Hydrogen to Jet’ process, the overnight capex is expressed in Meur/MW Liquids, which is converted to (eur-yr)/mwh by multiplying by 1000000 eur/Meur and dividing by 8760 h/y. The fom already has the correct unit.</p>
<p>For the ‘Methanol from hydrogen and carbon dioxide’, the capex is expressed in Meur/MW_Methanol, which is converted to (eur-yr)/mwh by multiplying by 1000000 eur/Meur and dividing by 8760 h/y. The fom is expressed in ‘keur_(MW_methanol_year)’, which is multiplied by 1000 eur/keur and divided by 8760 h/year to convert to eur/mwh.</p>
<p>Check the ‘extra_data_processed.xlsx’ file (tab ‘calculations’) for more info on the calculations.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>file_extra_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'extra_data'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(file_extra_data, <span class="st">'extra_data_processes.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'extra_data'</span>, <span class="at">range =</span> <span class="st">'A1:K20'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Get production data for Switzerland, Norway and the UK. More information on the data sources can be found in ‘Mopo_Data_Collection_CH_NO_UK.xlsx’.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>extra_data_production <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(file_extra_data, <span class="st">'Mopo_Data_Collection_CH_NO_UK.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'extra_data_CH_NO_UK'</span>, <span class="at">range =</span> <span class="st">'A1:N170'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...14`</code></pre>
</div>
</div>
</section>
<section id="aidres-data-for-mopo-eu-industrial-cluster-case-study" class="level1">
<h1>AIDRES data for MOPO EU/ Industrial cluster case study</h1>
<p>Important general remarks:<br>
- Processing AIDRES 2.0 data to construct tables for the technology catalogue. To limit the number of production routes for the analysis we only select AIDRES 2.0 routes that are in the AIDRES 2040 mix<br>
- Both nitric acid and urea related data are not extracted from AIDRES 2.0, because of the risk of double counting the energy use for ammonia production.<br>
- Specific Energy Consumption is converted from PJ to MWh<br>
- For LLF production in refineries, LLF is renamed to HC (HydroCarbons) and output units are converted from ton HC to MWh HC</p>
<section id="specific-energy-consumption-factors" class="level2">
<h2 class="anchored" data-anchor-id="specific-energy-consumption-factors">Specific energy consumption factors</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'sec'</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'from_node'</span>, <span class="st">'to_node'</span>, <span class="st">'unit'</span>, <span class="st">'2025'</span>, <span class="st">'2030'</span>, <span class="st">'2040'</span>, <span class="st">'2050'</span>) <span class="ot">-&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  extra_data_filtered</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>aidres_2_0_configurations<span class="sc">$</span>configuration <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, aidres_2_0_configurations<span class="sc">$</span>configuration)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>aidres_2_0_perton <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario_id<span class="sc">:</span>is_reference_route, <span class="fu">contains</span>(<span class="st">'_usage_pj_t'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(alternative_fuel_mixture_usage_pj_t<span class="sc">:</span>natural_gas_usage_pj_t, <span class="at">names_to =</span> <span class="st">'indicators'</span>, <span class="at">values_to =</span> <span class="st">'gj_t'</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((horizon <span class="sc">==</span> <span class="dv">2030</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|</span> horizon <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, mix_2018<span class="sc">:</span>mix_2050), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, configuration), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'product_id'</span> <span class="sc">==</span> <span class="st">'product_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    (is_reference_route <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span> </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      (mix_2040 <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'mix'</span>, configuration) <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      (configuration_id <span class="sc">==</span> <span class="dv">221</span>) <span class="sc">|</span> (configuration_id <span class="sc">==</span> <span class="dv">241</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, product, configuration, indicators, gj_t) <span class="sc">|&gt;</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_id =</span> sector) <span class="sc">|&gt;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">product_id =</span> product) <span class="sc">|&gt;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> indicators, <span class="at">values_from =</span> gj_t) <span class="sc">|&gt;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">coal =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(coal_usage_pj_t, coke_usage_pj_t, coal_steel_usage_pj_t), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">bio =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(biomass_usage_pj_t, biomass_waste_usage_pj_t), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">waste =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(plastic_mix_usage_pj_t, alternative_fuel_mixture_usage_pj_t), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">HC =</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(crude_oil_usage_pj_t, naphtha_usage_pj_t), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NH3'</span> <span class="ot">=</span> ammonia_usage_pj_t,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'elec'</span> <span class="ot">=</span> electricity_usage_pj_t,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H2'</span> <span class="ot">=</span> hydrogen_usage_pj_t,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MeOH'</span> <span class="ot">=</span> methanol_usage_pj_t,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CH4'</span> <span class="ot">=</span> natural_gas_usage_pj_t) <span class="sc">|&gt;</span> </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(H2<span class="sc">:</span>HC, <span class="at">names_to =</span> <span class="st">'commodity'</span>, <span class="at">values_to =</span> <span class="st">'gj_t'</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gj_t =</span> gj_t <span class="sc">*</span> <span class="dv">1000000</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'to_node'</span> <span class="ot">=</span> product_id,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'from_node'</span> <span class="ot">=</span> commodity,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Industry'</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mwh_t =</span> <span class="fu">round</span>((gj_t <span class="sc">*</span> <span class="fl">0.277</span>),<span class="dv">5</span>), <span class="at">.keep =</span> <span class="st">'unused'</span>) <span class="ot">-&gt;</span>  sec_perton_all</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>sec_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 711 × 5
   sector_id to_node Industry    from_node  mwh_t
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
 1 cement    cement  EU-mix-2018 H2        0     
 2 cement    cement  EU-mix-2018 MeOH      0     
 3 cement    cement  EU-mix-2018 NH3       0     
 4 cement    cement  EU-mix-2018 elec      0.0801
 5 cement    cement  EU-mix-2018 CH4       0     
 6 cement    cement  EU-mix-2018 coal      0.319 
 7 cement    cement  EU-mix-2018 bio       0.123 
 8 cement    cement  EU-mix-2018 waste     0.205 
 9 cement    cement  EU-mix-2018 HC        0     
10 cement    cement  CEM2-(Coal) H2        0     
# ℹ 701 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sec_perton_all[<span class="fu">sapply</span>(sec_perton_all, is.infinite)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>sec_perton_all_2025 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2025</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sec_perton_all_2030 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2030</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>sec_perton_all_2040 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2040</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>sec_perton_all_2050 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2050</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sec_perton_all_2025, sec_perton_all_2030, sec_perton_all_2040, sec_perton_all_2050) <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mwh_t, <span class="at">names_from =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'mwh_t'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id<span class="sc">:</span>to_node, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> sec_perton_all</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># for refineries, we want the product in MWh (1 ton HC = 11.92 MWh)</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># change glass production routes names</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">from_node =</span> <span class="fu">case_when</span>((sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">&amp;</span> from_node <span class="sc">==</span> <span class="st">'HC'</span>)<span class="sc">~</span> <span class="st">'crude'</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> from_node)) <span class="sc">|&gt;</span> </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2025</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value <span class="sc">/</span> <span class="fl">11.92</span>,<span class="dv">5</span>),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> value)) <span class="sc">|&gt;</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'mwh_mwh'</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> <span class="st">'mwh_t'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Industry =</span> <span class="fu">case_when</span>(to_node <span class="sc">==</span> <span class="st">'glass-container'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gco'</span>),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-fibre'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfi'</span>),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-float'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfl'</span>),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Industry)) <span class="sc">|&gt;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(extra_data_filtered) <span class="sc">|&gt;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.0000001</span> <span class="sc">|</span> <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.0000001</span> <span class="sc">|</span> <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.0000001</span> <span class="sc">|</span> <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.0000001</span>))<span class="ot">-&gt;</span> sec_perton_all</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>sec_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 185 × 9
   sector_id to_node unit  Industry        from_node `2025` `2030` `2040` `2050`
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 cement    cement  mwh_t EU-mix-2018     elec      0.0801 0.0801 0.0801 0.0801
 2 cement    cement  mwh_t EU-mix-2018     coal      0.319  0.319  0.319  0.319 
 3 cement    cement  mwh_t EU-mix-2018     bio       0.123  0.123  0.123  0.123 
 4 cement    cement  mwh_t EU-mix-2018     waste     0.205  0.205  0.205  0.205 
 5 cement    cement  mwh_t CEM2-(Coal)     elec      0.0801 0.0801 0.0801 0.0801
 6 cement    cement  mwh_t CEM2-(Coal)     coal      0.590  0.590  0.590  0.590 
 7 cement    cement  mwh_t CEM2-(Coal)CaL  elec      0.130  0.130  0.130  0.130 
 8 cement    cement  mwh_t CEM2-(Coal)CaL  coal      0.590  0.590  0.590  0.590 
 9 cement    cement  mwh_t CEM2-(Coal)Oxy… elec      0.158  0.158  0.158  0.158 
10 cement    cement  mwh_t CEM2-(Coal)Oxy… coal      0.594  0.594  0.594  0.594 
# ℹ 175 more rows</code></pre>
</div>
</div>
</section>
<section id="costs-capex-and-fom" class="level2">
<h2 class="anchored" data-anchor-id="costs-capex-and-fom">Costs: capex and fom</h2>
<p>Important remarks:<br>
- The cost figures from AIDRES 2.0 (in EUR2018) and from the Danish Technology Catalogue (in EUR2020) are converted to EUR2025 using historical inflation rates.<br>
- Annualized CAPEX values are converted to total CAPEX using a capital recovery factor based on a 6% interest rate. For all routes the lifetime of the original source is retained.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'fom'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'to_node'</span>, <span class="st">'parameter'</span>, <span class="st">'unit'</span>, <span class="st">'2025'</span>, <span class="st">'2030'</span>, <span class="st">'2040'</span>, <span class="st">'2050'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'costs'</span> <span class="ot">=</span> <span class="st">'parameter'</span>) <span class="ot">-&gt;</span> extra_data_fom_filtered</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'capex'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'to_node'</span>, <span class="st">'parameter'</span>, <span class="st">'unit'</span>, <span class="st">'2025'</span>, <span class="st">'2030'</span>, <span class="st">'2040'</span>, <span class="st">'2050'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">1.026</span> <span class="sc">*</span> <span class="fl">1.084</span> <span class="sc">*</span> <span class="fl">1.054</span> <span class="sc">*</span> <span class="fl">1.024</span> <span class="sc">*</span> <span class="fl">1.021</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'costs'</span> <span class="ot">=</span> <span class="st">'parameter'</span>)  <span class="ot">-&gt;</span> extra_data_capex_filtered</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>int_rate <span class="ot">&lt;-</span> .<span class="dv">06</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>life_40 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>life_30 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>life_25 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>crf_40 <span class="ot">&lt;-</span> (int_rate<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_40)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_40 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>crf_30 <span class="ot">&lt;-</span> (int_rate<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_30)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_30 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>crf_25 <span class="ot">&lt;-</span> (int_rate<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_25)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>int_rate)<span class="sc">^</span>life_25 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>aidres_2_0_perton <span class="sc">|&gt;</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(CCS_correction, <span class="at">by =</span> <span class="st">"configuration_id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">CAPEX to add (eur_ton product)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">CAPEX to add (eur_ton product)</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">capex_eur_t =</span> capex_eur_t <span class="sc">+</span> <span class="fu">coalesce</span>(capex_to_add_eur_ton_product, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario_id<span class="sc">:</span>is_reference_route, <span class="fu">contains</span>(<span class="st">'eur_t'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(opex_var_eur_t<span class="sc">:</span>capex_eur_t, <span class="at">names_to =</span> <span class="st">'indicators'</span>, <span class="at">values_to =</span> <span class="st">'eur_t'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((horizon <span class="sc">==</span> <span class="dv">2030</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|</span> horizon <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, mix_2018<span class="sc">:</span>mix_2050), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, configuration), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'product_id'</span> <span class="sc">==</span> <span class="st">'product_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    (is_reference_route <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span> </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    (mix_2040 <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'mix'</span>, configuration) <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span> <span class="sc">&amp;</span> is_reference_route <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> scenario_id <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    (configuration_id <span class="sc">==</span> <span class="dv">221</span>) <span class="sc">|</span> (configuration_id <span class="sc">==</span> <span class="dv">241</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, product, configuration, indicators, eur_t) <span class="sc">|&gt;</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_id =</span> sector) <span class="sc">|&gt;</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">product_id =</span> product) <span class="sc">|&gt;</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> indicators, <span class="at">values_from =</span> eur_t) <span class="sc">|&gt;</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'capex'</span> <span class="ot">=</span> capex_eur_t,</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>         <span class="st">'fom'</span> <span class="ot">=</span>  opex_cst_eur_t,</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>         <span class="st">'vom'</span> <span class="ot">=</span> opex_var_eur_t) <span class="sc">|&gt;</span> </span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(capex<span class="sc">:</span>vom, <span class="at">names_to =</span> <span class="st">'costs'</span>, <span class="at">values_to =</span> <span class="st">'eur_t'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eur_t =</span> <span class="fu">round</span>(eur_t,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'to_node'</span> <span class="ot">=</span> product_id,</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>         <span class="st">'Industry'</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span> </span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> costs_perton_all</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>costs_perton_all <span class="sc">|&gt;</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(costs <span class="sc">==</span> <span class="st">"capex"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eur_t =</span> <span class="fu">round</span>(</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    eur_t <span class="sc">/</span> <span class="fu">case_when</span>(</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Industry == "ethane_cracker_H2+CH4" ~ crf_30,</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Industry == "ethane_cracker_H2+CH4_with_CCS" ~ crf_30,</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>      Industry <span class="sc">==</span> <span class="st">"(H2)FT-DC"</span> <span class="sc">~</span> crf_25,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>      Industry <span class="sc">==</span> <span class="st">"(H2)MeOH-DC"</span> <span class="sc">~</span> crf_30,</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>      Industry <span class="sc">==</span> <span class="st">"Diaphragm"</span> <span class="sc">~</span> crf_30,</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>            <span class="sc">~</span> crf_40       <span class="co"># default for all other industries</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>  )) <span class="ot">-&gt;</span> capex_perton_all</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>costs_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(costs <span class="sc">==</span> <span class="st">'fom'</span>) <span class="ot">-&gt;</span> fom_perton_all</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(capex_perton_all, fom_perton_all) <span class="ot">-&gt;</span> costs_perton_all</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Capex and cst opex is multiplied with historical inflation rate</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Inflation rates: 2018, 1.8,; 2019, 1.2; 2020,0.3; 2021,2.6; 2022,8.4; 2023,5.4; 2024,2.4; projected 2025,2.1</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>costs_perton_all_2025 <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2025</span>, <span class="at">eur_t =</span> eur_t<span class="sc">*</span><span class="fl">1.012</span><span class="sc">*</span><span class="fl">1.003</span><span class="sc">*</span><span class="fl">1.026</span><span class="sc">*</span><span class="fl">1.084</span><span class="sc">*</span><span class="fl">1.054</span><span class="sc">*</span><span class="fl">1.024</span><span class="sc">*</span><span class="fl">1.021</span>)</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>costs_perton_all_2030 <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2030</span>, <span class="at">eur_t =</span> eur_t<span class="sc">*</span><span class="fl">1.012</span><span class="sc">*</span><span class="fl">1.003</span><span class="sc">*</span><span class="fl">1.026</span><span class="sc">*</span><span class="fl">1.084</span><span class="sc">*</span><span class="fl">1.054</span><span class="sc">*</span><span class="fl">1.024</span><span class="sc">*</span><span class="fl">1.021</span>)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>costs_perton_all_2040 <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2040</span>, <span class="at">eur_t =</span> eur_t<span class="sc">*</span><span class="fl">1.012</span><span class="sc">*</span><span class="fl">1.003</span><span class="sc">*</span><span class="fl">1.026</span><span class="sc">*</span><span class="fl">1.084</span><span class="sc">*</span><span class="fl">1.054</span><span class="sc">*</span><span class="fl">1.024</span><span class="sc">*</span><span class="fl">1.021</span>)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>costs_perton_all_2050 <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2050</span>, <span class="at">eur_t =</span> eur_t<span class="sc">*</span><span class="fl">1.012</span><span class="sc">*</span><span class="fl">1.003</span><span class="sc">*</span><span class="fl">1.026</span><span class="sc">*</span><span class="fl">1.084</span><span class="sc">*</span><span class="fl">1.054</span><span class="sc">*</span><span class="fl">1.024</span><span class="sc">*</span><span class="fl">1.021</span>)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(costs_perton_all_2025, costs_perton_all_2030, costs_perton_all_2040, costs_perton_all_2050) <span class="sc">|&gt;</span> </span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> eur_t, <span class="at">names_from =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(costs <span class="sc">==</span> <span class="st">'capex'</span><span class="sc">~</span> <span class="st">'eur-yr_t'</span>,</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>                          costs <span class="sc">==</span> <span class="st">'fom'</span> <span class="sc">~</span> <span class="st">'eur_t'</span>,</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>                          costs <span class="sc">==</span><span class="st">'vom'</span> <span class="sc">~</span> <span class="st">'eur_t'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id<span class="sc">:</span>costs, unit, <span class="fu">everything</span>()) <span class="ot">-&gt;</span> costs_perton_all</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a><span class="co"># for refineries, we want the product in MWh (1 ton HC = 11.92 MWh)</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a><span class="co"># change glass production routes names</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>costs_perton_all <span class="sc">|&gt;</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2025</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> value<span class="sc">/</span><span class="fl">11.92</span>,</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Industry =</span> <span class="fu">case_when</span>(to_node <span class="sc">==</span> <span class="st">'glass-container'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gco'</span>),</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-fibre'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfi'</span>),</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-float'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfl'</span>),</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Industry)) <span class="sc">|&gt;</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value) <span class="ot">-&gt;</span> costs_perton_all</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(costs <span class="sc">==</span> <span class="st">'capex'</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">bind_rows</span>(extra_data_capex_filtered) <span class="sc">|&gt;</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'eur-yr_mwh'</span>,</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> <span class="st">'eur-yr_t'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node))</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 9
   sector_id Industry           to_node costs unit   `2025` `2030` `2040` `2050`
   &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 cement    EU-mix-2018        cement  capex eur-y…   56.2   56.2   56.2   56.2
 2 cement    CEM2-(Coal)        cement  capex eur-y…   56.2   56.2   56.2   56.2
 3 cement    CEM2-(Coal)CaL     cement  capex eur-y…  393.   393.   393.   393. 
 4 cement    CEM2-(Coal)Oxy-CaL cement  capex eur-y…  281.   281.   281.   281. 
 5 cement    CEM2-(Afm)         cement  capex eur-y…   56.2   56.2   56.2   56.2
 6 cement    CEM2-(Afm)MEA      cement  capex eur-y…  366.   366.   366.   366. 
 7 cement    CEM2-(Afm)CaL      cement  capex eur-y…  412.   412.   412.   412. 
 8 cement    CEM2-(Afm)Oxy-CaL  cement  capex eur-y…  281.   281.   281.   281. 
 9 cement    CEM2-(BMW)         cement  capex eur-y…   56.2   56.2   56.2   56.2
10 cement    CEM2-(BMW)MEA      cement  capex eur-y…  446.   446.   446.   446. 
# ℹ 71 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all <span class="ot">&lt;-</span> costs_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(costs <span class="sc">==</span> <span class="st">'fom'</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">bind_rows</span>(extra_data_fom_filtered) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'eur_mwh'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">.default =</span> <span class="st">'eur_t'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 9
   sector_id Industry           to_node costs unit  `2025` `2030` `2040` `2050`
   &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 cement    EU-mix-2018        cement  fom   eur_t   29.0   29.0   29.0   29.0
 2 cement    CEM2-(Coal)        cement  fom   eur_t   29.0   29.0   29.0   29.0
 3 cement    CEM2-(Coal)CaL     cement  fom   eur_t   37.7   37.7   37.7   37.7
 4 cement    CEM2-(Coal)Oxy-CaL cement  fom   eur_t   35.7   35.7   35.7   35.7
 5 cement    CEM2-(Afm)         cement  fom   eur_t   29.0   29.0   29.0   29.0
 6 cement    CEM2-(Afm)MEA      cement  fom   eur_t   29.0   29.0   29.0   29.0
 7 cement    CEM2-(Afm)CaL      cement  fom   eur_t   37.8   37.8   37.8   37.8
 8 cement    CEM2-(Afm)Oxy-CaL  cement  fom   eur_t   34.4   34.4   34.4   34.4
 9 cement    CEM2-(BMW)         cement  fom   eur_t   29.0   29.0   29.0   29.0
10 cement    CEM2-(BMW)MEA      cement  fom   eur_t   29.0   29.0   29.0   29.0
# ℹ 71 more rows</code></pre>
</div>
</div>
</section>
<section id="co2-emissions-and-capture" class="level2">
<h2 class="anchored" data-anchor-id="co2-emissions-and-capture">CO2 emissions and capture</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'co2_capture'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'to_node'</span>, <span class="st">'parameter'</span>, <span class="st">'unit'</span>, <span class="st">'2025'</span>, <span class="st">'2030'</span>, <span class="st">'2040'</span>, <span class="st">'2050'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'emission'</span> <span class="ot">=</span> <span class="st">'parameter'</span>) <span class="ot">-&gt;</span> extra_data_co2_capture_filtered</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'co2_emission'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'to_node'</span>, <span class="st">'parameter'</span>, <span class="st">'unit'</span>, <span class="st">'2025'</span>, <span class="st">'2030'</span>, <span class="st">'2040'</span>, <span class="st">'2050'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'emission'</span> <span class="ot">=</span> <span class="st">'parameter'</span>) <span class="ot">-&gt;</span> extra_data_co2_emission_filtered</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>aidres_2_0_perton <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(scenario_id<span class="sc">:</span>is_reference_route, direct_emission_tco2_t, captured_co2_tco2_t) <span class="sc">|&gt;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(direct_emission_tco2_t<span class="sc">:</span> captured_co2_tco2_t, <span class="at">names_to =</span> <span class="st">'indicators'</span>, <span class="at">values_to =</span> <span class="st">'tco2_t'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((horizon <span class="sc">==</span> <span class="dv">2030</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|</span> horizon <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, mix_2018<span class="sc">:</span>mix_2050), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, configuration), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'product_id'</span> <span class="sc">==</span> <span class="st">'product_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    (is_reference_route <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> scenario_id <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    (mix_2040 <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'mix'</span>, configuration) <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span> <span class="sc">&amp;</span> is_reference_route <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> scenario_id <span class="sc">!=</span> <span class="dv">0</span>)<span class="sc">|</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        (configuration_id <span class="sc">==</span> <span class="dv">221</span>) <span class="sc">|</span> (configuration_id <span class="sc">==</span> <span class="dv">241</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, product, configuration, indicators, tco2_t) <span class="sc">|&gt;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_id =</span> sector) <span class="sc">|&gt;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">product_id =</span> product) <span class="sc">|&gt;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> indicators, <span class="at">values_from =</span> tco2_t) <span class="sc">|&gt;</span> </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'co2_capture'</span> <span class="ot">=</span> captured_co2_tco2_t,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">'co2_emission'</span> <span class="ot">=</span> direct_emission_tco2_t) <span class="sc">|&gt;</span> </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(co2_capture<span class="sc">:</span>co2_emission, <span class="at">names_to =</span> <span class="st">'emission'</span>, <span class="at">values_to =</span> <span class="st">'tco2_t'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'to_node'</span> <span class="ot">=</span> product_id,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">'Industry'</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span> </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, <span class="fu">everything</span>())  <span class="ot">-&gt;</span> emission_perton_all</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>emission_perton_all_2025 <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2025</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>emission_perton_all_2030 <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2030</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>emission_perton_all_2040 <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2040</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>emission_perton_all_2050 <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2050</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(emission_perton_all_2025, emission_perton_all_2030, emission_perton_all_2040, emission_perton_all_2050) <span class="sc">|&gt;</span> </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> tco2_t, <span class="at">names_from =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'tco2_t'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id<span class="sc">:</span>emission, unit, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2025</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value<span class="sc">/</span><span class="fl">11.92</span>,<span class="dv">3</span>),</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'tco2_mwh'</span>,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> <span class="st">'tco2_t'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Industry =</span> <span class="fu">case_when</span>(to_node <span class="sc">==</span> <span class="st">'glass-container'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gco'</span>),</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-fibre'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfi'</span>),</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-float'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfl'</span>),</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Industry)) <span class="sc">|&gt;</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value) <span class="ot">-&gt;</span> emission_perton_all</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">filter</span>(emission <span class="sc">==</span> <span class="st">'co2_capture'</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">bind_rows</span>(extra_data_co2_capture_filtered) <span class="sc">|&gt;</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node))</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 9
   sector_id Industry         to_node emission unit  `2025` `2030` `2040` `2050`
   &lt;chr&gt;     &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 cement    EU-mix-2018      cement  co2_cap… tco2…  0      0      0      0    
 2 cement    CEM2-(Coal)      cement  co2_cap… tco2…  0      0      0      0    
 3 cement    CEM2-(Coal)CaL   cement  co2_cap… tco2…  0.438  0.438  0.438  0.438
 4 cement    CEM2-(Coal)Oxy-… cement  co2_cap… tco2…  0.533  0.533  0.533  0.533
 5 cement    CEM2-(Afm)       cement  co2_cap… tco2…  0      0      0      0    
 6 cement    CEM2-(Afm)MEA    cement  co2_cap… tco2…  0.516  0.516  0.516  0.516
 7 cement    CEM2-(Afm)CaL    cement  co2_cap… tco2…  0.448  0.448  0.448  0.448
 8 cement    CEM2-(Afm)Oxy-C… cement  co2_cap… tco2…  0.457  0.457  0.457  0.457
 9 cement    CEM2-(BMW)       cement  co2_cap… tco2…  0      0      0      0    
10 cement    CEM2-(BMW)MEA    cement  co2_cap… tco2…  0.65   0.65   0.65   0.65 
# ℹ 71 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> emission_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">filter</span>(emission <span class="sc">==</span> <span class="st">'co2_emission'</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">bind_rows</span>(extra_data_co2_emission_filtered) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 9
   sector_id Industry         to_node emission unit  `2025` `2030` `2040` `2050`
   &lt;chr&gt;     &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 cement    EU-mix-2018      cement  co2_emi… tco2…  0.498  0.498  0.498  0.498
 2 cement    CEM2-(Coal)      cement  co2_emi… tco2…  0.524  0.524  0.524  0.524
 3 cement    CEM2-(Coal)CaL   cement  co2_emi… tco2…  0.086  0.086  0.086  0.086
 4 cement    CEM2-(Coal)Oxy-… cement  co2_emi… tco2…  0.083  0.083  0.083  0.083
 5 cement    CEM2-(Afm)       cement  co2_emi… tco2…  0.535  0.535  0.535  0.535
 6 cement    CEM2-(Afm)MEA    cement  co2_emi… tco2…  0.129  0.129  0.129  0.129
 7 cement    CEM2-(Afm)CaL    cement  co2_emi… tco2…  0.088  0.088  0.088  0.088
 8 cement    CEM2-(Afm)Oxy-C… cement  co2_emi… tco2…  0.075  0.075  0.075  0.075
 9 cement    CEM2-(BMW)       cement  co2_emi… tco2…  0.342  0.342  0.342  0.342
10 cement    CEM2-(BMW)MEA    cement  co2_emi… tco2… -0.308 -0.308 -0.308 -0.308
# ℹ 71 more rows</code></pre>
</div>
</div>
</section>
<section id="additional-production-data" class="level2">
<h2 class="anchored" data-anchor-id="additional-production-data">Additional production data</h2>
<p>Preprocess additional production data for CH, NO, and UK from ‘Mopo_Data_Collection_CH_NO_UK.xlsx’</p>
<p>Important remarks:<br>
- We exclude the following products:<br>
- ‘urea’ (to avoid double counting ammonia production)<br>
- ‘nitric acid’ (to avoid double counting ammonia production)<br>
- ‘chlorine’ (added later for all countries)<br>
- Preferred data from reliable sources listed in Mopo_Data_Collection_CH_NO_UK.xlsx (latest year); if unavailable, fall back to PyPSA-EUR values (see Tab ‘extra_data_choice’).<br>
- For the products listed below, PyPSA-EUR ‘production index’ values are replaced with useful energy. Useful energy is obtained by applying product specific conversion factors from JRC‑IDEES (‘input_data/processed_jrc_idees_data/useful_energy_per_production_index.csv’), generated by the ‘jrc idees processing.py’ script in the ‘JRC idees processing python’ folder (see below, Section ‘Add production, production route and CO₂ emission data for non‑Aidres sectors’).</p>
<p>Applicable products with production index to useful energy conversion:<br>
- food, beverages and tobacco<br>
- leather and textile<br>
- transport equipment<br>
- machinery equipment<br>
- wood and wood products<br>
- other industrial sectors</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>to_node_year_production_factor_relation_2018 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_node =</span> <span class="fu">c</span>(<span class="st">'glass-container'</span>, <span class="st">'cement'</span>, <span class="st">'chemical-PE'</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'chemical-PEA'</span>, <span class="st">'chemical-olefins'</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'HC'</span>, <span class="st">'steel-secondary'</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">'steel-primary'</span>, <span class="st">'fertiliser-ammonia-NH3'</span>, <span class="st">'glass-float'</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">'glass-fibre'</span>, <span class="st">'other-chemicals'</span>, <span class="st">'pharmaceuticals'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">'food-beverages-tobacco'</span>, <span class="st">'machinery-equipment'</span>, <span class="st">'alumina'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">'aluminium-primary'</span>, <span class="st">'aluminium-secondary'</span>, <span class="st">'other-non-ferrous-metals'</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">'ceramics-and-other-non-metalic-minerals'</span>, <span class="st">'other-industrial-sectors'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">'paper'</span>, <span class="st">'printing-and-media'</span>, <span class="st">'pulp'</span>, <span class="st">'leather-and-textile'</span>, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">'transport-equipment'</span>, <span class="st">'wood-and-wood-products'</span>, <span class="st">'glass'</span>), </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">production_factor_2018 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>to_node_year_production_factor_relation_2030 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_node =</span> <span class="fu">c</span>(<span class="st">'glass-container'</span>, <span class="st">'cement'</span>, <span class="st">'chemical-PE'</span>, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">'chemical-PEA'</span>, <span class="st">'chemical-olefins'</span>, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>             <span class="st">'HC'</span>, <span class="st">'steel-secondary'</span>, </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>             <span class="st">'steel-primary'</span>, <span class="st">'fertiliser-ammonia-NH3'</span>, <span class="st">'glass-float'</span>, </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>             <span class="st">'glass-fibre'</span>, <span class="st">'other-chemicals'</span>, <span class="st">'pharmaceuticals'</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">'food-beverages-tobacco'</span>, <span class="st">'machinery-equipment'</span>, <span class="st">'alumina'</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">'aluminium-primary'</span>, <span class="st">'aluminium-secondary'</span>, <span class="st">'other-non-ferrous-metals'</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">'ceramics-and-other-non-metalic-minerals'</span>, <span class="st">'other-industrial-sectors'</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>             <span class="st">'paper'</span>, <span class="st">'printing-and-media'</span>, <span class="st">'pulp'</span>, <span class="st">'leather-and-textile'</span>, </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>             <span class="st">'transport-equipment'</span>, <span class="st">'wood-and-wood-products'</span>, <span class="st">'glass'</span>), </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">production_factor_2030 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.84</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  to_node_year_production_factor_relation_2050 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_node =</span> <span class="fu">c</span>(<span class="st">'glass-container'</span>, <span class="st">'cement'</span>, <span class="st">'chemical-PE'</span>, </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>             <span class="st">'chemical-PEA'</span>, <span class="st">'chemical-olefins'</span>, </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>             <span class="st">'HC'</span>, <span class="st">'steel-secondary'</span>, </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>             <span class="st">'steel-primary'</span>, <span class="st">'fertiliser-ammonia-NH3'</span>, <span class="st">'glass-float'</span>, </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>             <span class="st">'glass-fibre'</span>, <span class="st">'other-chemicals'</span>, <span class="st">'pharmaceuticals'</span>,</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>             <span class="st">'food-beverages-tobacco'</span>, <span class="st">'machinery-equipment'</span>, <span class="st">'alumina'</span>,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>             <span class="st">'aluminium-primary'</span>, <span class="st">'aluminium-secondary'</span>, <span class="st">'other-non-ferrous-metals'</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>             <span class="st">'ceramics-and-other-non-metalic-minerals'</span>, <span class="st">'other-industrial-sectors'</span>,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>             <span class="st">'paper'</span>, <span class="st">'printing-and-media'</span>, <span class="st">'pulp'</span>, <span class="st">'leather-and-textile'</span>, </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>             <span class="st">'transport-equipment'</span>, <span class="st">'wood-and-wood-products'</span>, <span class="st">'glass'</span>), </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">production_factor_2050 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.29</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>useful_energy_per_production <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"useful_energy_per_production_index.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector_id =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"FBT"</span>, sector) <span class="sc">~</span> <span class="st">"food-beverages-and-tobacco"</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"TEL"</span>, sector) <span class="sc">~</span> <span class="st">"aluminium-secondary-production-reference"</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"TRE"</span>, sector) <span class="sc">~</span> <span class="st">"transport-equipment"</span>,</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"MAE"</span>, sector) <span class="sc">~</span> <span class="st">"machinery-equipment"</span>,</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"WWP"</span>, sector) <span class="sc">~</span> <span class="st">"wood-and-wood-products"</span>,</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"OIS"</span>, sector) <span class="sc">~</span> <span class="st">"other-industrial-sectors"</span>)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> <span class="fu">select</span>(sector_id, useful_energy_per_capacity)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): sector, product, unit
dbl (2): year, useful_energy_per_capacity

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>extra_data_production_processed <span class="ot">&lt;-</span> extra_data_production <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(commodity) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">has_latest =</span> <span class="fu">any</span>(latest_year <span class="sc">==</span> <span class="st">"latest"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    (latest_year <span class="sc">==</span> <span class="st">"latest"</span>) <span class="sc">|</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    (<span class="sc">!</span>has_latest <span class="sc">&amp;</span> latest_year <span class="sc">==</span> <span class="st">"pypsa"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    (<span class="sc">!</span>commodity <span class="sc">==</span> <span class="st">'urea'</span>) <span class="sc">&amp;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>      (<span class="sc">!</span>commodity <span class="sc">==</span> <span class="st">'nitric acid'</span>) <span class="sc">&amp;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>      (<span class="sc">!</span>commodity <span class="sc">==</span> <span class="st">'chlorine'</span>) <span class="sc">&amp;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>      (<span class="sc">!</span>commodity <span class="sc">==</span> <span class="st">'methanol'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector_id =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"non-ferrous-metals"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"non-ferrous-metals"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other chemicals"</span>, commodity) <span class="sc">~</span> <span class="st">"chemical"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pharmaceuticals"</span>, commodity) <span class="sc">~</span> <span class="st">"chemical"</span>,     </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ceramics and other NMM"</span>, commodity) <span class="sc">~</span> <span class="st">"ceramics-and-other-non-metallic-mineral-products-excluding-cement-and-glass"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"all glass"</span>, commodity) <span class="sc">~</span> <span class="st">"glass"</span>,      </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pulp"</span>, commodity) <span class="sc">~</span> <span class="st">"pulp-and-paper"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"paper and paperboard"</span>, commodity) <span class="sc">~</span> <span class="st">"pulp-and-paper"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"printing and media reproduction"</span>, commodity) <span class="sc">~</span> <span class="st">"pulp-and-paper"</span>,  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"food, beverages and tobacco"</span>, commodity) <span class="sc">~</span> <span class="st">"food-beverages-and-tobacco"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"alumina"</span>, commodity) <span class="sc">~</span> <span class="st">"non-ferrous-metals"</span>,   </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other non-ferrous metals"</span>, commodity) <span class="sc">~</span> <span class="st">"non-ferrous-metals"</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"transport equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"transport-equipment"</span>, </span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"machinery equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"machinery-equipment"</span>,</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"textiles and leather"</span>, commodity) <span class="sc">~</span> <span class="st">"textiles-and-leather"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"wood and wood products"</span>, commodity) <span class="sc">~</span> <span class="st">"wood-and-wood-products"</span>,  </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other industrial sectors"</span>, commodity) <span class="sc">~</span> <span class="st">"other-industrial-sectors"</span>,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"cement"</span>, commodity) <span class="sc">~</span> <span class="st">"cement"</span>,</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ammonia"</span>, commodity) <span class="sc">~</span> <span class="st">"fertiliser"</span>, </span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"steel"</span>,  </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"steel"</span>,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-flat"</span>, commodity) <span class="sc">~</span> <span class="st">"glass"</span>,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-fibre"</span>, commodity) <span class="sc">~</span> <span class="st">"glass"</span>, </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-container"</span>, commodity) <span class="sc">~</span> <span class="st">"glass"</span>,</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"olefins"</span>, commodity) <span class="sc">~</span> <span class="st">"chemical"</span>,  </span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"light liquid fuel"</span>, commodity) <span class="sc">~</span> <span class="st">"refineries"</span>,</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"methanol"</span>, commodity) <span class="sc">~</span> <span class="st">"refineries"</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">to_node =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"aluminium-primary"</span>,</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"aluminium-secondary"</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other chemicals"</span>, commodity) <span class="sc">~</span> <span class="st">"other-chemicals"</span>,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pharmaceuticals"</span>, commodity) <span class="sc">~</span> <span class="st">"pharmaceuticals"</span>,     </span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ceramics and other NMM"</span>, commodity) <span class="sc">~</span> <span class="st">"ceramics-and-other-non-metalic-minerals"</span>,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"all glass"</span>, commodity) <span class="sc">~</span> <span class="st">"glass"</span>,      </span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pulp"</span>, commodity) <span class="sc">~</span> <span class="st">"pulp"</span>,</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"paper and paperboard"</span>, commodity) <span class="sc">~</span> <span class="st">"paper"</span>,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"printing and media reproduction"</span>, commodity) <span class="sc">~</span> <span class="st">"printing-and-media"</span>,  </span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"food, beverages and tobacco"</span>, commodity) <span class="sc">~</span> <span class="st">"food-beverages-tobacco"</span>,</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"alumina"</span>, commodity) <span class="sc">~</span> <span class="st">"alumina"</span>,   </span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other non-ferrous metals"</span>, commodity) <span class="sc">~</span> <span class="st">"other-non-ferrous-metals"</span>,</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"transport equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"transport-equipment"</span>, </span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"machinery equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"machinery-equipment"</span>,</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"textiles and leather"</span>, commodity) <span class="sc">~</span> <span class="st">"leather-and-textile"</span>,</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"wood and wood products"</span>, commodity) <span class="sc">~</span> <span class="st">"wood-and-wood-products"</span>,  </span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other industrial sectors"</span>, commodity) <span class="sc">~</span> <span class="st">"other-industrial-sectors"</span>,</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"cement"</span>, commodity) <span class="sc">~</span> <span class="st">"cement"</span>,</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ammonia"</span>, commodity) <span class="sc">~</span> <span class="st">"fertiliser-ammonia-NH3"</span>, </span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"steel-primary"</span>,  </span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"steel-secondary"</span>,</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-flat"</span>, commodity) <span class="sc">~</span> <span class="st">"glass-float"</span>,</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-fibre"</span>, commodity) <span class="sc">~</span> <span class="st">"glass-fibre"</span>, </span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-container"</span>, commodity) <span class="sc">~</span> <span class="st">"glass-container"</span>,</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"olefins"</span>, commodity) <span class="sc">~</span> <span class="st">"chemical-olefins"</span>,  </span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"light liquid fuel"</span>, commodity) <span class="sc">~</span> <span class="st">"HC"</span>,</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"methanol"</span>, commodity) <span class="sc">~</span> <span class="st">"HC-MeOH"</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Industry =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"aluminium-primary-production-reference"</span>,</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"aluminium-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"aluminium-secondary-production-reference"</span>,</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other chemicals"</span>, commodity) <span class="sc">~</span> <span class="st">"other-chemicals-production-reference"</span>,</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pharmaceuticals"</span>, commodity) <span class="sc">~</span> <span class="st">"pharmaceuticals-production-reference"</span>,     </span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ceramics and other NMM"</span>, commodity) <span class="sc">~</span> <span class="st">"ceramics-and-other-non-metalic-minerals-production-reference"</span>,</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"all glass"</span>, commodity) <span class="sc">~</span> <span class="st">"(NG)_gfl"</span>,      <span class="co"># check this</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"pulp"</span>, commodity) <span class="sc">~</span> <span class="st">"pulp-production-reference"</span>,</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"paper and paperboard"</span>, commodity) <span class="sc">~</span> <span class="st">"paper-production-reference"</span>,</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"printing and media reproduction"</span>, commodity) <span class="sc">~</span> <span class="st">"printing-and-media-production-reference"</span>,  </span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"food, beverages and tobacco"</span>, commodity) <span class="sc">~</span> <span class="st">"food-beverages-tobacco-production-reference"</span>,</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"alumina"</span>, commodity) <span class="sc">~</span> <span class="st">"alumina-production-reference"</span>,   </span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other non-ferrous metals"</span>, commodity) <span class="sc">~</span> <span class="st">"other-non-ferrous-metals-production-reference"</span>,</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"transport equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"transport-equipment-production-reference"</span>, </span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"machinery equipment"</span>, commodity) <span class="sc">~</span> <span class="st">"machinery-equipment-production-reference"</span>,</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"textiles and leather"</span>, commodity) <span class="sc">~</span> <span class="st">"leather-and-textile-production-reference"</span>,</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"wood and wood products"</span>, commodity) <span class="sc">~</span> <span class="st">"wood-and-wood-products_production-reference"</span>,  </span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"other industrial sectors"</span>, commodity) <span class="sc">~</span> <span class="st">"other-industrial-sectors_production-reference"</span>,</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"cement"</span>, commodity) <span class="sc">~</span> <span class="st">"EU-mix-2018"</span>,</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"ammonia"</span>, commodity) <span class="sc">~</span> <span class="st">"(NG)NH3"</span>, </span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-primary"</span>, commodity) <span class="sc">~</span> <span class="st">"BF-BOF"</span>,  </span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"steel-secondary"</span>, commodity) <span class="sc">~</span> <span class="st">"Scraps_EAF"</span>,</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-flat"</span>, commodity) <span class="sc">~</span> <span class="st">"(NG)_gfl"</span>,</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-fibre"</span>, commodity) <span class="sc">~</span> <span class="st">"(NG)_gfi"</span>, </span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"glass-container"</span>, commodity) <span class="sc">~</span> <span class="st">"(NG)_gco"</span>,</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"olefins"</span>, commodity) <span class="sc">~</span> <span class="st">"(LN)O"</span>,  </span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"light liquid fuel"</span>, commodity) <span class="sc">~</span> <span class="st">"REF-SMR"</span>,</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"methanol"</span>, commodity) <span class="sc">~</span> <span class="st">"(BM)MeOH"</span>   <span class="co">#Correct?</span></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(to_node_year_production_factor_relation_2018, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_node"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2018o</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(value_conv<span class="sc">*</span>production_factor_2018)) <span class="sc">|&gt;</span></span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(to_node_year_production_factor_relation_2030, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_node"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2030o</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(value_conv<span class="sc">*</span>production_factor_2030)) <span class="sc">|&gt;</span></span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(to_node_year_production_factor_relation_2050, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_node"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2050o</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(value_conv<span class="sc">*</span>production_factor_2050)) <span class="sc">|&gt;</span></span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(useful_energy_per_production, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sector_id"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2018o</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(useful_energy_per_capacity), useful_energy_per_capacity<span class="sc">/</span><span class="fl">0.0036</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2030o</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(useful_energy_per_capacity), useful_energy_per_capacity<span class="sc">/</span><span class="fl">0.0036</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">2050o</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(useful_energy_per_capacity), useful_energy_per_capacity<span class="sc">/</span><span class="fl">0.0036</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(useful_energy_per_capacity), <span class="st">"mwh/y"</span>, unit))</span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a>extra_data_production_processed_2018 <span class="ot">&lt;-</span> extra_data_production_processed <span class="sc">|&gt;</span></span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, sector_id, to_node, Industry, unit, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>))</span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-122"><a href="#cb23-122" aria-hidden="true" tabindex="-1"></a>extra_data_production_processed_2030_2050 <span class="ot">&lt;-</span> extra_data_production_processed <span class="sc">|&gt;</span></span>
<span id="cb23-123"><a href="#cb23-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, sector_id, to_node, unit, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>))</span>
<span id="cb23-124"><a href="#cb23-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-125"><a href="#cb23-125" aria-hidden="true" tabindex="-1"></a>extra_data_production_processed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 78 × 28
   country_code sector    commodity indicator unit  value  conv value_conv  year
   &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 CH           cement    cement    product … kt_yr  3560    NA      3560   2024
 2 CH           fertilis… ammonia   product … kt_yr    14     1        17   2023
 3 CH           steel     steel-pr… capacity  kt_yr     0     1         0   2018
 4 CH           steel     steel-se… product … kt_yr  1314    NA      1314   2024
 5 CH           glass     glass-co… product … kt_yr   169    NA       169   2023
 6 CH           glass     glass-fi… product … kt_yr     0    NA         0   2025
 7 CH           glass     glass-fl… product … kt_yr     0    NA         0   2025
 8 CH           chemical  olefins   product … kt_yr     0    NA         0   2026
 9 CH           refineri… light li… capacity  kt_yr  3230     1      2061.  2025
10 NO           cement    cement    product … kt_yr  1700    NA      1700   2025
# ℹ 68 more rows
# ℹ 19 more variables: latest_year &lt;chr&gt;, source1 &lt;chr&gt;, source2 &lt;chr&gt;,
#   comments &lt;chr&gt;, ...14 &lt;lgl&gt;, has_latest &lt;lgl&gt;, sector_id &lt;chr&gt;,
#   to_node &lt;chr&gt;, Industry &lt;chr&gt;, production_factor_2018 &lt;dbl&gt;, `2018o` &lt;dbl&gt;,
#   production_factor_2030 &lt;dbl&gt;, `2030o` &lt;dbl&gt;, production_factor_2050 &lt;dbl&gt;,
#   `2050o` &lt;dbl&gt;, useful_energy_per_capacity &lt;dbl&gt;, `2018` &lt;dbl&gt;,
#   `2030` &lt;dbl&gt;, `2050` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="production" class="level2">
<h2 class="anchored" data-anchor-id="production">Production</h2>
<section id="production-volume-at-nuts0" class="level3">
<h3 class="anchored" data-anchor-id="production-volume-at-nuts0">Production volume at nuts0</h3>
<p>Aggregated product flow information at national level (nuts0).<br>
Important remarks:<br>
- For the reference year (2018), reference production routes and product flow are mapped. For future years, only product flow is mentioned<br>
- The AIDRES 2.0 database contains in the Belgian Antwerp area both an INEOS ethane cracker and a TotalEnergies steam cracker, but they, respectively, open in 2026 and close in 2027. Therefore, we do the following:<br>
- INEOS ethane cracker (BE211) operational in 2026: 1909 kt/y * 0.84 –&gt; this production volume is subtracted from 2018<br>
- TOA cracker (BE211) closure in 2027: 2273 kt/y * 0.84 –&gt; this production volume is subtracted from 2030 and 2050<br>
- Data for Switzerland, UK and Norway is added for nuts0 level, but is not available on nuts3 level<br>
- The default reference year is 2018 (in line with the original AIDRES database). However, when data has been updated, more recent years apply. This holds particularly for the Netherlands and Belgium, for the non-EU27 countries Switzerland, Norway and UK, and for sectors added from JRC-IDEES</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario_id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, mix_2018<span class="sc">:</span>mix_2050), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, configuration), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'product_id'</span> <span class="sc">==</span> <span class="st">'product_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((is_reference_route <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span> (product_id <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> (configuration <span class="sc">==</span> <span class="st">'EU-mix-2030'</span> <span class="sc">|</span> configuration <span class="sc">==</span> <span class="st">'EU-mix-2050'</span>))) <span class="sc">|&gt;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, product, configuration, product_flow_kt_y, horizon, nuts3, is_reference_route, conversion_factor) <span class="sc">|&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_id =</span> sector) <span class="sc">|&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">product_id =</span> product) <span class="sc">|&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nuts3) <span class="sc">|&gt;</span> </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(product_id, horizon, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_route_name'</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_factor'</span> <span class="ot">=</span> conversion_factor) <span class="sc">|&gt;</span> </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'year'</span> <span class="ot">=</span> horizon) <span class="sc">|&gt;</span> </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'is_ref_route'</span> <span class="ot">=</span> is_reference_route) <span class="sc">|&gt;</span> </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector_id, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'Industry'</span> <span class="ot">=</span> production_route_name,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">'to_node'</span> <span class="ot">=</span> product_id)  <span class="ot">-&gt;</span> aidres_production_country_temp</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>aidres_production_country_temp <span class="sc">|&gt;</span> </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, to_node, Industry, year) <span class="sc">|&gt;</span> </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production =</span> <span class="fu">sum</span>(product_flow_kt_y), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'kt_y'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, unit, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>      country_code <span class="sc">==</span> <span class="st">"BE"</span> <span class="sc">&amp;</span> to_node <span class="sc">==</span> <span class="st">"chemical-olefins"</span> <span class="sc">~</span> production <span class="sc">-</span> <span class="dv">1909</span>,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> production)) <span class="ot">-&gt;</span> aidres_production_country_2018year</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>aidres_production_country_temp <span class="sc">|&gt;</span> </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, to_node, year) <span class="sc">|&gt;</span> </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production =</span> <span class="fu">sum</span>(product_flow_kt_y), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'kt_y'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, unit, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>      country_code <span class="sc">==</span> <span class="st">"BE"</span> <span class="sc">&amp;</span> to_node <span class="sc">==</span> <span class="st">"chemical-olefins"</span> <span class="sc">~</span> production <span class="sc">-</span> <span class="dv">2273</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> production)) <span class="ot">-&gt;</span>  aidres_production_country_allyear</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion from kt LLF to MWh LLF (approximately 42.87 MJ/kg = 11.92 MWh/ton)</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: https://www.engineeringtoolbox.com/fossil-fuels-energy-content-d_1298.html</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>aidres_production_country_2018year <span class="sc">|&gt;</span> </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.double</span>(year)) <span class="sc">|&gt;</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(production <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> production) <span class="sc">|&gt;</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(extra_data_production_processed_2018) <span class="sc">|&gt;</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2018</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value<span class="sc">*</span><span class="fl">11.92</span><span class="sc">*</span><span class="dv">1000</span>,<span class="dv">3</span>),</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'mwh_yr'</span>,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> <span class="st">'kt_yr'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Industry =</span> <span class="fu">case_when</span>(to_node <span class="sc">==</span> <span class="st">'glass-container'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gco'</span>),</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-fibre'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfi'</span>),</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-float'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfl'</span>),</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Industry)) <span class="sc">|&gt;</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value) <span class="ot">-&gt;</span> prod_vol_cap_2018year</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 264 × 6
   country_code sector_id  to_node                Industry    unit       `2018`
   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
 1 AT           cement     cement                 EU-mix-2018 kt_yr      4214. 
 2 AT           chemical   chemical-PE            (NG)PE      kt_yr        94.3
 3 AT           chemical   chemical-PEA           (NG)PEA     kt_yr       130. 
 4 AT           chemical   chemical-olefins       (LN)O       kt_yr      1273. 
 5 AT           fertiliser fertiliser-ammonia-NH3 (NG)NH3     kt_yr       383. 
 6 AT           glass      glass-container        (NG)_gco    kt_yr       577. 
 7 AT           refineries HC                     REF-SMR     mwh_yr 73768112  
 8 AT           steel      steel-primary          BF-BOF      kt_yr      6177  
 9 AT           steel      steel-secondary        Scraps_EAF  kt_yr       708. 
10 BE           cement     cement                 EU-mix-2018 kt_yr      5538. 
# ℹ 254 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>aidres_production_country_allyear <span class="ot">&lt;-</span> aidres_production_country_allyear <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.double</span>(year)) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(production <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> production) <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(extra_data_production_processed_2030_2050) <span class="sc">|&gt;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2030</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value<span class="sc">*</span><span class="fl">11.92</span><span class="sc">*</span><span class="dv">1000</span>,<span class="dv">3</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'mwh_yr'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">.default =</span> <span class="st">'kt_yr'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value)<span class="ot">-&gt;</span>prod_vol_cap_allyear</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 264 × 6
   country_code sector_id  to_node                unit       `2030`     `2050`
   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           cement     cement                 kt_yr      4214.      4214. 
 2 AT           chemical   chemical-PE            kt_yr        94.3       94.3
 3 AT           chemical   chemical-PEA           kt_yr       130.       130. 
 4 AT           chemical   chemical-olefins       kt_yr      1273.      1273. 
 5 AT           fertiliser fertiliser-ammonia-NH3 kt_yr       383.       383. 
 6 AT           glass      glass-container        kt_yr       577.       577. 
 7 AT           refineries HC                     mwh_yr 62053736.  21569796. 
 8 AT           steel      steel-primary          kt_yr      6177       6177  
 9 AT           steel      steel-secondary        kt_yr       708.       708. 
10 BE           cement     cement                 kt_yr      5538.      5538. 
# ℹ 254 more rows</code></pre>
</div>
</div>
</section>
<section id="production-volume-at-nuts3" class="level3">
<h3 class="anchored" data-anchor-id="production-volume-at-nuts3">Production volume at nuts3</h3>
<p>Aggregated product flow information at nuts3 level.<br>
Important remarks:<br>
- For the reference year (2018), reference production routes and product flow are mapped. For future years, only product flow is mentioned<br>
- The AIDRES 2.0 database contains in the Belgian Antwerp area both an INEOS ethane cracker and a TotalEnergies steam cracker, but they, respectively, open in 2026 and close in 2027. Therefore, we do the following:<br>
- INEOS ethane cracker (BE211) operational in 2026: 1909 kt/y * 0.84 –&gt; this production volume is subtracted from 2018<br>
- TOA cracker (BE211) closure in 2027: 2273 kt/y * 0.84 –&gt; this production volume is subtracted from 2030 and 2050<br>
- Data for Switzerland, UK and Norway is added for nuts0 level, but is not available on nuts3 level<br>
- The default reference year is 2018 (in line with the original AIDRES database). However, when data has been updated, more recent years apply. This holds particularly for the Netherlands and Belgium, for the non-EU27 countries Switzerland, Norway and UK, and for sectors added from JRC-IDEES</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>aidres_2_0_results <span class="sc">|&gt;</span> <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario_id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(configuration_id, mix_2018<span class="sc">:</span>mix_2050), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_configurations <span class="sc">|&gt;</span><span class="fu">select</span>(configuration_id, configuration), <span class="at">by =</span><span class="fu">join_by</span>(<span class="st">'configuration_id'</span> <span class="sc">==</span> <span class="st">'configuration_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_sectors, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'sector_id'</span> <span class="sc">==</span> <span class="st">'sector_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aidres_2_0_products, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'product_id'</span> <span class="sc">==</span> <span class="st">'product_id'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((is_reference_route <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">12</span> <span class="sc">&amp;</span> product_id <span class="sc">!=</span> <span class="dv">13</span>) <span class="sc">|</span> (product_id <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> (configuration <span class="sc">==</span> <span class="st">'EU-mix-2030'</span> <span class="sc">|</span> configuration <span class="sc">==</span> <span class="st">'EU-mix-2050'</span>))) <span class="sc">|&gt;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, product, configuration, product_flow_kt_y, horizon, nuts3, is_reference_route, conversion_factor) <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_id =</span> sector) <span class="sc">|&gt;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">product_id =</span> product) <span class="sc">|&gt;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nuts3) <span class="sc">|&gt;</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(product_id, horizon, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prod_cap_kt_y =</span> product_flow_kt_y <span class="sc">/</span> conversion_factor) <span class="sc">|&gt;</span> </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_route_name'</span> <span class="ot">=</span> configuration) <span class="sc">|&gt;</span> </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'production_factor'</span> <span class="ot">=</span> conversion_factor) <span class="sc">|&gt;</span> </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'year'</span> <span class="ot">=</span> horizon) <span class="sc">|&gt;</span> </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'is_ref_route'</span> <span class="ot">=</span> is_reference_route) <span class="sc">|&gt;</span> </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nuts3, sector_id, product_id, production_route_name, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(nuts3, <span class="fu">c</span>(<span class="at">country_code =</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="at">nuts_id =</span><span class="dv">2</span>), <span class="at">cols_remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector_id =</span> <span class="fu">tolower</span>(sector_id)) <span class="sc">|&gt;</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>nuts_id) <span class="ot">-&gt;</span> aidres_production_country_temp_nuts3</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>aidres_production_country_temp_nuts3 <span class="sc">|&gt;</span> </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, nuts3, sector_id, product_id, production_route_name, year) <span class="sc">|&gt;</span> </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production =</span> <span class="fu">sum</span>(product_flow_kt_y),</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">production_cap =</span> <span class="fu">sum</span>(prod_cap_kt_y), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'kt_y'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'Industry'</span> <span class="ot">=</span> production_route_name,</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">'to_node'</span> <span class="ot">=</span> product_id) <span class="sc">|&gt;</span> </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, unit, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="sc">|&gt;</span> </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>production_cap) <span class="sc">|&gt;</span> </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    nuts3 <span class="sc">==</span> <span class="st">"BE211"</span> <span class="sc">&amp;</span> to_node <span class="sc">==</span> <span class="st">"chemical-olefins"</span> <span class="sc">~</span> production <span class="sc">-</span> <span class="dv">1909</span>,</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> production)) <span class="sc">|&gt;</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> production) <span class="sc">|&gt;</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2018</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value<span class="sc">*</span><span class="fl">11.92</span><span class="sc">*</span><span class="dv">1000</span>,<span class="dv">3</span>),</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'mwh_yr'</span>,</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> <span class="st">'kt_yr'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Industry =</span> <span class="fu">case_when</span>(to_node <span class="sc">==</span> <span class="st">'glass-container'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gco'</span>),</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-fibre'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfi'</span>),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>                              to_node <span class="sc">==</span> <span class="st">'glass-float'</span><span class="sc">~</span> <span class="fu">paste0</span>(Industry, <span class="st">'_gfl'</span>),</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Industry)) <span class="sc">|&gt;</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value) <span class="ot">-&gt;</span> prod_vol_cap_2018year_nuts3</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_nuts3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 871 × 7
   country_code nuts3 sector_id  to_node          Industry    unit       `2018`
   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
 1 AT           AT121 glass      glass-container  (NG)_gco    kt_yr       192. 
 2 AT           AT122 cement     cement           EU-mix-2018 kt_yr       449. 
 3 AT           AT124 chemical   chemical-PE      (NG)PE      kt_yr        47.2
 4 AT           AT124 chemical   chemical-PEA     (NG)PEA     kt_yr        43.4
 5 AT           AT127 cement     cement           EU-mix-2018 kt_yr       932. 
 6 AT           AT127 chemical   chemical-PE      (NG)PE      kt_yr        47.2
 7 AT           AT127 chemical   chemical-PEA     (NG)PEA     kt_yr        43.4
 8 AT           AT127 chemical   chemical-olefins (LN)O       kt_yr      1273. 
 9 AT           AT127 refineries HC               REF-SMR     mwh_yr 73768112  
10 AT           AT213 cement     cement           EU-mix-2018 kt_yr       674. 
# ℹ 861 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>aidres_production_country_temp_nuts3 <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, nuts3, sector_id, product_id, year) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">production =</span> <span class="fu">sum</span>(product_flow_kt_y),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">production_cap =</span> <span class="fu">sum</span>(prod_cap_kt_y), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'kt_y'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'to_node'</span> <span class="ot">=</span> product_id) <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, unit, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>production_cap) <span class="sc">|&gt;</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">production =</span> <span class="fu">case_when</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    nuts3 <span class="sc">==</span> <span class="st">"BE211"</span> <span class="sc">&amp;</span> to_node <span class="sc">==</span> <span class="st">"chemical-olefins"</span> <span class="sc">~</span> production <span class="sc">-</span> <span class="dv">2273</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> production)) <span class="sc">|&gt;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> production) <span class="sc">|&gt;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span><span class="sc">~</span> <span class="st">'HC'</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> to_node)) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2030</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">'year'</span>, <span class="at">values_to =</span> <span class="st">'value'</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="fu">round</span>(value<span class="sc">*</span><span class="fl">11.92</span><span class="sc">*</span><span class="dv">1000</span>,<span class="dv">3</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> value)) <span class="sc">|&gt;</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">case_when</span>(sector_id <span class="sc">==</span> <span class="st">'refineries'</span> <span class="sc">~</span> <span class="st">'mwh_yr'</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.default =</span> <span class="st">'kt_yr'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> value)<span class="ot">-&gt;</span>prod_vol_cap_allyear_nuts3</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_nuts3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 871 × 7
   country_code nuts3 sector_id  to_node          unit       `2030`     `2050`
   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 AT           AT121 glass      glass-container  kt_yr       192.       192. 
 2 AT           AT122 cement     cement           kt_yr       449.       449. 
 3 AT           AT124 chemical   chemical-PE      kt_yr        47.2       47.2
 4 AT           AT124 chemical   chemical-PEA     kt_yr        43.4       43.4
 5 AT           AT127 cement     cement           kt_yr       932.       932. 
 6 AT           AT127 chemical   chemical-PE      kt_yr        47.2       47.2
 7 AT           AT127 chemical   chemical-PEA     kt_yr        43.4       43.4
 8 AT           AT127 chemical   chemical-olefins kt_yr      1273.      1273. 
 9 AT           AT127 refineries HC               mwh_yr 62053736.  21569796. 
10 AT           AT213 cement     cement           kt_yr       674.       674. 
# ℹ 861 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="life" class="level2">
<h2 class="anchored" data-anchor-id="life">Life</h2>
<p>AIDRES assumes a generic 40 year lifetime for technologies.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>extra_data_processes <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">==</span> <span class="st">'life'</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'sector_id'</span>, <span class="st">'Industry'</span>, <span class="st">'to_node'</span>, <span class="st">'unit'</span>, <span class="st">'2030'</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'life'</span> <span class="ot">=</span> <span class="st">'2030'</span>) <span class="ot">-&gt;</span> extra_data_life_filtered</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">2025</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">2050</span><span class="st">`</span>, costs)) <span class="sc">|&gt;</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="st">'yr'</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">life =</span> <span class="dv">40</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Industry <span class="sc">%in%</span> extra_data_life_filtered<span class="sc">$</span>Industry)<span class="sc">|&gt;</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(extra_data_life_filtered) <span class="sc">|&gt;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(Industry <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(H2)MeOH-DC"</span>, <span class="st">"(BM)MeOH"</span>, <span class="st">"(COEL)MeOH-MEA"</span>), <span class="st">"HC-MeOH"</span>, to_node)) <span class="sc">|&gt;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">if_else</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fertiliser-ammonia"</span>), <span class="st">"fertiliser-ammonia-NH3"</span>, to_node)) <span class="ot">-&gt;</span> life_prodroute_all</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>life_prodroute_all</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 5
   sector_id Industry           to_node unit   life
   &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;
 1 cement    EU-mix-2018        cement  yr       40
 2 cement    CEM2-(Coal)        cement  yr       40
 3 cement    CEM2-(Coal)CaL     cement  yr       40
 4 cement    CEM2-(Coal)Oxy-CaL cement  yr       40
 5 cement    CEM2-(Afm)         cement  yr       40
 6 cement    CEM2-(Afm)MEA      cement  yr       40
 7 cement    CEM2-(Afm)CaL      cement  yr       40
 8 cement    CEM2-(Afm)Oxy-CaL  cement  yr       40
 9 cement    CEM2-(BMW)         cement  yr       40
10 cement    CEM2-(BMW)MEA      cement  yr       40
# ℹ 71 more rows</code></pre>
</div>
</div>
</section>
<section id="get-chlorine-production-data-and-add-to-technology-catalogue" class="level2">
<h2 class="anchored" data-anchor-id="get-chlorine-production-data-and-add-to-technology-catalogue">Get chlorine production data and add to technology catalogue</h2>
<p>Get chlorine production data from the Eurochlor excel (/input_data/eurochlor_data/chlorine_data_2018.xlsx) and add to the technology catalogue. The site coordinates (/input_data/eurochlor_data/chlorine_sites_coordinates.csv) are used to determine the nuts3 code.</p>
<p>Important remark:<br>
- A utilization factor of 0.688 is used for chlorine (= utilization factor of first half 2025, https://www.eurochlor.org/news/november-2025-chlorine-production/))</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>country_codes <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'europe_country_codes'</span>, <span class="st">'europe_country_code.xlsx'</span>), <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>country_codes_extended <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  country_codes,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"Norway"</span>, <span class="st">"UK"</span>, <span class="st">"Switzerland"</span>), <span class="at">country_iso_code =</span> <span class="fu">c</span>(<span class="st">"NO"</span>, <span class="st">"UK"</span>, <span class="st">"Ch"</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'eurochlor_data'</span>, <span class="st">'chlorine_data_2018.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'Sheet2'</span>, <span class="at">range =</span> <span class="st">'A1:H67'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(country_codes_extended, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'country'</span> <span class="sc">==</span> <span class="st">'country'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_iso_code, country, company, site, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_iso_code)) <span class="sc">|&gt;</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thousand_tonnes) <span class="sc">|&gt;</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> murcury<span class="sc">:</span>other, <span class="at">names_to =</span> <span class="st">'production_routes'</span>, <span class="at">values_to =</span> <span class="st">'kt'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kt =</span> <span class="fu">replace_na</span>(kt, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_iso_code , country, company, site) <span class="sc">|&gt;</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">kt =</span> <span class="fu">sum</span>(<span class="fu">cbind</span>(kt)))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>chlorine_coordinates <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'eurochlor_data'</span>, <span class="st">"chlorine_sites_coordinates.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">clean_names</span>()</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018_with_coordinates <span class="ot">&lt;-</span> <span class="fu">left_join</span>(chlorine_data_2018, chlorine_coordinates, <span class="at">by =</span> <span class="fu">join_by</span>(country <span class="sc">==</span> country, site <span class="sc">==</span> site, company <span class="sc">==</span> company))</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018_with_coordinates_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(chlorine_data_2018_with_coordinates, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Download NUTS layers</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>nuts3 <span class="ot">&lt;-</span> <span class="fu">gisco_get_nuts</span>(<span class="at">nuts_level =</span> <span class="dv">3</span>, <span class="at">year =</span> <span class="dv">2016</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>nuts0 <span class="ot">&lt;-</span> <span class="fu">gisco_get_nuts</span>(<span class="at">nuts_level =</span> <span class="dv">0</span>, <span class="at">year =</span> <span class="dv">2016</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nuts3</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>chlorine_data_2018_with_coordinates_sf <span class="ot">&lt;-</span> chlorine_data_2018_with_coordinates_sf <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(nuts3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(NUTS_ID), <span class="at">left =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nuts3 =</span> NUTS_ID) <span class="sc">%&gt;%</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(nuts0 <span class="sc">%&gt;%</span> <span class="fu">select</span>(NUTS_ID), <span class="at">left =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nuts0 =</span> NUTS_ID)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Fallback for missing nuts3</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>missing_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(chlorine_data_2018_with_coordinates_sf<span class="sc">$</span>nuts3))</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  nearest_idx <span class="ot">&lt;-</span> <span class="fu">st_nearest_feature</span>(</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    chlorine_data_2018_with_coordinates_sf[missing_idx, ],</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    nuts3</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  chlorine_data_2018_with_coordinates_sf<span class="sc">$</span>nuts3[missing_idx] <span class="ot">&lt;-</span> nuts3<span class="sc">$</span>NUTS_ID[nearest_idx]</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>chlorine_data <span class="ot">&lt;-</span> chlorine_data_2018_with_coordinates_sf</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span><span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_data<span class="sc">$</span>kt<span class="sc">*</span><span class="fl">0.688</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span><span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_data<span class="sc">$</span>kt<span class="sc">*</span><span class="fl">0.688</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_data<span class="sc">$</span>kt<span class="sc">*</span><span class="fl">0.688</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span>unit <span class="ot">&lt;-</span> <span class="st">"kt_yr"</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span>to_node <span class="ot">&lt;-</span> <span class="st">"chemical-chlorine"</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span>sector_id <span class="ot">&lt;-</span> <span class="st">"chemical"</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span>country_code <span class="ot">&lt;-</span> chlorine_data<span class="sc">$</span>country_iso_code</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>chlorine_data<span class="sc">$</span>Industry <span class="ot">&lt;-</span> <span class="st">"Diaphragm"</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>chlorine_production_2018_nuts3 <span class="ot">&lt;-</span> chlorine_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, nuts3, sector_id, to_node, Industry, unit, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>()</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>chlorine_production_2018_nuts0 <span class="ot">&lt;-</span> chlorine_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, sector_id, to_node, Industry, unit, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, to_node, Industry, unit) <span class="sc">%&gt;%</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">2018</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>chlorine_production_2030_2050_nuts3 <span class="ot">&lt;-</span> chlorine_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, nuts3, sector_id, to_node, unit, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>()</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>chlorine_production_2030_2050_nuts0 <span class="ot">&lt;-</span> chlorine_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code, sector_id, to_node, unit, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code, sector_id, to_node, unit) <span class="sc">%&gt;%</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">2050</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_nuts3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_2018year_nuts3, chlorine_production_2018_nuts3)</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_nuts3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_allyear_nuts3, chlorine_production_2030_2050_nuts3)</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_2018year, chlorine_production_2018_nuts0)</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_allyear, chlorine_production_2030_2050_nuts0)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="get-chlorine-production-route-and-add-to-technology-catalogue" class="level2">
<h2 class="anchored" data-anchor-id="get-chlorine-production-route-and-add-to-technology-catalogue">Get chlorine production route and add to technology catalogue</h2>
<p>Retrieve the data for the chlorine production route (diaphragm cell technology) from ‘/input_data/eurochlor_data/chlorine_route.xlsx’ and incorporate it into the technology catalogue. For the cost parameters and technology lifetime, the values from our TIMES-Belgium model are applied. All remaining parameters are sourced from the document “EPOC – Chemical Sector Decarbonization” available at: https://www.epocbelgium.be/sites/epoc/files/Chlorine_FactSheet_TaliehRajabloo.pdf.</p>
<p>Important remark:<br>
- Although several chlorine production processes exist, diaphragm cell technology is the most widely used. Therefore, the diaphragm-based production route has been added to the technology catalogue.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>chlorine_process <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">'input_data'</span>, <span class="st">'eurochlor_data'</span>, <span class="st">'chlorine_route.xlsx'</span>), <span class="at">sheet =</span> <span class="st">'Sheet1'</span>, <span class="at">range =</span> <span class="st">'B1:J3'</span>)[<span class="sc">-</span><span class="dv">1</span>, ] </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot <span class="ot">&lt;-</span> chlorine_process<span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(CAPEX, OPEX, <span class="st">`</span><span class="at">CO2 direct emissions</span><span class="st">`</span>, <span class="st">`</span><span class="at">CO2 capture</span><span class="st">`</span>, electricity, natural_gas, lifetime, hydrogen_by_product),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as.numeric</span>(value),      <span class="co"># Convert all values to numeric</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)         <span class="co"># Round to 2 decimals</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"electricity"</span> <span class="sc">~</span> <span class="st">"elec"</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"natural_gas"</span> <span class="sc">~</span> <span class="st">"CH4"</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"CO2 capture"</span> <span class="sc">~</span> <span class="st">"co2_capture"</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"CO2 direct emissions"</span> <span class="sc">~</span> <span class="st">"co2_emission"</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"CAPEX"</span> <span class="sc">~</span> <span class="st">"capex"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"OPEX"</span> <span class="sc">~</span> <span class="st">"fom"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span>to_node <span class="ot">&lt;-</span> <span class="st">"chemical-chlorine"</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span>sector_id <span class="ot">&lt;-</span> <span class="st">"chemical"</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span>Industry <span class="ot">&lt;-</span> <span class="st">"Diaphragm"</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span><span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_process_unpivot<span class="sc">$</span>value</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span><span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_process_unpivot<span class="sc">$</span>value</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span><span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_process_unpivot<span class="sc">$</span>value</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>chlorine_process_unpivot<span class="sc">$</span><span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">&lt;-</span> chlorine_process_unpivot<span class="sc">$</span>value</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_sec <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, variable, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>,  <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"elec"</span>, <span class="st">"CH4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_node =</span> variable)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_sec<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'mwh_t'</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_route_life <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, value, variable) <span class="sc">%&gt;%</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"lifetime"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>variable) <span class="sc">%&gt;%</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">life =</span> value)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_route_life<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'yr'</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_co2_capture <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, variable, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>,  <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"co2_capture"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">emission =</span> variable)</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_co2_capture<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'tco2_t'</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_co2_emission <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, variable, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>,  <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"co2_emission"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">emission =</span> variable)</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_co2_emission<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'tco2_t'</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_capex <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, variable, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>,  <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"capex"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">costs =</span> variable)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_capex<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'eur-yr_t'</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_fom <span class="ot">&lt;-</span> chlorine_process_unpivot <span class="sc">%&gt;%</span> <span class="fu">select</span>(sector_id, to_node, Industry, variable, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>,  <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fom"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">costs =</span> variable)</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>chlorine_ind_process_routes_fom<span class="sc">$</span>unit <span class="ot">=</span> <span class="st">'eur_t'</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sec_perton_all,chlorine_ind_process_routes_sec)</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>life_prodroute_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(life_prodroute_all,chlorine_ind_process_route_life) </span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_capture_perton_all,chlorine_ind_process_routes_co2_capture)</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_emission_perton_all,chlorine_ind_process_routes_co2_emission)</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_capex_perton_all,chlorine_ind_process_routes_capex)</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_fom_perton_all,chlorine_ind_process_routes_fom)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="add-production-production-route-and-co2-emission-data-for-non-aidres-sectors" class="level1">
<h1>Add production, production route and CO2 emission data for non-AIDRES sectors</h1>
<p>The production volume, production route and CO2 emission data for the following products is extracted from JRC‑IDEES-2023 (reference year 2021):<br>
- food, beverages and tobacco<br>
- alumina<br>
- primary aluminium<br>
- secondary aluminium<br>
- other non-ferrous metals<br>
- ceramics and other non-metallic minerals<br>
- paper<br>
- printing and media<br>
- pulp<br>
- leather and textile<br>
- transport equipment - machinery equipment<br>
- wood and wood products<br>
- other industrial sectors<br>
- other chemicals<br>
- pharmaceuticals</p>
<p>For the following products, useful energy (in MWh) is used as production volume unit instead of the ‘production index’ used in JRC-IDEES:<br>
- food, beverages and tobacco<br>
- leather and textile<br>
- transport equipment<br>
- machinery equipment<br>
- wood and wood products<br>
- other industrial sectors</p>
<p>The JRC‑IDEES data extraction and pre-processing is done by the ‘jrc idees processing.py’ script in the ‘JRC idees processing python’ folder:<br>
- The production volume data is extracted from the main tabs of the JRC‑IDEES files (e.g.&nbsp;NMM, PPA …)<br>
- The production route’s specific energy consumption is extracted from the ’_fec’ tabs of the JRC‑IDEES files (e.g.&nbsp;NMM_fec, PPA_fec …)<br>
- The production route useful energy data is extracted from the ’_ued’ tabs of the JRC‑IDEES files (e.g.&nbsp;NMM_ued, PPA_ued …)<br>
- The CO2 emission data is extracted from the ’_emi’ tabs of the JRC idees files (e.g.&nbsp;NMM_emi, PPA_emi …)</p>
<p>To define common (not country-specific) reference production routes, the following parameters are calculated for each product: - average (over all countries) of ‘energy use per unit of production’ for every energy carrier - average (over all countries) of ‘emissions per unit of production’</p>
<p>For the reference production routes, the following mapping is used to map the energy carriers in JRC‑IDEES to the energy carriers used in the energy balance (for the gap analysis) and the technology catalogue (‘JRC-idees carrier’: ‘energy balance carrier’-‘technology catalogue carrier’):<br>
- ‘Solar and geothermal’: ‘heat’-‘elec’ (see remark below)<br>
- ‘Electricity’: ‘electricity’-‘elec’<br>
- ‘LPG’: ‘oil_petro_products’-‘HC’<br>
- ‘Diesel oil and liquid biofuels’: ‘oil_petro_products’-‘HC’<br>
- ‘Diesel oil’: ‘oil_petro_products’-‘HC’<br>
- ‘Naphtha’: ‘oil_petro_products’-‘HC’<br>
- ‘Natural gas and biogas’: ‘natural_gas’-‘CH4’<br>
- ‘Natural gas’: ‘natural_gas’-‘CH4’<br>
- ‘Solids’: ‘solid_fossil_fuels’-‘coal’<br>
- ‘Refinery gas’: ‘oil_petro_products’-‘HC’<br>
- ‘Fuel oil’: ‘oil_petro_products’-‘HC’<br>
- ‘Other liquids’: ‘oil_petro_products’-‘HC’<br>
- ‘Derived gases’: ‘solid_fossil_fuels’-‘coal’<br>
- ‘Biomass and waste’: ‘renew_bio’-‘bio’<br>
- ‘Distributed steam’: ‘steam’-‘elec’ or ‘CH4’ (see remark below)<br>
- ‘Ambient heat’: ‘heat’-‘elec’<br>
- ‘Coke’: ‘solid_fossil_fuels’-‘coal’</p>
<p>Remark:<br>
- steam and heat are provided by either electricity or natural gas, depending on the temperature needed<br>
- derived gases are assumed to be provided by coal as a part of conventional steel production</p>
<p>For every product, also an alternative future production route is constructed via energy carrier substitution. To replace an energy carrier by an alternative energy carrier, we multiply the final energy consumption by the efficiency associated with the original energy carrier, and divide by the energy efficiency of associated with the alternative energy carrier. E.g. part of ‘Food: Oven (direct heat)’ is done electrically in JRC-IDEES, but another part uses Diesel oil and liquid biofuels, and Natural gas and biogas. In the alternative route, all ‘Food: Oven (direct heat)’ will be done electrically, where the existing energy efficiencies in JRC-IDEES are used for the conversion. In case of low temperature heat (&lt; 150 °C), we use the efficiency of an industrial heat pump to provide the heat with an efficiency of 285% (= average of Danish technology catalogue: https://ens.dk/en/analyses-and-statistics/technology-data-industrial-process-heat).</p>
<p>Three alternative energy carriers are defined: methane, electricity powering a heat pump, and conventional electricity use. The following mapping is used to map JRC-IDEES processes under the ’_fec’ tabs to an alternative energy carrier for the alternative production route:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Sector</th>
<th>Product</th>
<th>Methane</th>
<th>Electricity (heat pump)</th>
<th>Electricity (conventional)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Generic</td>
<td>Low-enthalpy heat</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Iron and steel</td>
<td>Steel: Furnaces, refining and rolling</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Iron and steel</td>
<td>Steel: Product finishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-ferrous metals</td>
<td>Alumina production: High-enthalpy heat</td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Non-ferrous metals</td>
<td>Alumina production: Refining</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-ferrous metals</td>
<td>Aluminium electrolysis (smelting)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Non-ferrous metals</td>
<td>Aluminium processing (metallurgy e.g.&nbsp;cast house, reheating)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-ferrous metals</td>
<td>Aluminium finishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Non-ferrous metals</td>
<td>Secondary aluminium (incl.&nbsp;pre-treatment, remelting)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-ferrous metals</td>
<td>Other Metals: production</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Non-ferrous metals</td>
<td>Metal processing (metallurgy e.g.&nbsp;cast house, reheating)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-ferrous metals</td>
<td>Metal finishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Chemical industry</td>
<td>Chemicals: High-enthalpy heat processing</td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>Chemical industry</td>
<td>Chemicals: Furnaces</td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Chemical industry</td>
<td>Chemicals: Process cooling</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Non-metallic mineral products</td>
<td>Ceramics: Mixing of raw material</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Non-metallic mineral products</td>
<td>Ceramics: Drying and sintering of raw material</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Non-metallic mineral products</td>
<td>Ceramics: Primary production process</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Non-metallic mineral products</td>
<td>Ceramics: Product finishing</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Pulp, paper and printing</td>
<td>Pulp: Wood preparation, grinding</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Pulp, paper and printing</td>
<td>Pulp: Pulping</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Pulp, paper and printing</td>
<td>Pulp: Cleaning</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Pulp, paper and printing</td>
<td>Paper: Stock preparation</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Pulp, paper and printing</td>
<td>Paper: Paper machine</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Pulp, paper and printing</td>
<td>Paper: Product finishing</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Pulp, paper and printing</td>
<td>Printing and publishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Food, beverages and tobacco</td>
<td>Food: Oven (direct heat)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Food, beverages and tobacco</td>
<td>Food: Specific process heat</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Food, beverages and tobacco</td>
<td>Food: Steam processing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Food, beverages and tobacco</td>
<td>Food: Drying</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Food, beverages and tobacco</td>
<td>Food: Process cooling and refrigeration</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Food, beverages and tobacco</td>
<td>Food: Electric machinery</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Transport equipment</td>
<td>Trans. Eq.: Foundries</td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>Transport equipment</td>
<td>Trans. Eq.: Connection techniques</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Transport equipment</td>
<td>Trans. Eq.: Heat treatment</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Transport equipment</td>
<td>Trans. Eq.: Steam processing</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Transport equipment</td>
<td>Trans. Eq.: General machinery</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Transport equipment</td>
<td>Trans. Eq.: Product finishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Machinery equipment</td>
<td>Mach. Eq.: Foundries&nbsp;</td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>Machinery equipment</td>
<td>Mach. Eq.: Connection techniques</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Machinery equipment</td>
<td>Mach. Eq.: Heat treatment</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Machinery equipment</td>
<td>Mach. Eq.: Steam processing</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Machinery equipment</td>
<td>Mach. Eq.: General machinery</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Machinery equipment</td>
<td>Mach. Eq.: Product finishing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Textiles and leather</td>
<td>Textiles: Pretreatment with steam&nbsp;</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Textiles and leather</td>
<td>Textiles: Wet processing with steam</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Textiles and leather</td>
<td>Textiles: Electric general machinery</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Textiles and leather</td>
<td>Textiles: Drying</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Textiles and leather</td>
<td>Textiles: Finishing Electric</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Wood and wood products</td>
<td>Wood: Specific processes with steam</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Wood and wood products</td>
<td>Wood: Electric mechanical processes</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Wood and wood products</td>
<td>Wood: Drying</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Wood and wood products</td>
<td>Wood: Finishing Electric</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Steam processing</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Process heating</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="even">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Drying</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Process Cooling</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr class="even">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Diesel motors (incl.&nbsp;biofuels)</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Other industrial sectors</td>
<td>Other Industrial sectors: Electric machinery</td>
<td>-</td>
<td>-</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The CAPEX and OPEX for the alternative production routes are calculated by the ‘jrc idees processing.py’ script in the ‘JRC idees processing python’ folder. The CAPEX and OPEX are extracted from the Danish Technology Catalogue (https://ens.dk/en/analyses-and-statistics/technology-data-industrial-process-heat) for the following technologies:<br>
- electricity powering a heat pump -&gt; High-temperature heat pumps up to 150 °C<br>
- conventional electricity use -&gt; Electric boiler, 10 kV, steam, 1-12 bar<br>
- methane -&gt; Boiler, gas and oil</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>proces_energy_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"proces_energy_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 21 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, from_node, unit
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>proces_energy_new <span class="ot">&lt;-</span> proces_energy_new <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>, <span class="st">"from_node"</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>proces_energy_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"proces_energy_original.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 84 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, from_node, unit
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>proces_energy_original <span class="ot">&lt;-</span> proces_energy_original <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>, <span class="st">"from_node"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>production_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"production_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 432 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): country_code, sector_id, to_node, Industry, unit_capacity, unit
dbl (5): actual_capacity, conversion_production, actual_capacity_converted, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>production_new <span class="ot">&lt;-</span> production_new <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"country_code"</span>, <span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>production_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"production_original.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 432 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): country_code, sector_id, to_node, Industry, unit_capacity, unit
dbl (4): actual_capacity, conversion_production, actual_capacity_converted, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>production_original <span class="ot">&lt;-</span> production_original <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"country_code"</span>, <span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"Industry"</span>, <span class="st">"unit"</span>, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>CO2_emissions_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"CO2_emissions_original.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, emission
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions_original <span class="ot">&lt;-</span> CO2_emissions_original <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"Industry"</span>, <span class="st">"to_node"</span>, <span class="st">"emission"</span>, <span class="st">"unit"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>CO2_capture_original <span class="ot">&lt;-</span> CO2_emissions_original <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">emission =</span> <span class="st">"co2_capture"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>CO2_emissions_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"CO2_emissions_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, emission
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions_new <span class="ot">&lt;-</span> CO2_emissions_new <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"Industry"</span>, <span class="st">"to_node"</span>, <span class="st">"emission"</span>, <span class="st">"unit"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>CO2_capture_new <span class="ot">&lt;-</span> CO2_emissions_new <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">emission =</span> <span class="st">"co2_capture"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>lifetime_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"lifetime_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): sector_id, to_node, Industry, unit
dbl (1): life

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lifetime_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"lifetime_original.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): sector_id, to_node, Industry, unit
dbl (1): life

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>capex_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"capex_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, costs
dbl (8): 2025, 2030, 2040, 2050, 2025_sd, 2030_sd, 2040_sd, 2050_sd

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>capex_new <span class="ot">&lt;-</span> capex_new  <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, costs, unit, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>opex_new<span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"opex_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, costs
dbl (8): 2025, 2030, 2040, 2050, 2025_sd, 2030_sd, 2040_sd, 2050_sd

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>opex_new <span class="ot">&lt;-</span> opex_new  <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, costs, unit, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>steel_finishing_energy_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"steel_finishing_new_energy_out.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): sector_id, to_node, Industry, classification_1, from_node, unit
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>steel_finishing_energy_new <span class="ot">&lt;-</span> steel_finishing_energy_new  <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>, <span class="st">"from_node"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"steel_finishing_new_CO2_out.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): sector_id, to_node, Industry, classification_1, unit, emission
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_new <span class="ot">&lt;-</span> steel_finishing_CO2_new <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">emission =</span> <span class="st">"co2_emission"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_capture_new <span class="ot">&lt;-</span> steel_finishing_CO2_new <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">emission =</span> <span class="st">"co2_capture"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>steel_finishing_lifetime_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"lifetime_steel_finishing_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): sector_id, to_node, Industry, unit
dbl (1): life

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>steel_finishing_energy_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>,<span class="st">"steel_finishing_original_energy_out.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 16 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): sector_id, to_node, Industry, classification_1, from_node, unit
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>steel_finishing_energy_original <span class="ot">&lt;-</span> steel_finishing_energy_original <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>, <span class="st">"from_node"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>,<span class="st">"steel_finishing_original_CO2_out.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): sector_id, to_node, Industry, classification_1, unit, emission
dbl (5): 2025, std, 2030, 2040, 2050

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_original <span class="ot">&lt;-</span> steel_finishing_CO2_original <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"sector_id"</span>, <span class="st">"to_node"</span>, <span class="st">"unit"</span>, <span class="st">"Industry"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">emission =</span> <span class="st">"co2_emission"</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>steel_finishing_CO2_capture_original <span class="ot">&lt;-</span> steel_finishing_CO2_original <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">emission =</span> <span class="st">"co2_capture"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>steel_finishing_lifetime_original <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"lifetime_steel_finishing_original.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): sector_id, to_node, Industry, unit
dbl (1): life

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>capex_steel_new <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"capex_steel_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, costs
dbl (8): 2025, 2030, 2040, 2050, 2025_sd, 2030_sd, 2040_sd, 2050_sd

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>capex_steel_new <span class="ot">&lt;-</span> capex_steel_new  <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, costs, unit, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>opex_steel_new<span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"input_data/processed_jrc_idees_data"</span>, <span class="st">"opex_steel_new.csv"</span>), <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">"."</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): sector_id, to_node, Industry, unit, costs
dbl (8): 2025, 2030, 2040, 2050, 2025_sd, 2030_sd, 2040_sd, 2050_sd

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>opex_steel_new <span class="ot">&lt;-</span> opex_steel_new  <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector_id, Industry, to_node, costs, unit, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_2018year, production_original)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prod_vol_cap_allyear, production_new)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_capex_perton_all, capex_new)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_fom_perton_all, opex_new)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_capex_perton_all, capex_steel_new)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(costs_fom_perton_all, opex_steel_new)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sec_perton_all,proces_energy_original)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sec_perton_all,proces_energy_new)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sec_perton_all,steel_finishing_energy_new)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>sec_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sec_perton_all,steel_finishing_energy_original)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_emission_perton_all,CO2_emissions_original)</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_emission_perton_all,CO2_emissions_new)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_emission_perton_all,steel_finishing_CO2_new)</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_emission_perton_all,steel_finishing_CO2_original)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_capture_perton_all,CO2_capture_original)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_capture_perton_all,CO2_capture_new)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_capture_perton_all,steel_finishing_CO2_capture_new)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(emission_co2_capture_perton_all,steel_finishing_CO2_capture_original)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>life_prodroute_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(life_prodroute_all,lifetime_new) </span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>life_prodroute_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(life_prodroute_all,lifetime_original) </span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>life_prodroute_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(life_prodroute_all,steel_finishing_lifetime_new) </span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>life_prodroute_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(life_prodroute_all,steel_finishing_lifetime_original) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="writing-all-data-in-an-excel-workbook" class="level2">
<h2 class="anchored" data-anchor-id="writing-all-data-in-an-excel-workbook">writing all data in an excel workbook</h2>
<p>Save technology catalogue data to excel workbook.</p>
<section id="creating-output-directory" class="level3">
<h3 class="anchored" data-anchor-id="creating-output-directory">Creating output directory</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'outputs'</span>, <span class="st">'technology_catalogue'</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)){</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Output directory doesn't exist. Creating a new one!"</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_dir)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Output directory already exists. Not creating a new one!"</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Output directory already exists. Not creating a new one!"</code></pre>
</div>
</div>
</section>
<section id="writing-final-excel-workbook" class="level3">
<h3 class="anchored" data-anchor-id="writing-final-excel-workbook">Writing final Excel workbook</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">'ind_production_2018_nuts3'</span> <span class="ot">=</span> prod_vol_cap_2018year_nuts3,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts3'</span> <span class="ot">=</span> prod_vol_cap_allyear_nuts3,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_2018_nuts0'</span> <span class="ot">=</span> prod_vol_cap_2018year,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts0'</span> <span class="ot">=</span> prod_vol_cap_allyear,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_sec'</span> <span class="ot">=</span> sec_perton_all,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_route_life'</span> <span class="ot">=</span> life_prodroute_all, </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_capture'</span> <span class="ot">=</span> emission_co2_capture_perton_all,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_emission'</span> <span class="ot">=</span> emission_co2_emission_perton_all,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_capex'</span> <span class="ot">=</span> costs_capex_perton_all,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_fom'</span> <span class="ot">=</span> costs_fom_perton_all),</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">here</span>(output_dir, <span class="st">'technology_catalogue_ind_nuts0_nuts3.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="filter-out-all-data-except-hc-meoh-and-nh3-save-excel-file" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-all-data-except-hc-meoh-and-nh3-save-excel-file">Filter out all data except HC, MeOH and NH3 + save excel file</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out all data but HC, MeOH and NH3 from data + save in excel</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_nuts3_no_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_2018year_nuts3 <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_nuts3_no_HC_NH3  <span class="ot">&lt;-</span> prod_vol_cap_allyear_nuts3 <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_no_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_2018year <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_no_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_allyear <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>sec_perton_all_no_HC_NH3 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>life_prodroute_all_no_HC_NH3 <span class="ot">&lt;-</span> life_prodroute_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all_no_HC_NH3 <span class="ot">&lt;-</span> emission_co2_capture_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all_no_HC_NH3 <span class="ot">&lt;-</span> emission_co2_emission_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all_no_HC_NH3 <span class="ot">&lt;-</span> costs_capex_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all_no_HC_NH3 <span class="ot">&lt;-</span> costs_fom_perton_all <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>))</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">'ind_production_2018_nuts3'</span> <span class="ot">=</span> prod_vol_cap_2018year_nuts3_no_HC_NH3,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts3'</span> <span class="ot">=</span> prod_vol_cap_allyear_nuts3_no_HC_NH3,</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_2018_nuts0'</span> <span class="ot">=</span> prod_vol_cap_2018year_no_HC_NH3,</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts0'</span> <span class="ot">=</span> prod_vol_cap_allyear_no_HC_NH3,</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_sec'</span> <span class="ot">=</span> sec_perton_all_no_HC_NH3,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_route_life'</span> <span class="ot">=</span> life_prodroute_all_no_HC_NH3, </span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_capture'</span> <span class="ot">=</span> emission_co2_capture_perton_all_no_HC_NH3,</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_emission'</span> <span class="ot">=</span> emission_co2_emission_perton_all_no_HC_NH3,</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_capex'</span> <span class="ot">=</span> costs_capex_perton_all_no_HC_NH3,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_fom'</span> <span class="ot">=</span> costs_fom_perton_all_no_HC_NH3),</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">here</span>(output_dir, <span class="st">'technology_catalogue_ind_nuts0_nuts3_no_HC_NH3.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="filter-out-hc-meoh-and-nh3-and-convert-ton-nh3-to-mwh-save-excel-file" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-hc-meoh-and-nh3-and-convert-ton-nh3-to-mwh-save-excel-file">Filter out HC, MeOH and NH3 (and convert ton NH3 to mwh) + save excel file</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out HC, MeOH and NH3 from data + convert ton NH3 to mwh + save in excel</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_nuts3_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_2018year_nuts3 <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"mwh_yr"</span>, unit))</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_nuts3_HC_NH3  <span class="ot">&lt;-</span> prod_vol_cap_allyear_nuts3 <span class="sc">|&gt;</span> </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"mwh_yr"</span>, unit))</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_2018year_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_2018year <span class="sc">|&gt;</span> </span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2018</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2018</span><span class="st">`</span>),</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"mwh_yr"</span>, unit))</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>prod_vol_cap_allyear_HC_NH3 <span class="ot">&lt;-</span> prod_vol_cap_allyear <span class="sc">|&gt;</span> </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">*</span> <span class="fl">5.54</span> <span class="sc">*</span> <span class="dv">1000</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"mwh_yr"</span>, unit))</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>sec_perton_all_HC_NH3 <span class="ot">&lt;-</span> sec_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node),</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>),</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>),</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"mwh_mwh"</span>, unit))</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>life_prodroute_all_HC_NH3 <span class="ot">&lt;-</span> life_prodroute_all <span class="sc">|&gt;</span> </span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node))</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>emission_co2_capture_perton_all_HC_NH3 <span class="ot">&lt;-</span> emission_co2_capture_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node),</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>),</span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>),</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"tco2_mwh"</span>, unit))</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>emission_co2_emission_perton_all_HC_NH3 <span class="ot">&lt;-</span> emission_co2_emission_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node),</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>),</span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>),</span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"tco2_mwh"</span>, unit))</span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a>costs_capex_perton_all_HC_NH3 <span class="ot">&lt;-</span> costs_capex_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node),</span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>),</span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>),</span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"eur-yr_mwh"</span>, unit))</span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a>costs_fom_perton_all_HC_NH3 <span class="ot">&lt;-</span> costs_fom_perton_all <span class="sc">|&gt;</span> </span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_node <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HC"</span>, <span class="st">"HC-MeOH"</span>, <span class="st">"fertiliser-ammonia-NH3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"fertiliser-ammonia-NH3"</span>, <span class="st">"NH3"</span>, to_node),</span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_node =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"HC-MeOH"</span>, <span class="st">"MeOH"</span>, to_node),</span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2025</span><span class="st">`</span>),</span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2030</span><span class="st">`</span>),</span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2040</span><span class="st">`</span>),</span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span> <span class="sc">/</span> <span class="fl">5.54</span>, <span class="st">`</span><span class="at">2050</span><span class="st">`</span>),</span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">unit =</span> <span class="fu">ifelse</span>(to_node <span class="sc">==</span> <span class="st">"NH3"</span>, <span class="st">"eur_mwh"</span>, unit))</span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-83"><a href="#cb78-83" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">'ind_production_2018_nuts3'</span> <span class="ot">=</span> prod_vol_cap_2018year_nuts3_HC_NH3,</span>
<span id="cb78-84"><a href="#cb78-84" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts3'</span> <span class="ot">=</span> prod_vol_cap_allyear_nuts3_HC_NH3,</span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_2018_nuts0'</span> <span class="ot">=</span> prod_vol_cap_2018year_HC_NH3,</span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_production_30_50_nuts0'</span> <span class="ot">=</span> prod_vol_cap_allyear_HC_NH3,</span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_sec'</span> <span class="ot">=</span> sec_perton_all_HC_NH3,</span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_route_life'</span> <span class="ot">=</span> life_prodroute_all_HC_NH3, </span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_capture'</span> <span class="ot">=</span> emission_co2_capture_perton_all_HC_NH3,</span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_co2_emission'</span> <span class="ot">=</span> emission_co2_emission_perton_all_HC_NH3,</span>
<span id="cb78-91"><a href="#cb78-91" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_capex'</span> <span class="ot">=</span> costs_capex_perton_all_HC_NH3,</span>
<span id="cb78-92"><a href="#cb78-92" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ind_process_routes_fom'</span> <span class="ot">=</span> costs_fom_perton_all_HC_NH3),</span>
<span id="cb78-93"><a href="#cb78-93" aria-hidden="true" tabindex="-1"></a>           <span class="fu">here</span>(output_dir, <span class="st">'technology_catalogue_ind_nuts0_nuts3_HC_NH3.xlsx'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>

</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-aidres_report" class="csl-entry" role="listitem">
Vermeiren, Karolien, Wim Clymans, Lorenz Hambsch, and Leen Van Esch. 2023. <span>“AIDRES - Advancing Industrial Decarbonization by Assessing the Future Use of Renewable Energies in Industrial Processes.”</span> European Commission, Joint Research Centre. <a href="http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d">http://data.europa.eu/89h/14914982-70a9-4d1d-a2fc-cdee4a1d833d</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{das2026,
  author = {Das, Partha and Valkering, Pieter and Van de Put, Hans},
  title = {Preparation of {Technology} {Catalogue} for {MOPO} {EU/}
    {Industrial} {Cluster} {Case} {Study}},
  date = {2026-02-27},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-das2026" class="csl-entry quarto-appendix-citeas" role="listitem">
Das, Partha, Pieter Valkering, and Hans Van de Put. 2026.
<span>“Preparation of Technology Catalogue for MOPO EU/ Industrial
Cluster Case Study.”</span> February 27, 2026.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>